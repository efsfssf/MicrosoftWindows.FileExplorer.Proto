(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{1055:function(e,t,n){"use strict";n.r(t),n.d(t,"createDocumentExecutor",(function(){return P})),n.d(t,"DocumentCreator",(function(){return S}));var a=n(0),o=n(1),i=n(897);function r(e){switch(e){case i.e.Word:return".docx";case i.e.Excel:case i.e.ExcelSurvey:case i.e.ExcelForm:return".xlsx";case i.e.PowerPoint:return".pptx";case i.e.OneNote:return"";case i.e.Text:return".txt";case i.e.Visio:return".vsdx";case i.e.Bohemia:return".b";case i.e.Prague:return".prague"}}function c(e,t){var n="";switch(e){case i.e.Word:n=t.CreateWord;break;case i.e.Excel:n=t.CreateExcel;break;case i.e.PowerPoint:n=t.CreatePowerPoint;break;case i.e.OneNote:n=t.CreateOneNote;break;case i.e.ExcelSurvey:n=t.CreateExcelSurvey;break;case i.e.Text:n=t.CreateText;break;case i.e.ExcelForm:n=t.CreateFormForExcel;break;case i.e.Visio:n=t.CreateVisio;break;case i.e.Bohemia:n=t.CreateBohemia;break;case i.e.Prague:n=t.CreatePrague}return n}var s=n(940),l=n(200),u=n(432),m=n(334),d=n(923),p=n(118),f=n(687),x=n(454),w=n(144),h=n(8),b=new(n(14).ControlFacet)("documentCreator"),g=n(953),v=n(296),C=n(162),_=n(26),y=n(500),E=n(126),O=new l.AutoKeyFacet("newDocument"),k=new y.PlatformDetection;function F(){return O.serializeNext()}var D=Object(u.asAutoAction)()(m.ItemDefaultClickAction);function N(e){var t=this,n=e.itemKey,i=e.resolve,l=e.reject,u=e.askForFileName,m=e.documentType,h=e.openWindow,b=e.templateItemKey,g=e.validator,_=o.useState(null),y=_[0],E=_[1],O=o.useState(u),k=O[0],N=O[1],P=o.useState(F)[0],S=o.useState(!1),T=S[0],K=S[1],W=Object(C.useItemCacheDispatch)(),j=o.useCallback((function(e,t){return!t.targetWindow&&y?{targetWindow:y}:{}}),[y]),I=Object(v.useEventHandler)((function(){K(!0),i()})),A=Object(v.useEventHandler)((function(e){return Object(a.__awaiter)(t,void 0,void 0,(function(){var t,o,i;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return t=e.name,o=h({}),E(o),!u||u&&t?[4,W(Object(f.createDocument)({items:(i={},i[n]={documentType:m,newDocumentKey:P,targetWindow:o,fileName:t,templateItemKey:b},i)}))]:[3,2];case 1:a.sent(),a.label=2;case 2:return N(!1),[2]}}))}))})),z=Object(v.useEventHandler)((function(){l(new p.CancelError)}));return o.useLayoutEffect((function(){k||A({name:void 0})}),[]),k?o.createElement(d.e,{title:c(m,s.e)||"",name:"",placeHolder:s.e.NewNamePlaceholder,fileExtensionText:r(m),onContinue:A,onCancel:z,continueText:s.e.CreateCommit,validator:g}):T?null:o.createElement(w.e,{controlHandlers:x.e.pack(j)},o.createElement(D,{onComplete:I,itemKey:P}))}function P(e,t,n,a){var o,i=t.itemCacheDispatch,r=t.itemKey,c=t.documentType,s=t.askForFileName,l=t.templateItemKey,u=e.newDocumentKey;return!s||s&&n?i(Object(f.createDocument)({items:(o={},o[r]={documentType:c,newDocumentKey:u,targetWindow:a,fileName:n,templateItemKey:l},o)})):Promise.resolve()}var S=Object(h.createItemCacheComponent)((function(e,t){var n=t.itemKey,r=t.documentType,c=r===i.e.OneNote||r===i.e.ExcelSurvey||r===i.e.ExcelForm,s=Object(E.getConfiguration)(e,{enableOpenNewOfficeOnlineDocsInPWA:_.enableOpenNewOfficeOnlineDocsInPWAFacet}).enableOpenNewOfficeOnlineDocsInPWA,l=void 0!==s&&s,u=e.demandItemFacet(b,n),m=b.evaluate(u)(e,{itemKey:n,documentType:r,openWindow:l&&k.isPWA?K:T}),d=e.demandItemFacet(g.e,n),p=g.e.evaluate(d)(e,{itemKey:n,documentType:r,openWindow:l&&k.isPWA?K:T});return o.createElement(N,Object(a.__assign)({},t,{validator:p.validator||m.validator,askForFileName:c||p.askForFileName||m.askForFileName,openWindow:p.openWindow||m.openWindow}))}));function T(e){return window.open(e.url||"","_blank")}function K(e){return window.open(e.url||"","_self")}},923:function(e,t,n){"use strict";n.d(t,"e",(function(){return w}));var a=n(0),o=n(1),i=n(879),r=n(179),c=n(873),s=n(255),l=n(663),u=n(1494),m=n(625),d=n(415),p=n(16);Object(p.e)([{rawString:".nameDialogContent_31ed50fc{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.nameDialogContent_31ed50fc .ms-TextField{width:100%}.nameDialogContent_31ed50fc .ms-TextField .ms-TextField-errorMessage{max-width:-webkit-fit-content;max-width:-moz-fit-content;max-width:fit-content}.nameDialogContentFileExtension_31ed50fc{padding:10px 5px 0;-ms-flex-item-align:start;align-self:flex-start}.nameDialogSpinner_31ed50fc{display:inline-block;padding-bottom:7px;vertical-align:bottom}\n"}]);var f=new Proxy({},{get:(e,t)=>localizationLoader.getLocalizedString("XWNIiSKqFC/euwKCL9iNeg",t)}),x=function(e){function t(t){var n=e.call(this,t)||this;return n._onNameRef=function(e){n._textField=e,n._focusOnTextfield()},n._onNameChanged=function(e,t){void 0===t&&(t="");var a=n.props.validator;n.setState({name:t,errorMessage:a?a(t):void 0})},n._onClickAction=function(){return Object(a.__awaiter)(n,void 0,void 0,(function(){var e,t,n=this;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:this.setState({showSpinner:!0}),a.label=1;case 1:return a.trys.push([1,3,4,5]),[4,this.props.onContinue({name:this.state.name})];case 2:return a.sent(),[3,5];case 3:return t=a.sent(),e=t,this._isDisposed||this.setState({errorMessage:e&&e.message}),[3,5];case 4:return this._isDisposed||this.setState({showSpinner:!1},(function(){e&&n._focusOnTextfield()})),[7];case 5:return[2]}}))}))},n._onKeyPress=function(e){13===e.which&&(e.preventDefault(),e.stopPropagation(),n._onClickAction())},n.state={name:n.props.name},n}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=this.state,t=e.name,n=e.errorMessage,a=e.showSpinner,p=this.props,x=p.continueText,w=void 0===x?f.continue:x,h=p.cancelText,b=p.onCancel,g=p.placeHolder,v=p.maxLength,C=p.fileExtensionText,_=p.isMultiline,y=p.cols;return o.createElement(c.e,{dialogContentProps:{type:s.e.close},hidden:!1,title:this.props.title,onDismiss:b},o.createElement("div",{className:"nameDialogContent_31ed50fc"},o.createElement(u.e,{ariaLabel:g,componentRef:this._onNameRef,value:t,onChange:this._onNameChanged,errorMessage:n,placeholder:g,maxLength:v,onKeyPress:this._onKeyPress,multiline:_,cols:y}),C&&o.createElement("span",{className:"nameDialogContentFileExtension_31ed50fc"},C)),o.createElement(l.e,null,o.createElement(m.e,{disabled:!t||!!n||a,onClick:this._onClickAction,"data-automation-id":w},w),h&&o.createElement(d.e,{onClick:b},h),a&&o.createElement(i.e,{size:r.e.medium,className:"nameDialogSpinner_31ed50fc"})))},t.prototype.componentWillUnmount=function(){this._isDisposed=!0},t.prototype._focusOnTextfield=function(){this._textField&&(this._textField.focus(),this._textField.select())},t}(o.PureComponent),w=function(e){return o.createElement(x,Object(a.__assign)({},e))}},940:function(e,t,n){"use strict";var a=new Proxy({},{get:(e,t)=>localizationLoader.getLocalizedString("QQ7uVzIM8K4JyCVikmdxXQ",t)});t.e=a}}]);
//# sourceMappingURL=index.items-view-document-creator.js.map