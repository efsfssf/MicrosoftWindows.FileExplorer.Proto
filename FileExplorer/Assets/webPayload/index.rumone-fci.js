(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{1432:function(e,t,s){"use strict";function r(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];n()&&console.log.apply(console,e)}function n(){try{if("sessionStorage"in window&&window.sessionStorage){var e=window.sessionStorage.enableFCILogging;return e&&"true"===e.toLowerCase()&&"undefined"!=typeof console&&!!console}}catch(e){}return!1}s.r(t),s.d(t,"getFirstCPUIdle",(function(){return o}));var i=function(){function e(e){this._longTaskId=0,this._checkFCIRunId=0,this._isDisposed=!1;var t=e.requiredMainThreadCPUIdleDurationInMilliseconds,s=e.measurementStartTime;this._measurementStartTime=s,this._requiredMainThreadCPUIdleDurationInMilliseconds=t,this._resultResolver={resolve:void 0,reject:void 0},this._fciPromise=void 0,this._longTasks=[],this._processLongTaskPreQueue(),this._registerLongTaskObserver()}return e.prototype.measureFCI=function(){var e=this;if(this._isDisposed)throw"FCIMeasurer is disposed.";return this._fciPromise||(this._fciPromise=new Promise((function(t,s){e._resultResolver.resolve=t,e._resultResolver.reject=s}))),this._tryScheduleNextCheck(),this._fciPromise},e.prototype._tryScheduleNextCheck=function(){var e=this;this._checkFCIRunId&&clearTimeout(this._checkFCIRunId);var t=this._findEarlestPossibleCheckTime(),s=performance.now(),r=Math.max(0,t-s);this._checkFCIRunId=setTimeout((function(){e._checkFCI()}),r)},e.prototype._findEarlestPossibleCheckTime=function(){var e=this._getLatestLongTask(),t=e&&e.end||-1/0;return Math.max(t+this._requiredMainThreadCPUIdleDurationInMilliseconds,this._measurementStartTime,performance.now())},e.prototype._checkFCI=function(){var e=this._getLatestLongTask(),t=e&&e.end||-1/0,s=performance.now();if(r("Running checkFCI:"),r("Measurement start time",this._measurementStartTime),r("Current time",s),r("Long tasks",this._longTasks),r("latestLongTaskEndTime",t),s-t>=this._requiredMainThreadCPUIdleDurationInMilliseconds){var n=Math.max(t,this._measurementStartTime);if(n&&e){var i=e.endMarkName;i&&performance.measure("FCI",void 0,i)}r("possibleFCI:",n),this._resultResolver.resolve&&this._resultResolver.resolve(n),this._dispose()}},e.prototype._dispose=function(){clearTimeout(this._checkFCIRunId),this._longTaskObserver.disconnect(),this._isDisposed=!0},e.prototype._getLatestLongTask=function(){for(var e=void 0,t=0,s=this._longTasks;t<s.length;t++){var r=s[t];(!e||r.end>e.end)&&(e=r)}return e},e.prototype._processLongTaskPreQueue=function(){for(var e=window.__tti.o,t=0,s=window.__tti.e;t<s.length;t++){var r=s[t];if("longtask"===r.entryType){var n={start:r.startTime,end:r.startTime+r.duration,id:this._longTaskId++};this._longTasks.push(n)}}e.disconnect()},e.prototype._registerLongTaskObserver=function(){var e=this;this._longTaskObserver=new PerformanceObserver((function(t){for(var s=0,r=t.getEntries();s<r.length;s++){var n=r[s];"longtask"===n.entryType&&e._longTaskFinishedCallback(n)}})),this._longTaskObserver.observe({entryTypes:["longtask"]})},e.prototype._longTaskFinishedCallback=function(e){r("Long task finished: ",e);var t,s=e.startTime+e.duration,n={start:e.startTime,end:s,id:this._longTaskId++},i="longTaskEnd"+n.id;t=i,window.performance&&performance.mark&&performance.mark(t),n.endMarkName=i,this._longTasks.push(n),this._tryScheduleNextCheck()},e}();function o(e){return"PerformanceLongTaskTiming"in window?new i(e).measureFCI():Promise.resolve(null)}},1478:function(e,t,s){e.exports=s(1432)}}]);
//# sourceMappingURL=index.rumone-fci.js.map