(window.webpackJsonp=window.webpackJsonp||[]).push([[34],{1037:function(t,e,i){"use strict";var n=i(16);Object(n.e)([{rawString:".od-ItemActivity-item{max-width:100%}.od-ItemActivity-item-nameText{font-weight:600;color:"},{theme:"bodyText",defaultValue:"#323130"},{rawString:"}.od-ItemActivity-item-linkText{font-weight:600;text-decoration:none}.od-ItemActivity-item-clickableLinkText{max-width:100%;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";cursor:pointer;font-family:inherit}.isFluent .od-ItemActivity-item-clickableLinkText{font-size:12px}.od-ItemActivity-otherActors{list-style-type:none;margin:0;padding:0}.od-ItemActivity-n-Others{font-weight:600}.od-ItemActivity-item-textContent{overflow:hidden;text-overflow:ellipsis;display:inline-block;max-width:100%;vertical-align:middle}.od-ItemActivity-item .ms-ActivityItem-activityContent{width:calc(100% - 70px)}.od-ItemActivity-timeStamp{display:inline-block;vertical-align:middle}html[dir='ltr'] .od-ItemActivity-timeStamp{padding-left:0}html[dir='rtl'] .od-ItemActivity-timeStamp{padding-right:0}.od-ItemActivity-timeStamp:before{content:'\\00a0\\2219\\00a0'}.od-ItemActivity-persona{position:relative;width:100%;height:100%;font-weight:400;margin-top:-5px}@media screen and (-ms-high-contrast: active){.od-ItemActivity-persona{margin-top:0px}}.od-ItemActivity-personaIcon{position:absolute;top:0px;left:0px;width:100%;height:100%;border-radius:50%}\n"}])},1388:function(t,e,i){t.exports=i(960)},1389:function(t,e,i){t.exports=i(1419)},1419:function(t,e,i){"use strict";i.r(e),i.d(e,"BaseItemActivity",(function(){return z})),i.d(e,"EditItemActivity",(function(){return K})),i.d(e,"MoveItemActivity",(function(){return H})),i.d(e,"CommentItemActivity",(function(){return G})),i.d(e,"CommentResponseItemActivity",(function(){return J})),i.d(e,"MentionItemActivity",(function(){return X})),i.d(e,"VersionItemActivity",(function(){return Z})),i.d(e,"RestoreItemActivity",(function(){return q})),i.d(e,"RenameItemActivity",(function(){return Q})),i.d(e,"DeleteItemActivity",(function(){return $})),i.d(e,"CreateItemActivity",(function(){return tt})),i.d(e,"ShareItemActivity",(function(){return et})),i.d(e,"PointInTimeRestoreActivity",(function(){return it})),i.d(e,"RestoreVersionActivity",(function(){return nt})),i.d(e,"AddShortcutToOneDriveActivity",(function(){return rt})),i.d(e,"RemoveShortcutFromOneDriveActivity",(function(){return ot}));var n=i(0),r=i(1),o=i(508),s=i(349),a=i(231),m=i(113),l=i(884),c=i(123),d=i(664),h=i(102),u=i(816),p=i(1469),g=i(880),y=i(16);Object(y.e)([{rawString:".od-addCommentTextField{display:-webkit-box;display:-ms-flexbox;display:flex;margin:4px 0px 16px 0px}.od-addCommentTextField .ms-TextField-suffix{margin:8px 0;padding:0;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-addCommentTextField-input{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1}.od-addCommentTextField-input .ms-TextField-fieldGroup{background:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-addCommentTextField-sendButton{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";background-color:unset}.od-addCommentTextField-spinner{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;margin:4px}.od-addCommentTextField-screenReaderOnly{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}\n"}]),Object(y.e)([{rawString:".od-addNewCommentTextField{display:-webkit-box;display:-ms-flexbox;display:flex;margin:4px 0px 16px 0px}.od-addNewCommentTextField .ms-TextField-suffix{padding:0;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";-webkit-box-orient:horizontal;-webkit-box-direction:reverse;-ms-flex-direction:row-reverse;flex-direction:row-reverse}.od-addNewCommentTextField-input{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1}.od-addNewCommentTextField-input .ms-TextField-fieldGroup{background:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;max-height:174px;min-height:0px;border:1px solid "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";border-radius:2px}.od-addNewCommentTextField-input .ms-TextField-fieldGroup .ms-TextField-field{height:100%;min-height:0px}.od-addNewCommentTextField-input .ms-TextField-fieldGroup .ms-TextField-field:empty{max-height:29px}.od-addNewCommentTextField-input .ms-TextField-fieldGroup:hover{border-color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.od-addNewCommentTextField-disabled .ms-TextField-fieldGroup{border:1px solid "},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";border-radius:2px;background:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.od-addNewCommentTextField-disabled .ms-TextField-fieldGroup:hover{border-color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}.od-addNewCommentTextField-disabled .ms-TextField-suffix{background:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.od-addNewCommentTextField-sendButton{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";background-color:unset;margin:4px}.od-addNewCommentTextField-spinner{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;margin:4px}.od-addNewCommentTextField-screenReaderOnly{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}\n"}]);var f=i(61),v=i(879),C=i(179),b=i(1494),x=i(548),A=i(874),F=i(45),_=new Proxy({},{get:(t,e)=>localizationLoader.getLocalizedString("u5NhuqIlcjw3GJpBlvy7Ww",e)}),E=i(913),I=function(t){function e(e){var i=t.call(this,e)||this;return i._textField=r.createRef(),i.COMMENT_TEXT_MAX_LENGTH=2e3,i.charLimitExceededMessage="Maximum character limit exceeded",i._onSend=function(){var t=i.props,e=t.onSend,n=t.engagementSource,r=t.engagementExtraData,o=i.state.text;if(o&&e){i.setState({sending:!0,errorMessage:"",successMessage:""}),e(o,(function(){i._onClearTextField(),i.setState({successMessage:_.CommentAdded})}),(function(t){i.setState({sending:!1,errorMessage:t})}));var s=n?n+".":"AddCommentTextField.";E.Engagement.logData({name:s+"Send.Click",isIntentional:!0,extraData:r})}},i._onClearTextField=function(){i.setState(i._getResetState(),(function(){i._textField&&i._textField.current&&i._textField.current.focus()}))},i._onTextFieldChange=function(t,e){!e||e.length<=i.COMMENT_TEXT_MAX_LENGTH?i.setState({text:e||"",errorMessage:"",enableSendButton:!(!e||!e.trim())}):i.setState({text:i.state.text,errorMessage:i.charLimitExceededMessage,enableSendButton:!1})},i._onKeyDown=function(t){t.which===h.e.enter&&i.state.enableSendButton&&i._onSend()},i.state=i._getResetState(),i}return Object(n.__extends)(e,t),e.prototype.UNSAFE_componentWillReceiveProps=function(t){t.commentItemId===this.props.commentItemId&&t.disabled===this.props.disabled||this.setState(Object(n.__assign)(Object(n.__assign)({},this._getResetState()),{errorMessage:"",successMessage:""}))},e.prototype.componentDidMount=function(){this.props.focusOnMount&&!this.props.disabled&&this._textField.current&&this._textField.current.focus()},e.prototype.render=function(){var t=this.props,e=t.overrideStyleName,i=(t.engagementSource,t.commentItemId,t.enableNewCommentingExperience);return r.createElement("div",{className:Object(f.e)({"od-addCommentTextField":!i},{"od-addNewCommentTextField":i},e)},r.createElement(b.e,Object(n.__assign)({componentRef:this._textField,"data-lpignore":"true"},this._getTextFieldProps())),r.createElement("div",{className:Object(f.e)({"od-addCommentTextField-screenReaderOnly":!i},{"od-addNewCommentTextField-screenReaderOnly":i}),"aria-live":"assertive",role:"status","aria-label":this.state.successMessage},this.state.successMessage))},e.prototype._getTextFieldProps=function(){var t=this,e=this.props,i=e.placeholderText,n=e.disabled,r=e.enableNewCommentingExperience,o=this.state,s=o.sending,a=o.text,m=o.errorMessage;return{className:Object(f.e)({"od-addCommentTextField-input":!r},{"od-addNewCommentTextField-input":r},{"od-addNewCommentTextField-disabled":r&&(n||s)}),placeholder:i,onChange:this._onTextFieldChange,value:a||"",disabled:n||s,onKeyDown:this._onKeyDown,autoComplete:"off",errorMessage:m,autoAdjustHeight:r,multiline:r,rows:1,resizable:!1,onRenderSuffix:function(e){return t._onRenderSuffix()},ariaLabel:_.inputLabel}},e.prototype._onRenderSuffix=function(){return this.props.enableNewCommentingExperience?this.state.text.length>0&&r.createElement(r.Fragment,null,this._getSendButton()):r.createElement(r.Fragment,null,this._getCancelButton(),this._getSendButton())},e.prototype._getCancelButton=function(){this.props.enableNewCommentingExperience;return r.createElement(A.e,{content:_.cancelLabel,styles:{root:{display:"inline-block"}},directionalHint:F.e.bottomAutoEdge},r.createElement(x.e,{iconProps:{iconName:"Cancel"},ariaLabel:_.cancelLabel,onClick:this._onClearTextField}))},e.prototype._getSendButton=function(){var t=this.props,e=t.sendButtonTitle,i=t.enableNewCommentingExperience;return this.state.sending?r.createElement("div",{className:Object(f.e)({"od-addCommentTextField-spinner":!i},{"od-addNewCommentTextField-spinner":i})},r.createElement(v.e,{size:C.e.small})):r.createElement(A.e,{content:_.sendLabel||e,styles:{root:{display:"inline-block"}},directionalHint:F.e.bottomAutoEdge},r.createElement(x.e,{className:Object(f.e)({"od-addCommentTextField-sendButton":!i},{"od-addNewCommentTextField-sendButton":i}),iconProps:{iconName:"Send"},ariaLabel:_.sendLabel||e,onClick:this._onSend,disabled:!this.state||!this.state.enableSendButton}))},e.prototype._getResetState=function(){return{text:"",enableSendButton:!1,sending:!1,errorMessage:""}},e}(u.e),T=i(960),S=i(1126),O=i(185),L=(i(1037),function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._onRenderActivityDescription=function(){return r.createElement("div",{className:"od-ItemActivity-item-textContent"},e.props.reply.getDescription())},e._onRenderActivityTimeStamp=function(t,e){return e?e(t):null},e._onRenderHiddenTimeStamp=function(t,e){return null},e}return Object(n.__extends)(e,t),e.prototype.render=function(){var t=this.props,e=t.reply,i=t.hideDate,n=t.additionalClass,o=void 0===n?"":n;return r.createElement(l.e,{direction:c.e.horizontal,"data-is-focusable":!0,"aria-label":this._getAriaLabel()},r.createElement(S.e,{key:e.getKey(),className:"od-ItemActivity-item "+o,activityPersonas:this._activityPersonas(),onRenderActivityDescription:this._onRenderActivityDescription,timeStamp:this._onRenderDate(),onRenderTimeStamp:i?this._onRenderHiddenTimeStamp:this._onRenderActivityTimeStamp}))},e.prototype._onRenderDate=function(){var t=this.props.reply;return(O.getRelativeDateTimeStringForLists(t.getFriendlyDisplayTime()||"")||O.getFriendlyDateTimeStringPast(t.getDate())).toString()},e.prototype._getAriaLabel=function(){return this.props.reply.getDescription({stringOnly:!0}).join("")+" "+this._onRenderDate()},e.prototype._activityPersonas=function(){return[{imageUrl:this.props.reply.getPersonaImgUrl()}]},e}(r.Component));Object(y.e)([{rawString:".od-activityItem-replies-list .ms-List-cell{min-height:0}\n"}]);var R=function(t){function e(e,i){var n=t.call(this,e,i)||this;n._onFocus=function(){n._focusZone&&n._focusZone.focus()},n._onRenderCell=function(t,e){var i=n.props.onRenderUser,o=n.state,s=o.currentReplies,a=o.numberOfRepliesDisplayed,m=s.comments.length||0,l=a<=m&&m-a||0,c=new w({reply:t,onRenderUser:i});if(t&&e>=l)return r.createElement(L,{key:c.getKey(),reply:c,additionalClass:"od-ItemActivityList-commentReply"})},n._onSend=function(t,e,i){var r=n.props,o=r.parentComment,s=r.commentListItem,a=r.currentUserEmail;n._store&&n._store.addItemCommentReply({itemWrapper:s,currentUserEmail:a},o.id,t).then((function(t){n._store.fetchItemCommentReplies({itemWrapper:s,currentUserEmail:a,startIndex:0},o.id),e&&e()}),(function(t){var e=t&&t.message&&t.message.value;i&&i(e)}))},n._onShowMore=function(){var t=n.props,e=t.onShowMore,i=t.parentComment,r=t.commentListItem,o=t.currentUserEmail,s=n.state.currentReplies,a=n.state.numberOfRepliesDisplayed;a<s.comments.length&&(n.setState({numberOfRepliesDisplayed:10*Math.floor(a/10)+10}),s.nextLink&&n._store.fetchItemCommentReplies({itemWrapper:r,currentUserEmail:o},i.id)),e&&e()},n._store=i.itemCommentsStore,n._engagementSource=i.engagementSource||"";var o=e.parentComment,s=e.commentListItem,a=e.currentUserEmail;n._environment=e.environment;var m=n._store.getItemCommentReplies({itemWrapper:s,currentUserEmail:a},o.id),l=m&&m.comments&&m.comments.length,c=l?2:0;return n.state={numberOfRepliesDisplayed:c,currentReplies:m,hasMore:c<l},n}return Object(n.__extends)(e,t),e.prototype.UNSAFE_componentWillReceiveProps=function(t){t.parentComment.id!==this.props.parentComment.id&&this._addListener()},e.prototype.componentDidMount=function(){this._addListener()},e.prototype.componentWillUnmount=function(){this._store.removeRepliesListener(this._storeListener)},e.prototype.UNSAFE_componentWillUpdate=function(){this._focusElement=void 0},e.prototype.render=function(){var t=this.props,e=t.isReadonly,i=t.parentComment,n=this.state.currentReplies.comments||[],o=n.map((function(t){try{return t.action.comment.commentDetail}catch(t){}})),s="sharePointList"===this._environment,a="consumer"===this._environment;return r.createElement("div",{"data-is-focusable":!a&&!s,key:"activityResponse_"+i.id,onFocus:this._onFocus,"aria-label":T.default.activityCommentRepliesList,"aria-hidden":a||s},r.createElement(l.e,{componentRef:this._resolveRef("_focusZone"),className:Object(f.e)("od-ItemActivityList-activity-commentResponse",{"od-ItemActivityList-activity-withHiddenReply":a||s}),direction:c.e.vertical,isCircularNavigation:!1,handleTabKey:c.t.inputOnly,shouldInputLoseFocusOnArrowKey:function(t){return!0},isInnerZoneKeystroke:function(t){return t.which===Object(d.t)(h.e.right)}},this._getShowMoreLink(),n&&n.length>0&&r.createElement(p.e,{componentRef:!this._focusElement&&this._resolveRef("_focusElement"),className:"od-activityItem-replies-list",items:o,onRenderCell:this._onRenderCell}),!e&&!a&&!s&&r.createElement(I,{componentRef:!this._focusElement&&this._resolveRef("_focusElement"),commentItemId:i&&i.id,placeholderText:T.default.replyPlaceholder,sendButtonTitle:"",onSend:this._onSend,engagementSource:this._engagementSource+".AddReply"})))},e.prototype._addListener=function(){var t=this,e=this.props,i=e.parentComment,n=e.commentListItem,r=e.currentUserEmail;this._storeListener=this._store.addRepliesListener((function(){var e=t._store.getItemCommentReplies({itemWrapper:n,currentUserEmail:r},i.id),o=e.comments&&e.comments.length;t.setState({currentReplies:e,numberOfRepliesDisplayed:o>2?t.state.numberOfRepliesDisplayed:o,hasMore:!!e.nextLink||e.comments.length>t.state.numberOfRepliesDisplayed})}),{item:n.activityItemWrapper,currentUserEmail:r},i.id)},e.prototype._getShowMoreLink=function(){this.props.parentComment;var t,e=this.state,i=e.currentReplies;if(e.numberOfRepliesDisplayed<(null===(t=i.comments)||void 0===t?void 0:t.length)||i.nextLink)return r.createElement("div",{className:"od-ItemActivityList-commentReply od-ItemActivityList-loadMoreReplies"},r.createElement(g.e,{componentRef:!this._focusElement&&this._resolveRef("_focusElement"),onClick:this._onShowMore,href:"javascript:void(0)"},T.default.commentRepliesGetMore))},e.contextTypes={itemCommentsStore:o.any,engagementSource:o.any},e}(u.e),w=function(){function t(t){var e=this;this._renderUser=function(t,i){var n=t.user;return n||(n=e._getReplyAuthor()),e._renderUserLabel(n,{stringOnly:!1})},this._commentReply=t.reply,this._onRenderUser=t.onRenderUser}return t.prototype.getKey=function(){return"Comment"+this._commentReply.parentId+"_Reply"+this._commentReply.id},t.prototype.getPersonaImgUrl=function(){var t=this._commentReply.author;return a.Killswitch.isActivated("5277c492-ecd6-441d-9734-42f956caa92d","7/2/2020","Move user photo to private CDN")?"/_layouts/15/userphoto.aspx?size=S&accountname="+t.email:Object(s.getUserPhotoUrl)(t.email)},t.prototype.getFriendlyDisplayTime=function(){return this._commentReply.friendlyDisplayTime},t.prototype.getDate=function(){return this._commentReply.createdDate},t.prototype.getDescription=function(t){void 0===t&&(t={stringOnly:!1});var e=t.stringOnly,i=this._commentReply.text,n=this._getReplyAuthor(),o=this.renderUser(n,{stringOnly:e}),s=e?i:r.createElement("div",{className:"od-itemActivity-commentActivity-commentContent",dangerouslySetInnerHTML:{__html:i}});return n.self?m.formatToArray(T.default.youReplied,s):m.formatToArray(T.default.otherReplied,s,o)},t.prototype.renderUser=function(t,e){var i=e.stringOnly,n=this._renderUserLabel(t,{stringOnly:!0});return!t||i?n:r.createElement("span",{"aria-label":n},this._onRenderUser({user:t},this._renderUser))},t.prototype._renderUserLabel=function(t,e){var i,n=e.stringOnly;return i=t&&t.self?T.default.youUpperCase:t&&t.displayName?t.displayName:t&&t.email?t.email:T.default.someoneUpperCase,n?i:r.createElement("span",{className:"od-ItemActivity-item-nameText"},i)},t.prototype._getReplyAuthor=function(){return this._commentReply.author},t}(),N=i(415),D=i(873),U=i(255),M=i(663);Object(y.e)([{rawString:".od-itemActivityMenu-dialogButton-default{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";border:1px solid "},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.od-itemActivityMenu-dialogButton-default:hover{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.od-itemActivityMenu-dialogButton-default:active{background-color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}.od-itemActivityMenu-dialogButton-primary{background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-itemActivityMenu-dialogButton-primary:hover{background-color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:"}.od-itemActivityMenu-dialogButton-primary:active{background-color:"},{theme:"themeDarker",defaultValue:"#004578"},{rawString:"}.spo-ItemActivity-menuItems{min-width:120px;padding:0}\n"}]);var k={root:{display:"inline-block",verticalAlign:"top"}},j=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._onDismissDialog=function(){n.setState({hideDialog:!0})},n.state={dialogTitle:"",dialogConfirm:"",onDialogConfirm:void 0,hideDialog:!0},n}return Object(n.__extends)(e,t),e.prototype.render=function(){var t=this,e=this.state,i=e.dialogTitle,n=e.dialogConfirm,o=e.onDialogConfirm,s=e.hideDialog,a=this.props.environment,m=this._getMenuItems(),l="sharePointList"===a,c="consumer"===a;if(m)return r.createElement(r.Fragment,null,r.createElement(A.e,{content:T.default.activityMenuAriaLabel,styles:k},r.createElement(x.e,{className:Object(f.e)("od-ItemActivity-contextMenu",{"od-ItemActivity-contextMenu-display":c||l}),role:"button",iconProps:{iconName:"More"},onRenderMenuIcon:function(){},ariaLabel:T.default.activityMenuAriaLabel,menuProps:{directionalHint:F.e.bottomAutoEdge,isBeakVisible:!1,gapSpace:0,shouldFocusOnMount:!0,items:m,styles:{root:l?"spo-ItemActivity-menuItems":"od-ItemActivity-menuItems"}}})),r.createElement(D.e,{hidden:s,onDismiss:this._onDismissDialog,dialogContentProps:{type:U.e.normal,title:i}},r.createElement(M.e,null,r.createElement(N.e,{className:Object(f.e)({"od-itemActivityMenu-dialogButton-default":c||l}),disabled:!1,onClick:function(){o(),t._onDismissDialog()},text:n||T.default.activityMenuDialogConfirm}),r.createElement(N.e,{className:Object(f.e)({"od-itemActivityMenu-dialogButton-primary":c||l}),disabled:!1,primary:!0,onClick:this._onDismissDialog,text:T.default.activityMenuDialogCancel}))))},e.prototype._getMenuItems=function(){var t=this,e=this.props,i=e.itemActivityMenuItems,n=e.activityId;return i.map((function(e){return{key:e.key,name:e.name,onClick:function(i,r){var o=e.dialogOnConfirm;e.dialogTitle&&o?t.setState({dialogTitle:e.dialogTitle,dialogConfirm:e.dialogConfirm,onDialogConfirm:o,hideDialog:!1}):e.onClickMenuOption&&e.onClickMenuOption(i,r),E.Engagement.logData({name:"ActivityItemMenu."+e.name+".Click",isIntentional:!0,extraData:{activityId:n}})}}}))},e}(r.Component),V={root:{display:"inline-block",verticalAlign:"top"}},P=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._onDismissDialog=function(){n.setState({hideDialog:!0})},n.state={hideDialog:!0},n}return Object(n.__extends)(e,t),e.prototype.render=function(){var t=this,e=this.state.hideDialog,i=this.props,n=i.name,o=i.dialogTitle,s=i.dialogOnConfirm,a=i.dialogConfirm,m=i.environment,l="sharePointList"===m,c="consumer"===m;return r.createElement(r.Fragment,null,r.createElement(A.e,{content:n,styles:V},r.createElement(x.e,{className:Object(f.e)("od-ItemActivity-contextMenu",{"od-ItemActivity-contextMenu-display":c||l}),iconProps:{iconName:"Delete"},ariaLabel:n,onClick:function(){t.setState({hideDialog:!1})}})),r.createElement(D.e,{hidden:e,onDismiss:this._onDismissDialog,dialogContentProps:{type:U.e.normal,title:o}},r.createElement(M.e,null,r.createElement(N.e,{className:Object(f.e)({"od-itemActivityMenu-dialogButton-default":c||l}),disabled:!1,onClick:function(){s(),t._onDismissDialog()},text:a}),r.createElement(N.e,{className:Object(f.e)({"od-itemActivityMenu-dialogButton-primary":c||l}),disabled:!1,primary:!0,onClick:this._onDismissDialog,text:T.default.activityMenuDialogCancel}))))},e}(r.PureComponent),B=i(486),W=function(){function t(){}return t.htmlDecodeFromString=function(t){var e=t,i=(new DOMParser).parseFromString(e,"text/html");return e=i&&i.body&&i.body.innerText?i.body.innerText:e},t.isIE11=function(){return!!window.MSInputMethodContext&&!!document.documentMode},t}();function Y(t){return t?1:3}var z=function(){function t(t){var e=this;this._onRenderUser=function(t,i){var n=t.user;return e._getUserLabel(n,{stringOnly:!1,isAccusative:t.isAccusative})},this.activity=t.activity,this.currentUserEmail=t.currentUserEmail,this.containingItem=t.containingItem,this.isSingleLevel=t.isSingleLevel,this.canOpenItem=t.canOpenItem,this.onItemClick=t.onItemClick,this.strings=t.strings,this.onRenderUser=t.onRenderUser,this.populateItemNameToDisplay=t.populateItemNameToDisplay,this.currentListTitle=t.currentListTitle,this.currentRootTitle=t.currentRootTitle,this.defaultItemTitle=t.defaultItemTitle,this.commentListItem=t.commentListItem,this.isReadonly=t.isReadonly,this.canDeleteActivity=t.canDeleteActivity,this.activityMenuFunctions=t.activityMenuFunctions,this.isNewCommentExperienceEnabled=t.isNewCommentExperienceEnabled,this.isAtMentionEnabled=!!t.isAtMentionEnabled,this.environment=t.environment,this.getpersonaIconUrl=t.getpersonaIconUrl,this.displayLargeText=t.displayLargeText,this.isListItem=t.isSingleLevel&&"sharePointList"===t.environment}return t.prototype.getKey=function(){return this.activity.id},t.prototype.getTitle=function(t){return void 0===t&&(t={}),this.getDescription(t)},t.prototype.getDescription=function(t){return void 0===t&&(t={}),[]},t.prototype.getIconName=function(){return"ActivityFeed"},t.prototype.getPersonaIconUrl=function(){},t.prototype.getDate=function(){return this.activity.time},t.prototype.getFriendlyDisplayTime=function(){return this.activity.friendlyDisplayTime},t.prototype.getActivityTypeString=function(){return""},t.prototype.getResponse=function(){},t.prototype.getContextualMenu=function(){},t.prototype.getenvironment=function(){return this.environment},t.prototype.getCommentAuthorName=function(){},t.prototype.getcommentAuthorEmail=function(){},t.prototype.getCommentThreadId=function(){},t.prototype._getFilteredActors=function(t){for(var e,i,n=t.actors,r=void 0===n?this.activity.actors||[]:n,o=t.isCompact,s=[],a=0,m=r;a<m.length;a++){var l=m[a];l&&l.self?e=l:s.push(l)}e&&(s=[e].concat(s));var c=Y(o);return s.length>c&&(i=s.slice(c,s.length)),{youUser:e,additionalUsers:i,sortedUsers:s.length?s:[void 0]}},t.prototype._getAdditionalUsersTooltip=function(t,e){var i=e.stringOnly,n=e.isCompact,o=e.hideDate,s=e.isAccusative,a=void 0!==s&&s,l=n&&o?a?m.getLocalizedCountValue(this.strings.andOtherUsersCountFormShortAccusative,this.strings.otherActorsCountFormShortIntervals,t.length):m.getLocalizedCountValue(this.strings.andOtherActorsCountFormShort,this.strings.otherActorsCountFormIntervals,t.length):a?m.getLocalizedCountValue(this.strings.andOtherUsersCountFormAccusative,this.strings.otherActorsCountFormShortIntervals,t.length):m.getLocalizedCountValue(this.strings.andOtherActorsCountForm,this.strings.otherActorsCountFormIntervals,t.length),c=m.formatToArray(l,t.length);if(i)return c;var d={onRenderContent:function(){var e=t.map((function(t){return r.createElement("li",null,t.displayName)}));return r.createElement("ul",{className:"od-ItemActivity-otherActors"},e)},id:Object(B.e)("otherUsersTooltip")};return r.createElement(A.e,{tooltipProps:d,id:d.id},r.createElement("span",{className:"od-ItemActivity-n-Others","aria-describedby":d.id,"data-is-focusable":!0},c))},t.prototype.getRenderedUsers=function(t,e){var i=this,n=e.stringOnly,r=e.isAccusative,o=e.isActor;return t&&0!==t.length?t.map((function(t,e){return i.renderUser(t,{stringOnly:n,isAccusative:r,isActor:o},e)||""})):[this.renderUser(void 0)]},t.prototype.renderUser=function(t,e,i){void 0===i&&(i=0);var n=this.onRenderUser,o=void 0===n?this._onRenderUser:n,s=e.stringOnly,a=e.isAccusative,m=e.isActor,l=this._getUserLabel(t,{stringOnly:!0,isAccusative:a});if(!t||s)return l;var c=(m?"_actor":"_")+i;return r.createElement("span",{key:t.email+c,"aria-label":l},o({user:t,isAccusative:a},this._onRenderUser))},t.prototype.renderMainItemLink=function(t,e,i){return this.isSingleLevel?t:m.formatToArray(e,this.renderItemLink({item:this.activity.item,stringOnly:i}))},t.prototype.renderItemLink=function(t){var e=this,i=t.item,n=t.itemLabel,o=t.stringOnly,s=t.keyPrefix,a=void 0===s?"":s,m=n;if(!m&&i&&!i.name&&this.populateItemNameToDisplay&&(this.populateItemNameToDisplay(i),m=i.name),m||(m=i&&i.isRoot?this._getRootFolderName():void 0),m||(m=i&&i.name?i.name:this._getDefaultItemName()),m){if(o)return m;var l=void 0;if("string"==typeof m){l=m;var c=void 0,d=void 0;if(-1!==m.indexOf(".")){var h=m.split(".");c=h.slice(0,-1).join(),d=h.slice(-1).join()}else c=m,d="";c.length>40&&(m=c.slice(0,37).concat("...").concat(d))}var u=m;if(this.canOpenItem&&this.canOpenItem(i)){var p=void 0;return p=l?r.createElement("span",{className:"od-ItemActivity-item-textContent}",title:l}," ",m," "):r.createElement("span",{className:"od-ItemActivity-item-textContent}"}," ",m," "),r.createElement(g.e,{key:a+"_"+u+"_link",className:Object(f.e)("od-ItemActivity-item-linkText","od-ItemActivity-item-clickableLinkText"),onClick:function(){return e.onItemClick(i,e.getActivityTypeString())},href:"javascript:void(0)"},p)}return l?r.createElement("span",{key:a+"_"+u+"_string",className:"od-ItemActivity-item-linkText",title:l},m):r.createElement("span",{key:a+"_"+u+"_string",className:"od-ItemActivity-item-linkText"},m)}},t.prototype._getRootFolderName=function(){return this.currentRootTitle},t.prototype._getDefaultItemName=function(){return(this.currentListTitle?this.currentListTitle:this.defaultItemTitle)||void 0},t.prototype._getUserLabel=function(t,e){var i,n=e.stringOnly,o=e.isAccusative;return i=t&&t.self?o?this.strings.you:this.strings.youUpperCase:t&&t.displayName?t.displayName:t&&t.email?t.email:this.strings.someoneUpperCase,n?i:r.createElement("span",{className:"od-ItemActivity-item-nameText"},i)},t}(),K=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(n.__extends)(e,t),e.prototype.getDescription=function(t){var e=void 0===t?{}:t,i=e.isCompact,r=e.stringOnly,o=e.hideDate,s=this.strings.editThisFile;this.isListItem&&(s=this.strings.thisItem);var a,l=this.renderMainItemLink(s,this.strings.editArbitraryFile,r),c=this._getFilteredActors({isCompact:i}),d=c.youUser,h=c.sortedUsers,u=c.additionalUsers,p=Y(i);if(h.length>p){var g=i?!this.isNewCommentExperienceEnabled&&d?this.strings.youEditedCountFormShort:this.strings.othersEditedCountFormShort:!this.isNewCommentExperienceEnabled&&d?this.strings.youEditedCountForm:this.strings.othersEditedCountForm;return m.formatToArray.apply(m,Object(n.__spreadArrays)([g,l],this.getRenderedUsers(h.slice(0,p),{stringOnly:r,isActor:!0}),[this._getAdditionalUsersTooltip(u,{stringOnly:r,isCompact:i,hideDate:o})]))}var y=i?!this.isNewCommentExperienceEnabled&&d?this.strings.youEditedListFormShort:this.strings.othersEditedListFormShort:!this.isNewCommentExperienceEnabled&&d?this.strings.youEditedListForm:this.strings.othersEditedListForm;return a=m.getLocalizedCountValue(y,i?this.strings.editedListFormShortIntervals:this.strings.editedListFormIntervals,h.length),m.formatToArray.apply(m,Object(n.__spreadArrays)([a,l],this.getRenderedUsers(h,{stringOnly:r,isActor:!0})))},e.prototype.getIconName=function(){return"Edit"},e.prototype.getActivityTypeString=function(){return"edit"},e}(z),H=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(n.__extends)(e,t),e.prototype.getDescription=function(t){var e,i=void 0===t?{}:t,n=i.isCompact,r=i.stringOnly,o=this.renderMainItemLink(this.strings.moveThisFile,this.strings.moveArbitraryFile,r),s=this._getFilteredActors({isCompact:n}),a=s.youUser,l=this.renderUser(s.sortedUsers[0],{stringOnly:r,isActor:!0});if(!n&&this.activity.action&&this.activity.action.move){var c=this.activity.action.move;if(c.from&&c.to){var d=this.renderItemLink({item:c.from,stringOnly:r,keyPrefix:"old"}),h=this.renderItemLink({item:c.to,stringOnly:r});return e=!this.isNewCommentExperienceEnabled&&a?this.strings.youMovedFromFolderToFolder:this.strings.otherMovedFromFolderToFolder,m.formatToArray(e,o,l,d,h)}if(c.from){d=this.renderItemLink({item:c.from,stringOnly:r,keyPrefix:"old"});return e=!this.isNewCommentExperienceEnabled&&a?this.strings.youMovedFromFolder:this.strings.otherMovedFromFolder,m.formatToArray(e,o,l,d)}if(c.to){h=this.renderItemLink({item:c.to,stringOnly:r});return e=!this.isNewCommentExperienceEnabled&&a?this.strings.youMovedToFolder:this.strings.otherMovedToFolder,m.formatToArray(e,o,l,void 0,h)}}return e=n?!this.isNewCommentExperienceEnabled&&a?this.strings.youMovedShort:this.strings.otherMovedShort:!this.isNewCommentExperienceEnabled&&a?this.strings.youMoved:this.strings.otherMoved,m.formatToArray(e,o,l)},e.prototype.getIconName=function(){return"FabricMovetoFolder"},e.prototype.getActivityTypeString=function(){return"move"},e}(z),G=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(n.__extends)(e,t),e.prototype.getDescription=function(t){var e=void 0===t?{}:t,i=e.isCompact,r=e.stringOnly,o=e.hideDate,s=this.strings.commentedOnThisFile;this.isListItem&&(s=this.strings.thisItem);var a,l,c=this.renderMainItemLink(s,this.strings.commentedOnArbitraryFile,r),d=this._getFilteredActors({isCompact:i}),h=d.youUser,u=d.sortedUsers,p=d.additionalUsers,g=Y(i),y=this._isOnFileComment();if(y&&u.length<=1){var f=void 0;if(i)a=!this.isNewCommentExperienceEnabled&&h?this.strings.youCommentedListFormShort:this.strings.othersCommentedListFormShort;else{var v=this._getCommentMessage(r);this.isSingleLevel&&v?(f=v,a=!this.isNewCommentExperienceEnabled&&h?this.strings.youCommentedOnThisFile:this.strings.othersCommentedOnThisFile):(f=c,a=!this.isNewCommentExperienceEnabled&&h?this.strings.youCommentedOnFile:this.strings.othersCommentedOnFile)}l=m.formatToArray.apply(m,Object(n.__spreadArrays)([a,f],this.getRenderedUsers(u,{stringOnly:r,isActor:!0})))}else if(u.length>g){var C=i?!this.isNewCommentExperienceEnabled&&h?this.strings.youCommentedCountFormShort:this.strings.othersCommentedCountFormShort:!this.isNewCommentExperienceEnabled&&h?y?this.strings.youCommentedCountFormOnItem:this.strings.youCommentedCountForm:y?this.strings.othersCommentedCountFormOnItem:this.strings.othersCommentedCountForm;l=m.formatToArray.apply(m,Object(n.__spreadArrays)([C,c],this.getRenderedUsers(u.slice(0,g),{stringOnly:r,isActor:!0}),[this._getAdditionalUsersTooltip(p,{stringOnly:r,isCompact:i,hideDate:o})]))}else{var b=i?!this.isNewCommentExperienceEnabled&&h?this.strings.youCommentedListFormShort:this.strings.othersCommentedListFormShort:!this.isNewCommentExperienceEnabled&&h?y?this.strings.youCommentedListFormOnItem:this.strings.youCommentedListForm:y?this.strings.othersCommentedListFormOnItem:this.strings.othersCommentedListForm;a=m.getLocalizedCountValue(b,i?this.strings.commentedListFormShortIntervals:this.strings.commentedListFormIntervals,u.length),l=m.formatToArray.apply(m,Object(n.__spreadArrays)([a,c],this.getRenderedUsers(u,{stringOnly:r,isActor:!0})))}return l},e.prototype.getIconName=function(){if(this.isNewCommentExperienceEnabled){var t=this._getCommentDetail();return this.commentListItem&&t?void 0:"Comment"}return this.commentListItem?void 0:"Comment"},e.prototype.getPersonaIconUrl=function(){var t=this._getCommentDetail();if(void 0===this.getpersonaIconUrl){var e=this.commentListItem&&t&&t.author.email,i=a.Killswitch.isActivated("5277c492-ecd6-441d-9734-42f956caa92d","7/2/2020","Move user photo to private CDN")?"/_layouts/15/userphoto.aspx?size=s&accountname="+e:Object(s.getUserPhotoUrl)(e);return e&&i||void 0}var n=this.commentListItem&&t&&t.author.id;return n&&this.getpersonaIconUrl(n)||void 0},e.prototype.getActivityTypeString=function(){return"comment"},e.prototype.getContextualMenu=function(){var t=this,e=[],i=this.activityMenuFunctions&&this.activityMenuFunctions.delete,o=this.activity&&this.activity.action&&this.activity.action.comment&&this.activity.action.comment.commentId;if(this.canDeleteActivity&&this.canDeleteActivity(this.activity.type)&&i&&this.commentListItem&&o){var s={key:"od-itemActivity.deleteComment"+o,name:T.default.activityMenuOptionDelete,dialogTitle:T.default.deleteCommentDialogTitle,dialogConfirm:T.default.deleteCommentConfirm,dialogOnConfirm:function(){return i(t.commentListItem.activityItemWrapper,t.currentUserEmail,{commentItem:t.commentListItem,commentId:o})}};e.push(s)}return this.isNewCommentExperienceEnabled&&1===e.length?r.createElement(P,Object(n.__assign)({},e[0],{environment:this.environment})):e.length?r.createElement(j,{itemActivityMenuItems:e,activityId:this.activity.id,environment:this.environment}):void 0},e.prototype.getResponse=function(t){void 0===t&&(t=!1);var e=this._getCommentDetail(),i=e&&e.replies&&e.replies.comments&&e.replies.comments.length>0;if(this.commentListItem&&e&&(i||!this.isReadonly))return r.createElement(R,{key:this.containingItem.graphItemUrl+"_"+e.id,parentComment:e,commentListItem:this.commentListItem,currentUserEmail:this.currentUserEmail,onRenderUser:this.onRenderUser,isReadonly:this.isReadonly,environment:this.environment})},e.prototype.getCommentAuthorName=function(){var t=this._getCommentDetail();if(t&&t.author)return t.author.displayName},e.prototype.getcommentAuthorEmail=function(){var t=this._getCommentDetail();if(t&&t.author)return t.author.email},e.prototype.getCommentThreadId=function(){return this.activity&&this.activity.action&&this.activity.action.comment&&this.activity.action.comment.commentId},e.prototype._getCommentMessage=function(t){void 0===t&&(t=!1);var e=this._getCommentDetail();if(e&&e.text)return t?e.text:!0===this.isNewCommentExperienceEnabled&&this.displayLargeText?r.createElement("div",{className:"od-itemActivity-commentActivity-commentContent",key:"commentContent_"+this.getKey()},this.displayLargeText({seeMoreText:this.strings.seeMoreLabel,seeLessText:this.strings.seeLessLabel,text:"sharePointList"===this.environment?W.htmlDecodeFromString(e.text):e.text,isAtMentionEnabled:this.isAtMentionEnabled})):r.createElement("div",{className:"od-itemActivity-commentActivity-commentContent",dangerouslySetInnerHTML:{__html:e.text},key:"commentContent_"+this.getKey()})},e.prototype._getCommentDetail=function(){var t=this.activity.action;return t&&t.comment&&t.comment.commentDetail},e.prototype._isOnFileComment=function(){var t=this.activity.action&&this.activity.action.comment;return!(!t||!t.commentId)},e}(z),J=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(n.__extends)(e,t),e.prototype.getDescription=function(t){var e=void 0===t?{}:t,i=e.isCompact,r=e.stringOnly,o=e.hideDate,s=this.activity.action.commentResponse,a=this._getFilteredActors({isCompact:i}),l=a.youUser,c=a.sortedUsers,d=a.additionalUsers,h=Y(i),u=this.renderItemLink({item:this.activity.item,itemLabel:this.strings.commentResponseComment,stringOnly:r});if(s&&s.commentAuthor){var p=s.commentAuthor.self,g=this.renderUser(s.commentAuthor,{stringOnly:r,isAccusative:!0}),y=void 0;if(c.length>h){y=p?i?!this.isNewCommentExperienceEnabled&&l?this.strings.youRepliedToYouCountFormShort:this.strings.otherRepliedToYouCountFormShort:!this.isNewCommentExperienceEnabled&&l?this.strings.youRepliedToYouCountForm:this.strings.otherRepliedToYouCountForm:i?!this.isNewCommentExperienceEnabled&&l?this.strings.youRepliedToOtherCountFormShort:this.strings.otherRepliedToOtherCountFormShort:!this.isNewCommentExperienceEnabled&&l?this.strings.youRepliedToOtherCountForm:this.strings.otherRepliedToOtherCountForm;var f=Object(n.__spreadArrays)([g],this.getRenderedUsers(c.slice(0,h),{stringOnly:r,isActor:!0}),[this._getAdditionalUsersTooltip(d,{stringOnly:r,isCompact:i,hideDate:o})]);return i||f.unshift(u),m.formatToArray.apply(m,Object(n.__spreadArrays)([y],f))}var v=void 0;v=p?i?!this.isNewCommentExperienceEnabled&&l?this.strings.youRepliedToYouListFormShort:this.strings.otherRepliedToYouListFormShort:!this.isNewCommentExperienceEnabled&&l?this.strings.youRepliedToYouListForm:this.strings.otherRepliedToYouListForm:i?!this.isNewCommentExperienceEnabled&&l?this.strings.youRepliedToOtherListFormShort:this.strings.otherRepliedToOtherListFormShort:!this.isNewCommentExperienceEnabled&&l?this.strings.youRepliedToOtherListForm:this.strings.otherRepliedToOtherListForm,y=m.getLocalizedCountValue(v,i?this.strings.commentResponseListFormShortIntervals:this.strings.commentResponseListFormIntervals,c.length);f=Object(n.__spreadArrays)([g],this.getRenderedUsers(c.slice(0,h),{stringOnly:r,isActor:!0}));return i||f.unshift(u),m.formatToArray.apply(m,Object(n.__spreadArrays)([y],f))}y=void 0;if(c.length>h)return y=i?!this.isNewCommentExperienceEnabled&&l?this.strings.youRepliedToMissingAuthorCountFormShort:this.strings.otherRepliedToMissingAuthorCountFormShort:!this.isNewCommentExperienceEnabled&&l?this.strings.youRepliedToMissingAuthorCountForm:this.strings.otherRepliedToMissingAuthorCountForm,m.formatToArray.apply(m,Object(n.__spreadArrays)([y,u],this.getRenderedUsers(c.slice(0,h),{stringOnly:r,isActor:!0}),[this._getAdditionalUsersTooltip(d,{stringOnly:r,isCompact:i,hideDate:o})]));v=i?!this.isNewCommentExperienceEnabled&&l?this.strings.youRepliedToMissingAuthorListFormShort:this.strings.otherRepliedToMissingAuthorListFormShort:!this.isNewCommentExperienceEnabled&&l?this.strings.youRepliedToMissingAuthorListForm:this.strings.otherRepliedToMissingAuthorListForm;return y=m.getLocalizedCountValue(v,i?this.strings.commentResponseListFormShortIntervals:this.strings.commentResponseListFormIntervals,c.length),m.formatToArray.apply(m,Object(n.__spreadArrays)([y,u],this.getRenderedUsers(c,{stringOnly:r,isActor:!0})))},e.prototype.getIconName=function(){return"Reply"},e.prototype.getActivityTypeString=function(){return"commentResponse"},e}(z),X=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(n.__extends)(e,t),e.prototype.getDescription=function(t){var e,i,r=void 0===t?{}:t,o=r.isCompact,s=r.stringOnly,a=r.hideDate,l=this.renderMainItemLink(this.strings.mentionedThisFile,this.strings.mentionArbitraryFile,s),c=this._getFilteredActors({actors:this.activity.action.mention.mentionees,isCompact:o}),d=this.getRenderedUsers(c.sortedUsers,{stringOnly:s}),h=c.youUser,u=c.additionalUsers,p=this._getFilteredActors({isCompact:o}),g=p.youUser,y=p.sortedUsers,f=Y(o);if(d.length>f)return i=h?o?!this.isNewCommentExperienceEnabled&&g?this.strings.youMentionedOthersCountFormShort:this.strings.othersMentionedYouAndOthersCountFormShort:!this.isNewCommentExperienceEnabled&&g?this.strings.youMentionedYouAndOthersCountForm:g?this.strings.youMentionedYourselfAndOthersCountForm:this.strings.othersMentionedYouAndOthersCountForm:o?!this.isNewCommentExperienceEnabled&&g?this.strings.youMentionedOthersCountFormShort:this.strings.othersMentionedOthersCountFormShort:!this.isNewCommentExperienceEnabled&&g?this.strings.youMentionedOthersCountForm:this.strings.othersMentionedOthersCountForm,m.formatToArray.apply(m,Object(n.__spreadArrays)([i,l],this.getRenderedUsers(y,{stringOnly:s,isActor:!0}),d.slice(0,f),[this._getAdditionalUsersTooltip(u,{stringOnly:s,isCompact:o,hideDate:a})]));var v=void 0;return v=h?o?!this.isNewCommentExperienceEnabled&&g?this.strings.youMentionedYouListFormShort:this.strings.otherMentionedYouListFormShort:!this.isNewCommentExperienceEnabled&&g?this.strings.youMentionedYouAndOthersListForm:g?this.strings.youMentionedYourselfAndOthersListForm:this.strings.othersMentionedYouAndOthersListForm:o?!this.isNewCommentExperienceEnabled&&g?this.strings.youMentionedOthersListFormShort:this.strings.othersMentionedOthersListFormShort:!this.isNewCommentExperienceEnabled&&g?this.strings.youMentionedOthersListForm:this.strings.othersMentionedOthersListForm,e=m.getLocalizedCountValue(v,o?this.strings.mentionedListFormShortIntervals:this.strings.mentionedListFormIntervals,d.length),m.formatToArray.apply(m,Object(n.__spreadArrays)([e,l],this.getRenderedUsers(y,{stringOnly:s,isActor:!0}),d.slice(0,f)))},e.prototype.getIconName=function(){return"Accounts"},e.prototype.getActivityTypeString=function(){return"mention"},e}(z),Z=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(n.__extends)(e,t),e.prototype.getDescription=function(t){var e=void 0===t?{}:t,i=e.isCompact,n=e.stringOnly;if(this.activity.action&&this.activity.action.version&&this.activity.action.version.newVersion){var r=this._getFilteredActors({isCompact:i}),o=r.youUser,s=this.renderUser(r.sortedUsers[0],{stringOnly:n,isActor:!0}),a=i?!this.isNewCommentExperienceEnabled&&o?this.strings.youCreatedVersionShort:this.strings.otherCreatedVersionShort:!this.isNewCommentExperienceEnabled&&o?this.isSingleLevel?this.strings.youCreatedVersionThisFile:this.strings.youCreatedVersion:this.isSingleLevel?this.strings.otherCreatedVersionThisFile:this.strings.otherCreatedVersion,l=this.renderMainItemLink(this.strings.versionThisFile,this.strings.versionArbitraryFile,n),c=this.activity.action.version.newVersion;return m.formatToArray(a,l,s,c)}return[]},e.prototype.getIconName=function(){return"FabricMovetoFolder"},e.prototype.getActivityTypeString=function(){return"version"},e}(z),q=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(n.__extends)(e,t),e.prototype.getDescription=function(t){var e=void 0===t?{}:t,i=(e.isCompact,e.stringOnly),n=this.strings.restoreThisFile;this.isListItem&&(n=this.strings.restoreThisItem);var r=this.renderMainItemLink(n,this.strings.restoreArbitraryFile,i),o=this.isSingleLevel?this.strings.thisFileRestored:this.strings.arbitraryFileRestored;return m.formatToArray(o,r)},e.prototype.getIconName=function(){return"Refresh"},e.prototype.getActivityTypeString=function(){return"restore"},e}(z),Q=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(n.__extends)(e,t),e.prototype.getDescription=function(t){var e,i=void 0===t?{}:t,n=i.isCompact,r=i.stringOnly,o=this._getFilteredActors({isCompact:n}),s=o.youUser,a=this.renderUser(o.sortedUsers[0],{stringOnly:r,isActor:!0});if(this.activity.action&&this.activity.action.rename&&this.activity.action.rename.oldItem){var l=this.renderItemLink({item:this.activity.action.rename.oldItem,stringOnly:r,keyPrefix:"old"}),c=this.renderItemLink({item:this.activity.item,stringOnly:r});return e=n?!this.isNewCommentExperienceEnabled&&s?this.strings.youRenamedFileToFileShort:this.strings.otherRenamedFileToFileShort:!this.isNewCommentExperienceEnabled&&s?this.strings.youRenamedFileToFile:this.strings.otherRenamedFileToFile,m.formatToArray(e,a,l,c)}var d=this.renderMainItemLink(this.strings.renameThisFile,this.strings.renameArbitraryFile,r);return e=n?!this.isNewCommentExperienceEnabled&&s?this.strings.youRenamedFileShort:this.strings.otherRenamedFileShort:!this.isNewCommentExperienceEnabled&&s?this.strings.youRenamedFile:this.strings.otherRenamedFile,m.formatToArray(e,a,d)},e.prototype.getIconName=function(){return"Rename"},e.prototype.getActivityTypeString=function(){return"restore"},e}(z),$=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(n.__extends)(e,t),e.prototype.getDescription=function(t){var e=void 0===t?{}:t,i=e.isCompact,n=e.stringOnly,r=this.strings.deleteThisFile;this.isListItem&&(r=this.strings.thisItem);var o=this.renderMainItemLink(r,this.strings.deleteArbitraryFile,n),s=this._getFilteredActors({isCompact:i}),a=s.youUser,l=this.renderUser(s.sortedUsers[0],{stringOnly:n,isActor:!0}),c=i?!this.isNewCommentExperienceEnabled&&a?this.strings.youDeletedShort:this.strings.otherDeletedShort:!this.isNewCommentExperienceEnabled&&a?this.strings.youDeleted:this.strings.otherDeleted;if(this.isSingleLevel)return m.formatToArray(c,o,l);var d=this.renderItemLink({item:this.activity.parentItem,stringOnly:n});return c=!i&&d?!this.isNewCommentExperienceEnabled&&a?this.strings.youDeletedFromFolder:this.strings.otherDeletedFromFolder:c,d?m.formatToArray(c,o,l,d):m.formatToArray(c,o,l)},e.prototype.getIconName=function(){return"Trash"},e.prototype.getActivityTypeString=function(){return"delete"},e}(z),tt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(n.__extends)(e,t),e.prototype.getDescription=function(t){var e=void 0===t?{}:t,i=e.isCompact,n=e.stringOnly,r=this.strings.createThisFile;this.isListItem&&(r=this.strings.thisItem);var o=this.renderMainItemLink(r,this.strings.createArbitraryFile,n),s=this._getFilteredActors({isCompact:i}),a=s.youUser,l=this.renderUser(s.sortedUsers[0],{stringOnly:n,isActor:!0}),c=i?!this.isNewCommentExperienceEnabled&&a?this.strings.youCreatedShort:this.strings.otherCreatedShort:!this.isNewCommentExperienceEnabled&&a?this.strings.youCreated:this.strings.otherCreated;if(this.isSingleLevel)return m.formatToArray(c,o,l);var d=this.renderItemLink({item:this.activity.parentItem,stringOnly:n});return c=!i&&d?!this.isNewCommentExperienceEnabled&&a?this.strings.youCreatedInLocation:this.strings.otherCreatedInLocation:c,d?m.formatToArray(c,o,l,d):m.formatToArray(c,o,l)},e.prototype.getIconName=function(){return"Add"},e.prototype.getActivityTypeString=function(){return"create"},e}(z),et=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(n.__extends)(e,t),e.prototype.getDescription=function(t){var e=void 0===t?{}:t,i=e.isCompact,r=e.stringOnly,o=e.hideDate,s=this.strings.shareThisFile;this.isListItem&&(s=this.strings.thisItem);var a,l=this.renderMainItemLink(s,this.strings.shareArbitraryFile,r),c=this._getFilteredActors({isCompact:i}),d=c.youUser,h=this.activity.action.share.recipients;if(h&&h.length>0){var u,p=this.renderUser(c.sortedUsers[0],{stringOnly:r,isActor:!0}),g=this._getFilteredActors({actors:h,isCompact:i}),y=g.sortedUsers,f=g.youUser,v=g.additionalUsers,C=Y(i);if(y.length>C)return u=f?i?!this.isNewCommentExperienceEnabled&&d?this.strings.youSharedWithYouCountFormShort:this.strings.otherSharedWithYouCountFormShort:!this.isNewCommentExperienceEnabled&&d?this.strings.youSharedWithYouCountForm:this.strings.otherSharedWithYouCountForm:i?!this.isNewCommentExperienceEnabled&&d?this.strings.youSharedWithOthersCountFormShort:this.strings.otherSharedWithOthersCountFormShort:!this.isNewCommentExperienceEnabled&&d?this.strings.youSharedWithOthersCountForm:this.strings.otherSharedWithOthersCountForm,m.formatToArray.apply(m,Object(n.__spreadArrays)([u,l,p],this.getRenderedUsers(y.slice(0,C),{stringOnly:r,isAccusative:!0}),[this._getAdditionalUsersTooltip(v,{stringOnly:r,isCompact:i,hideDate:o,isAccusative:!0})]));var b=void 0;b=f?i?!this.isNewCommentExperienceEnabled&&d?this.strings.youSharedWithYouListFormShort:this.strings.otherSharedWithYouListFormShort:!this.isNewCommentExperienceEnabled&&d?this.strings.youSharedWithYouListForm:this.strings.otherSharedWithYouListForm:i?!this.isNewCommentExperienceEnabled&&d?this.strings.youSharedWithOthersListFormShort:this.strings.otherSharedWithOthersListFormShort:!this.isNewCommentExperienceEnabled&&d?this.strings.youSharedWithOthersListForm:this.strings.otherSharedWithOthersListForm;var x=m.getLocalizedCountValue(b,i?this.strings.sharedWithOthersListFormShortIntervals:this.strings.sharedWithOthersListFormIntervals,y.length);return m.formatToArray.apply(m,Object(n.__spreadArrays)([x,l,p],this.getRenderedUsers(y,{stringOnly:r,isAccusative:!0})))}var A=c.sortedUsers,F=c.additionalUsers,_=Y(i);if(A.length>_)return a=i?!this.isNewCommentExperienceEnabled&&d?this.strings.youSharedCountFormShort:this.strings.othersSharedCountFormShort:!this.isNewCommentExperienceEnabled&&d?this.strings.youSharedCountForm:this.strings.othersSharedCountForm,m.formatToArray.apply(m,Object(n.__spreadArrays)([a,l],this.getRenderedUsers(A.slice(0,_),{stringOnly:r,isActor:!0}),[this._getAdditionalUsersTooltip(F,{stringOnly:r,isCompact:i,hideDate:o})]));b=i?!this.isNewCommentExperienceEnabled&&d?this.strings.youSharedListFormShort:this.strings.othersSharedListFormShort:!this.isNewCommentExperienceEnabled&&d?this.strings.youSharedListForm:this.strings.othersSharedListForm;return a=m.getLocalizedCountValue(b,i?this.strings.sharedListFormShortIntervals:this.strings.sharedListFormIntervals,A.length),m.formatToArray.apply(m,Object(n.__spreadArrays)([a,l],this.getRenderedUsers(A,{stringOnly:r,isActor:!0})))},e.prototype.getIconName=function(){return"Share"},e.prototype.getActivityTypeString=function(){return"share"},e}(z),it=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(n.__extends)(e,t),e.prototype.getDescription=function(t){var e=void 0===t?{}:t,i=e.isCompact,n=e.stringOnly,r=this.renderMainItemLink(this.strings.shareThisFile,this.strings.createArbitraryFile,n),o=this._getFilteredActors({isCompact:i}),s=o.youUser,a=this.renderUser(o.sortedUsers[0],{stringOnly:n,isActor:!0}),l=i?!this.isNewCommentExperienceEnabled&&s?this.strings.youRestoredDocumentLibraryShort:this.strings.otherRestoredDocumentLibraryShort:!this.isNewCommentExperienceEnabled&&s?this.strings.youRestoredDocumentLibrary:this.strings.otherRestoredDocumentLibrary,c=this.activity.action&&this.activity.action.pointInTimeRestore,d=c&&c.restoreToDateTime;return m.formatToArray(l,a,r,O.getRelativeDateTimeStringPast(d))},e.prototype.getIconName=function(){return"Refresh"},e.prototype.getActivityTypeString=function(){return"pointInTimeRestore"},e}(z),nt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(n.__extends)(e,t),e.prototype.getDescription=function(t){var e=void 0===t?{}:t,i=e.isCompact,n=e.stringOnly,r=this.renderMainItemLink(this.strings.restoredVersionThisFile,this.strings.restoredVersionArbitraryFile,n),o=this._getFilteredActors({isCompact:i}),s=o.youUser,a=this.renderUser(o.sortedUsers[0],{stringOnly:n}),l=i?!this.isNewCommentExperienceEnabled&&s?this.strings.youRestoredVersionShort:this.strings.otherRestoredVersionShort:!this.isNewCommentExperienceEnabled&&s?this.strings.youRestoredVersion:this.strings.otherRestoredVersion,c=this.activity.action&&this.activity.action.restoreVersion,d=c&&c.fromVersion;return m.formatToArray(l,a,r,d)},e.prototype.getIconName=function(){return"Refresh"},e.prototype.getActivityTypeString=function(){return"restoreVesion"},e}(z),rt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(n.__extends)(e,t),e.prototype.getDescription=function(t){var e=void 0===t?{}:t,i=e.isCompact,n=e.stringOnly,r=(e.hideDate,this.renderMainItemLink(this.strings.shortcutThisFolder,this.strings.shortcutArbitraryFolder,n)),o=this._getFilteredActors({isCompact:i}),s=o.youUser,a=this.renderUser(o.sortedUsers[0],{stringOnly:n}),l=i?!this.isNewCommentExperienceEnabled&&s?this.strings.youAddedAShortcutShort:this.strings.OtherAddedAShortcutShort:!this.isNewCommentExperienceEnabled&&s?this.strings.youAddedAShortcut:this.strings.OtherAddedAShortcut;return m.formatToArray(l,a,r)},e.prototype.getIconName=function(){return"FabricFolderLink"},e.prototype.getActivityTypeString=function(){return"addShortcutToOneDrive"},e}(z),ot=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(n.__extends)(e,t),e.prototype.getDescription=function(t){var e=void 0===t?{}:t,i=e.isCompact,n=e.stringOnly,r=(e.hideDate,this.activity.action.removeShortcutFromOneDrive),o=this.renderItemLink({item:this.activity.item,itemLabel:r.mountPointName,stringOnly:n}),s=this._getFilteredActors({isCompact:i}),a=s.youUser,l=this.renderUser(s.sortedUsers[0],{stringOnly:n}),c=i?!this.isNewCommentExperienceEnabled&&a?this.strings.youRemovedAShortcutShort:this.strings.OtherRemovedAShortcutShort:!this.isNewCommentExperienceEnabled&&a?this.strings.youRemovedAShortcut:this.strings.OtherRemovedAShortcut;return m.formatToArray(c,l,o)},e.prototype.getIconName=function(){return"FabricFolderLink"},e.prototype.getActivityTypeString=function(){return"removeShortcutFromOneDrive"},e}(z)},1474:function(t,e,i){"use strict";i.r(e),i.d(e,"driveItemActivityFieldControlHandler",(function(){return y}));var n,r=i(0),o=i(1),s=i(9),a=i(1388),m=i.n(a),l=i(1389),c=i(5),d=i(582),h=i(152),u=i(11);function p(t,e){var i=t.activity,n=t.hoverCardElementsPerUser,r=t.personKeyByEmail;if(i){var s,a=(s=i.type,g[s]);return a?new a({activity:i,canOpenItem:function(){return!1},containingItem:{absolutePath:"",isFolder:!1,name:e,graphItemUrl:""},onRenderUser:function(t,e){if(!t||!e)return null;var i=e(t),s=t.user,a=s.email||"",m=n[a],l=r[a];return m?o.cloneElement(m,{displayValue:s.displayName,personKey:l,user:s},i):i},currentUserEmail:"",isSingleLevel:!0,onItemClick:function(){},strings:m.a}):void 0}}var g=((n={})[0]=l.EditItemActivity,n[1]=l.MoveItemActivity,n[2]=l.CommentItemActivity,n[3]=l.CommentResponseItemActivity,n[4]=l.MentionItemActivity,n[5]=l.VersionItemActivity,n[6]=l.RestoreItemActivity,n[9]=l.RenameItemActivity,n[10]=l.DeleteItemActivity,n[11]=l.CreateItemActivity,n[12]=l.ShareItemActivity,n);var y=Object(s.createControlHandler)()((function(){return function(){return function(t,e){var i=e.itemKey,n=e.activity,o={},s={};if(u.driveItemKeyFacet.matches(i)){var a=u.driveItemKeyFacet.deserialize(i).endpoint,m=n&&n.actors||[],l=n&&n.action,g=l&&l.mention&&l.mention.mentionees||[],y=l&&l.share&&l.share.recipients||[],f=l&&l.commentResponse&&l.commentResponse.commentAuthor,v=Object(r.__spreadArrays)(m,g,y);f&&v.push(f);for(var C=0,b=v;C<b.length;C++){var x=b[C];if(x.email){var A=h.e.serialize({email:x.email,endpoint:a}),F={itemKey:A,displayValue:x.displayName},_=Object(d.getHoverCardElement)(t,F).hoverCardElement;o[x.email]=_,s[x.email]=A}}}var E=t.demandItemFacet(c.fileNameFacet,i);return{itemActivity:n&&E&&p({activity:n,hoverCardElementsPerUser:o,personKeyByEmail:s},E.name)}}}}))},913:function(t,e,i){t.exports=i(930)},930:function(t,e,i){"use strict";i.r(e);var n=i(125);for(var r in n)["default"].indexOf(r)<0&&function(t){i.d(e,t,(function(){return n[t]}))}(r);i.d(e,"default",(function(){return n.Engagement}))},960:function(t,e,i){"use strict";i.r(e),i.d(e,"strings",(function(){return n}));var n=new Proxy({},{get:(t,e)=>localizationLoader.getLocalizedString("QR78fRxLvvFhkHYbDegJaw",e)});e.default=n}}]);
//# sourceMappingURL=index.34.js.map