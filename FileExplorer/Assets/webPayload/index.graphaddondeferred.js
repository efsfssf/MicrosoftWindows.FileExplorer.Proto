(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{1018:function(e,t,r){e.exports=r(931)},1034:function(e,t,r){"use strict";r.r(t),r.d(t,"uploadItemsOperation",(function(){return c})),r.d(t,"uploadItems",(function(){return s})),r.d(t,"UploadItemOperationError",(function(){return u}));var n=r(0),o=r(60),a=r(240),i=r(3),c=new i.Facet("uploadItems"),s=Object(o.implementOperation)({operationTypeFacet:c}),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(n.__extends)(t,e),t}(a.ItemOperationError)},1035:function(e,t,r){"use strict";r.d(t,"n",(function(){return o})),r.d(t,"t",(function(){return a})),r.d(t,"e",(function(){return i}));var n=r(2),o=new n.Facet("shortcutExistedAlready"),a=new n.Facet("nestedDescendantShortcutExists"),i=new n.Facet("nestedAscendantShortcutExists")},1036:function(e,t,r){e.exports=r(501)},1058:function(e,t,r){"use strict";r.r(t),r.d(t,"ConfirmationDialog",(function(){return m}));var n=r(1),o=r(873),a=r(255),i=r(663),c=r(625),s=r(415),u=r(1129),l=new Proxy({},{get:(e,t)=>localizationLoader.getLocalizedString("nHz5qILJyfx1qExZAcC9bg",t)}),d=r(16);Object(d.e)([{rawString:".confirmTextLabel_e964ecde{font-weight:400}\n"}]);var m=function(e){var t=e.onConfirm,r=e.onCancel,d=e.defaultToYes,m=void 0!==d&&d,p=e.yesText,f=void 0===p?l.yes:p,v=e.noText,h=void 0===v?l.no:v,g=m?c.e:s.e,O=m?s.e:c.e;return n.createElement(o.e,{dialogContentProps:{type:a.e.close},onDismiss:r,hidden:!1,title:e.title,maxWidth:e.maxWidth},n.createElement(u.e,{className:"confirmTextLabel_e964ecde"},e.prompt),n.createElement(i.e,null,n.createElement(g,{"data-automationid":"confirmbutton",onClick:t},f),n.createElement(O,{"data-automationid":"cancelbutton",onClick:r,componentRef:function(e){e&&e.focus()}},h)))}},1108:function(e,t,r){e.exports=r(1034)},1109:function(e,t,r){e.exports=r(917)},1110:function(e,t,r){e.exports=r(1442)},1129:function(e,t,r){"use strict";r.d(t,"e",(function(){return s}));var n=r(1471),o=r(0),a=r(1),i=r(1420),c=r(416),s=Object(n.e)((function(e){if(0===a.Children.count(e.children))return null;e.block,e.className;var t=e.as,r=void 0===t?"span":t,n=(e.variant,e.nowrap,Object(o.__rest)(e,["block","className","as","variant","nowrap"])),s=Object(i.t)(e,{root:r});return Object(i.n)(s.root,Object(o.__assign)({},Object(c.a)(n,c.i)))}),{displayName:"Text",styles:function(e,t){var r=e.as,n=e.className,o=e.block,a=e.nowrap,i=e.variant,c=t.fonts[i||"medium"];return{root:[t.fonts.medium,{display:o?"td"===r?"table-cell":"block":"inline",fontFamily:c.fontFamily,fontSize:c.fontSize,fontWeight:c.fontWeight,color:c.color,mozOsxFontSmoothing:c.MozOsxFontSmoothing,webkitFontSmoothing:c.WebkitFontSmoothing},a&&{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},n]}}})},1335:function(e,t,r){e.exports=r(1336)},1336:function(e,t,r){"use strict";r.r(t),r.d(t,"itemsViewSearchControl",(function(){return o}));var n=r(14),o=new n.ControlFacet("itemsViewSearchControl")},1337:function(e,t,r){e.exports=r(919)},1338:function(e,t,r){e.exports=r(895)},1339:function(e,t,r){e.exports=r(918)},1340:function(e,t,r){e.exports=r(1341)},1341:function(e,t,r){"use strict";r.r(t),r.d(t,"UploadWaiter",(function(){return p}));var n=r(1342),o=r.n(n),a=r(513),i=r.n(a),c=r(945),s=r.n(c),u=r(106),l=r.n(u),d=r(904),m=r.n(d),p=function(){function e(e,t){var r=t.asyncType,n=void 0===r?o.a:r,a=t.eventGroupType,c=void 0===a?i.a:a,u=t.targetWindow,l=void 0===u?window:u,d=this._scope=new s.a;this._async=d.attach(new n(this)),this._events=d.attach(new c(this)),this._targetWindow=l}return e.prototype.dispose=function(){this._scope.dispose()},e.prototype.wait=function(e){var t,r=e.duration,n=e.allowWakeWhenOnline,o=void 0!==n&&n,a=this._async,i=this._events,c=this._targetWindow,s=new m.a((function(){a.clearTimeout(t)})),u=function(){o&&s.complete()};return t=a.setTimeout((function(){s.complete()}),r),i.on(c,"online",u),s.getPromise().then((function(){i.off(c,"online",u)}),(function(e){return i.off(c,"online",u),l.a.reject(e)}))},e}()},1342:function(e,t,r){e.exports=r(519)},1343:function(e,t,r){e.exports=r(1344)},1344:function(e,t,r){"use strict";r.r(t),r.d(t,"performanceNow",(function(){return n})),r.d(t,"ActivityBandwidthVerifier",(function(){return o}));var n=window.performance?function(){return window.performance.now()}:function(){return Date.now()},o=function(){function e(e,t){this._performanceNow=t.performanceNow,this._startTime=this._performanceNow(),this._expirationTime=this._startTime+e.timeout,this._totalBytes=e.totalBytes,this._progressPoints=0}return e.prototype.doesActivityHaveRemainingCapacity=function(e){var t=this._getRateRatio(e);return void 0===t||t<=1},e.prototype.didActivityHaveExtraCapacity=function(){return this._getRateRatio(this._totalBytes)<=.5},e.prototype._getRateRatio=function(e){this._progressPoints++;var t,r=this._performanceNow(),n=r-this._startTime,o=this._expirationTime-r,a=this._totalBytes-e;return(this._progressPoints>=4&&n>=4e3||this._progressPoints>0&&0===a)&&o>0&&(t=a/o/(e/n)),t},e}()},1345:function(e,t,r){e.exports=r(1346)},1346:function(e,t,r){"use strict";r.r(t),r.d(t,"UploadService",(function(){return i}));var n=r(0),o=r(904),a=r.n(o),i=function(){function e(e,t){this._dataRequestor=t.dataRequestor}return e.prototype.createSession=function(e){var t=e.qosData,r=e.itemUrl,o=e.headers,a=e.allowCookies,i=e.accessToken,s=e.fileName,u=e.fileSize,l=e.lastModifiedDate,d=e.eTag,m=e.conflictBehavior,p=e.ignoreCookieAuth,f={item:Object(n.__assign)(Object(n.__assign)({},c(r)?{"@microsoft.graph.conflictBehavior":m}:{"@name.conflictBehavior":m}),l?{fileSystemInfo:{lastModifiedDateTime:l.toISOString()}}:{})},v=Object(n.__assign)(Object(n.__assign)(Object(n.__assign)(Object(n.__assign)({},d?{"If-Match":d}:{}),p?{IgnoreCookieAuthentication:"t"}:{}),{Prefer:"synchronousmetadata"}),o);return this._dataRequestor.send({path:r+"/"+encodeURIComponent(s)+":/"+(c(r)?"createUploadSession":"oneDrive.createUploadSession"),requestType:"POST",apiName:"CreateSession",headers:v,allowCookies:a,accessToken:i,useAuthorizationHeaders:!0,postData:JSON.stringify(f),qosExtraData:Object(n.__assign)({conflictBehavior:m,fileSize:u},t)})},e.prototype.cancelSession=function(e){var t=e.qosData,r=e.sessionUrl;return this._dataRequestor.send({requestType:"DELETE",apiName:"CancelSession",path:r,needsAuthorization:!1,qosExtraData:t})},e.prototype.uploadFragment=function(e){var t=e.qosData,r=e.headers,o=e.sessionUrl,i=e.startByte,c=e.endByte,s=e.fileSize,u=e.content,l=e.timeout,d=e.onProgress,m=e.select,p=Object(n.__assign)({"Content-Range":"bytes "+i+"-"+Math.max(c-1,i)+"/"+s},r),f=!0,v=this._dataRequestor.send({path:o+(m?(o.indexOf("?")>-1?"&":"?")+"$select="+m:""),needsAuthorization:!1,requestType:"PUT",apiName:"UploadFragment",headers:p,postData:u,timeout:l,hasContentType:!1,onUploadProgress:function(e){e.lengthComputable&&f&&d(i+e.loaded)},qosExtraData:Object(n.__assign)(Object(n.__assign)({},t),{startByte:i,endByte:c,fileSize:s})}),h=new a.a((function(){f=!1,v.cancel()}));return v.done((function(e){f=!1,h.complete(e)}),(function(e){f=!1,h.error(e)})),h.getPromise()},e.prototype.commit=function(e){var t=e.qosData,r=e.itemUrl,o=e.accessToken,a=e.fileName,i=(e.description,e.eTag),s=e.conflictBehavior,u=e.sessionUrl,l={"If-Match":i},d=c(r)?{"@microsoft.graph.conflictBehavior":s,"@microsoft.graph.sourceUrl":u}:{"@name.conflictBehavior":s,"@content.sourceUrl":u};return this._dataRequestor.send({path:r+"/"+encodeURIComponent(a),requestType:"PUT",apiName:"CommitSession",headers:l,accessToken:o,useAuthorizationHeaders:!0,postData:JSON.stringify(d),qosExtraData:Object(n.__assign)({conflictBehavior:s},t)})},e.prototype.getStatus=function(e){var t=e.qosData,r=e.sessionUrl;return this._dataRequestor.send({requestType:"GET",apiName:"GetStatus",path:r,needsAuthorization:!1,qosExtraData:t})},e.prototype.getItem=function(e){var t=e.qosData,r=e.itemUrl,o=e.accessToken,a=e.fileName;return this._dataRequestor.send({requestType:"GET",apiName:"GetItem",path:r+"/"+encodeURIComponent(a),useAuthorizationHeaders:!0,accessToken:o,qosExtraData:Object(n.__assign)({},t)})},e}();function c(e){return 0===e.toLowerCase().lastIndexOf("https://graph.microsoft.com",0)}},1347:function(e,t,r){e.exports=r(1348)},1348:function(e,t,r){"use strict";r.r(t),r.d(t,"UploadStateMachine",(function(){return d}));var n=r(0),o=r(209),a=r(183),i=r(106),c=r.n(i),s=r(904),u=r.n(s),l=Math.pow(2,1/4),d=function(){function e(e,t){this._uploadService=t.uploadService,this._activityBandwidthVerifierType=t.activityBandwidthVerifierType;var r=t.useCommitForUpload,n=void 0!==r&&r,o=t.checkForCompletedUploadOnSessionTermination,a=void 0===o||o,i=t.shouldCancelOnCompleteFailure,c=void 0===i||i,s=t.maximumFragmentSize,u=void 0===s?62914560:s;this._shouldCancelOnCompleteFailure=c,this._useCommitForUpload=n,this._checkForCompletedUploadOnSessionTermination=a,this._maximumFragmentSize=u}return e.prototype.advanceState=function(e,t){var r=this,n=t.sessionUrl,o=t.nextExpectedRanges;return(n?o?this._uploadItemState(e,t):this._getStatusState(e,t):this._createSessionState(e,t)).then((function(t){return t.error?r._handleGeneralErrorState(e,t):r._getState(t,{waitDuration:void 0,attemptsRemaining:void 0})}))},e.prototype._createSessionState=function(e,t){var r=this,i=e.qosData,c=new a.Qos({name:"VroomUploader.createSession",extraData:i});return this._uploadService.createSession({qosData:i,itemUrl:e.itemUrl,headers:e.headers,allowCookies:e.allowCookies,accessToken:e.accessToken,fileName:e.fileName,fileSize:e.content.size,eTag:e.eTag,lastModifiedDate:e.lastModifiedDate,conflictBehavior:t.conflictBehavior,ignoreCookieAuth:e.ignoreCookieAuth}).then((function(e){return c.end({resultType:a.ResultTypeEnum.Success}),r._getState(t,{nextExpectedRanges:e.nextExpectedRanges,sessionUrl:e.uploadUrl})}),(function(s){return r._handleCreateSessionErrorState(e,r._getState(t,{error:s})).then((function(e){return e.error?c.end({resultType:a.ResultTypeEnum.Failure,error:s.message,resultCode:Object(o.getResultCodeFromError)(s),extraData:Object(n.__assign)(Object(n.__assign)({},i),Object(o.getQosExtraDataFromError)(s))}):c.end({resultType:a.ResultTypeEnum.ExpectedFailure,resultCode:"Canceled"}),e}))}))},e.prototype._handleCreateSessionErrorState=function(e,t){var r=this;return this._handleErrorState(t,(function(n,o){switch(n){case"entityTagDoesNotMatch":case"resourceModified":case"versionNumberDoesNotMatch":case"nameAlreadyExists":case"unlockRequired":case 409:case 412:return r._promptForConflictBehaviorState(o,e,t)}}))},e.prototype._getStatusState=function(e,t){var r=this,i=e.qosData,c=new a.Qos({name:"VroomUploader.getStatus",extraData:i});return this._uploadService.getStatus({qosData:i,sessionUrl:t.sessionUrl}).then((function(e){return c.end({resultType:a.ResultTypeEnum.Success}),r._getState(t,{nextExpectedRanges:e.nextExpectedRanges})}),(function(e){return c.end({resultType:a.ResultTypeEnum.Failure,error:e.message,resultCode:Object(o.getResultCodeFromError)(e),extraData:Object(n.__assign)(Object(n.__assign)({},i),Object(o.getQosExtraDataFromError)(e))}),r._getState(t,{error:e})}))},e.prototype._uploadItemState=function(e,t){var r=this,i=e.qosData,c=e.content.size,s=this._getNextRange({fileSize:c,nextExpectedRanges:t.nextExpectedRanges}),u=new a.Qos({name:"VroomUploader.uploadItem",extraData:e.qosData});return(s&&s.start<c?t.allowStreaming?this._uploadStreamState({nextRange:s},e,t):this._uploadFragmentState({nextRange:s},e,t):this._useCommitForUpload?this._commitState(e,t):this._shouldCancelOnCompleteFailure?this._cancelSessionState(e,t):this._terminateUploadOnCompleteFailure(t)).then((function(t){return t.error?r._handleUploadItemErrorState(e,t).then((function(e){var t=e.error;return t?u.end({resultType:a.ResultTypeEnum.Failure,error:t.message,resultCode:Object(o.getResultCodeFromError)(t),extraData:Object(n.__assign)(Object(n.__assign)({},i),Object(o.getQosExtraDataFromError)(t))}):u.end({resultType:a.ResultTypeEnum.Success}),e})):(u.end({resultType:a.ResultTypeEnum.Success}),t)}))},e.prototype._terminateUploadOnCompleteFailure=function(e){return c.a.resolve(this._getState(e,{error:new Error("The upload session is still open but there are no more bytes to upload.")}))},e.prototype._uploadFragmentState=function(e,t,r){var i=this,c=e.nextRange,s=t.onProgress,d=t.headers,m=t.content,p=t.content.size,f=t.qosData,v=t.select,h=r.sessionUrl,g=r.speed,O=void 0===g?1/8:g,_=c.start,b=c.end;s&&s(_);var y,F,I=this._getFragmentSize(O),j=Math.min(_+I,b),S=new u.a((function(){y&&y.cancel()})),w=O>1/1920?6e4:3e5,C=new this._activityBandwidthVerifierType({timeout:w,totalBytes:j-_}),E=new a.Qos({name:"VroomUploader.uploadFragment",extraData:Object(n.__assign)(Object(n.__assign)({},f),{startByte:_,endByte:j,fileSize:p,speed:O,fragmentSize:I})});return(y=this._uploadService.uploadFragment({qosData:f,headers:d,sessionUrl:h,startByte:_,endByte:j,fileSize:p,content:m.slice(_,j),timeout:w,select:v,onProgress:function(e){F=e,O>1/1920&&!C.doesActivityHaveRemainingCapacity(e-_)&&(E.end({resultType:a.ResultTypeEnum.ExpectedFailure,resultCode:"Aborted",extraData:Object(n.__assign)(Object(n.__assign)({},f),{lastByte:e})}),S.complete(i._getState(r,{speed:Math.max(.5*O,1/1920),nextExpectedRanges:void 0})),y&&y.cancel()),s&&s(e)}}).then((function(e){return s&&s(j),E.end({resultType:a.ResultTypeEnum.Success}),r=i._isItem(e)?i._getState(r,{item:e}):i._getState(r,{nextExpectedRanges:e.nextExpectedRanges,speed:Math.min(C.didActivityHaveExtraCapacity()?O*l:O,1)})}),(function(e){return E.end({resultType:a.ResultTypeEnum.Failure,error:e.message,resultCode:Object(o.getResultCodeFromError)(e),extraData:Object(n.__assign)(Object(n.__assign)(Object(n.__assign)({},f),Object(o.getQosExtraDataFromError)(e)),{lastByte:F})}),i._getState(r,{error:e})}))).done((function(e){S.complete(e)})),S.getPromise()},e.prototype._uploadStreamState=function(e,t,r){var i=this,c=e.nextRange,s=t.headers,l=t.onProgress,d=t.content,m=t.content.size,p=t.qosData,f=r.sessionUrl,v=c.start,h=c.end,g=Math.min(h-v,this._maximumFragmentSize),O=v+g;l&&l(v);var _,b=new u.a((function(){_&&_.cancel()})),y=new a.Qos({name:"VroomUploader.uploadStream",extraData:Object(n.__assign)(Object(n.__assign)({},p),{startByte:v,endByte:O,fileSize:m,fragmentSize:g})});return(_=this._uploadService.uploadFragment({qosData:p,headers:s,sessionUrl:f,startByte:v,endByte:O,fileSize:m,content:d.slice(v,O),timeout:864e5,onProgress:function(e){l&&l(e)}}).then((function(e){return l&&l(O),y.end({resultType:a.ResultTypeEnum.Success}),r=i._isItem(e)?i._getState(r,{item:e}):i._getState(r,{nextExpectedRanges:e.nextExpectedRanges})}),(function(e){return y.end({resultType:a.ResultTypeEnum.Failure,error:e.message,resultCode:Object(o.getResultCodeFromError)(e),extraData:Object(n.__assign)(Object(n.__assign)(Object(n.__assign)({},p),Object(o.getQosExtraDataFromError)(e)),{lastByte:void 0})}),i._handleUploadStreamErrorState({nextRange:c},t,i._getState(r,{error:e}))}))).done((function(e){b.complete(e)})),b.getPromise()},e.prototype._handleUploadStreamErrorState=function(e,t,r){var n=this,o=e.nextRange;return this._handleErrorState(r,(function(e){switch(e){case 0:return n._wait({duration:1e3},t).then((function(){return n._getStatusState(t,r).then((function(e){return n._getNextRange({fileSize:t.content.size,nextExpectedRanges:e.nextExpectedRanges}).start>o.start?e:n._getState(r,{allowStreaming:!1})}))}))}}))},e.prototype._commitState=function(e,t){var r=this,i=e.qosData,c=e.onProgress;c&&c(e.content.size);var s=new a.Qos({name:"VroomUploader.commit",extraData:i});return this._uploadService.commit({qosData:i,itemUrl:e.itemUrl,accessToken:e.accessToken,fileName:e.fileName,sessionUrl:t.sessionUrl,conflictBehavior:t.conflictBehavior}).then((function(e){return s.end({resultType:a.ResultTypeEnum.Success}),r._getState(t,{item:e})}),(function(e){return r._handleCommitErrorState(r._getState(t,{error:e})).then((function(t){return s.end({resultType:t.error?a.ResultTypeEnum.Failure:a.ResultTypeEnum.ExpectedFailure,error:e.message,resultCode:Object(o.getResultCodeFromError)(e),extraData:Object(n.__assign)(Object(n.__assign)({},i),Object(o.getQosExtraDataFromError)(e))}),t}))}))},e.prototype._handleCommitErrorState=function(e){var t=this;return this._handleErrorState(e,(function(r){switch(r){case"uploadSessionFailed":case"uploadSessionNotFound":case 410:return c.a.resolve(t._getState(e,{error:void 0,sessionUrl:void 0}))}}))},e.prototype._cancelSessionState=function(e,t){var r=this,i=e.qosData,c=new a.Qos({name:"VroomUploader.cancelSession",extraData:i});return this._uploadService.cancelSession({qosData:e.qosData,sessionUrl:t.sessionUrl}).then((function(){return c.end({resultType:a.ResultTypeEnum.Success}),r._getState(t,{sessionUrl:void 0})}),(function(e){return c.end({resultType:a.ResultTypeEnum.Failure,error:e.message,resultCode:Object(o.getResultCodeFromError)(e),extraData:Object(n.__assign)(Object(n.__assign)({},i),Object(o.getQosExtraDataFromError)(e))}),r._getState(t,{sessionUrl:void 0})}))},e.prototype._handleUploadItemErrorState=function(e,t){var r=this,n=t.speed,o=void 0===n?1:n;return t=this._getState(t,{nextExpectedRanges:void 0}),this._handleErrorState(t,(function(n,a){switch(n){case 0:return window.navigator.onLine?t.allowStreaming?c.a.resolve(r._getState(t,{allowStreaming:!1})):c.a.resolve(r._getState(t,{speed:Math.max(o*(1/8),1/1920)})):void 0;case"uploadSessionFailed":case"uploadSessionNotFound":case 404:return c.a.resolve(r._getState(t,{error:void 0,sessionUrl:void 0}));case"entityTagDoesNotMatch":case"resourceModified":case"versionNumberDoesNotMatch":case"nameAlreadyExists":case"unlockRequired":case 409:case 412:return r._promptForConflictBehaviorState(a,e,t);case"invalidRange":case 416:return r._wait({duration:1e3},e).then((function(){return r._getState(t,{error:void 0})}))}}))},e.prototype._getItemIfCompletedState=function(e,t){var r=this,i=e.qosData,c=new a.Qos({name:"VroomUploader.getItemIfCompleted",extraData:i});return this._uploadService.getItem({qosData:i,fileName:e.fileName,itemUrl:e.itemUrl,accessToken:e.accessToken}).then((function(n){return c.end({resultType:a.ResultTypeEnum.Success}),e.lastModifiedDate&&n.fileSystemInfo&&n.fileSystemInfo.lastModifiedDateTime===e.lastModifiedDate.toISOString()&&n.size===e.content.size&&"rename"!==t.conflictBehavior?r._getState(t,{item:n,error:void 0}):r._getState(t,{error:new Error("The upload session has terminated but the existing item does not match the input.")})}),(function(e){return c.end({resultType:a.ResultTypeEnum.Failure,error:e.message,resultCode:Object(o.getResultCodeFromError)(e),extraData:Object(n.__assign)(Object(n.__assign)({},i),Object(o.getQosExtraDataFromError)(e))}),r._getState(t,{error:e})}))},e.prototype._handleGeneralErrorState=function(e,t){var r=this,n=t.waitDuration,o=void 0===n?500:n,a=t.attemptsRemaining,i=void 0===a?10:a;return this._handleErrorState(t,(function(n){switch(n){case"uploadSessionNotFound":return r._checkForCompletedUploadOnSessionTermination?r._getItemIfCompletedState(e,t):void 0;case"authFailure":case"unauthenticated":case 401:case"lockMismatch":case 423:case 501:case"quotaLimitReached":case 507:return}if("number"==typeof n){if(n>=400&&n<500)return;if(0===n||n>=500&&n<600)return r._wait({duration:o,allowWakeWhenOnline:!0},e).then((function(){return r._getState(t,{error:void 0,waitDuration:Math.min(2*o,3e4),attemptsRemaining:void 0})}));if(!i)return;return r._wait({duration:1e3},e).then((function(){return r._getState(t,{error:void 0,waitDuration:void 0,attemptsRemaining:Math.max(i-1,0)})}))}}))},e.prototype._handleErrorState=function(e,t){var r=e.error,n=Object(o.getErrorResolution)(r,t);return void 0===n&&(n=c.a.resolve(e)),n},e.prototype._promptForConflictBehaviorState=function(e,t,r){var i=this,s=t.onPromptForConfictBehavior,u=t.qosData,l=new a.Qos({name:"VroomUploader.promptForConflictBehavior",extraData:u});return c.a.resolve().then((function(){return s(e)})).then((function(e){return l.end({resultType:a.ResultTypeEnum.Success,extraData:u}),i._getState(r,{error:void 0,conflictBehavior:e})}),(function(t){return l.end({resultType:a.ResultTypeEnum.Failure,error:t.message,resultCode:Object(o.getResultCodeFromError)(e),extraData:Object(n.__assign)(Object(n.__assign)({},u),Object(o.getQosExtraDataFromError)(t))}),i._getState(r,{error:t})}))},e.prototype._wait=function(e,t){var r=e.duration,n=e.allowWakeWhenOnline,i=t.onWait,s=t.qosData,u=new a.Qos({name:"VroomUploader.wait",extraData:s});return c.a.resolve(i({duration:r,allowWakeWhenOnline:n})).then((function(){u.end({resultType:a.ResultTypeEnum.Success})}),(function(e){return u.end({resultType:c.a.isCanceled(e)?a.ResultTypeEnum.Success:a.ResultTypeEnum.Failure,error:e&&e.message,resultCode:Object(o.getResultCodeFromError)(e)}),c.a.reject(e)}))},e.prototype._getState=function(e,t){return Object(n.__assign)(Object(n.__assign)({},e),t)},e.prototype._getNextRange=function(e){var t=e.fileSize,r=e.nextExpectedRanges;return(void 0===r?[]:r).reduce((function(e,r){var n,o=r.split("-",2),a=o[0],i=o[1],c=parseInt(a,10);!e||c<e.start&&c<t?n={start:c,end:""===i?t:Math.min(parseInt(i,10)+1,t)}:n=e;return n}),void 0)},e.prototype._isItem=function(e){return!!e.id},e.prototype._getFragmentSize=function(e){var t,r=62914560*e;return t=r>327680?r-r%327680:r-r%32768,Math.min(Math.max(t,32768),this._maximumFragmentSize)},e}()},1349:function(e,t,r){e.exports=r(1350)},1350:function(e,t,r){"use strict";r.r(t),r.d(t,"Uploader",(function(){return u}));var n=r(0),o=r(106),a=r.n(o),i=r(209),c=r(183),s=r(515),u=function(){function e(e,t){var r=t.uploadService,n=t.uploadStateMachine,o=t.useStreamingUpload,a=void 0!==o&&o;this._uploadService=r,this._uploadStateMachine=n,this._useStreamingUpload=a}return e.prototype.upload=function(e){var t=e.conflictBehavior,r=Object(n.__rest)(e,["conflictBehavior"]),o=r.qosData,u=r.fileName,l=new c.Qos({name:"VroomUploader.upload",extraData:Object(n.__assign)(Object(n.__assign)({},o),{extension:Object(s.getFileExtension)(u,!0)})});return this._uploadState(r,{conflictBehavior:t,allowStreaming:this._useStreamingUpload}).then((function(e){return l.end({resultType:c.ResultTypeEnum.Success}),e}),(function(e){return l.end({resultType:a.a.isCanceled(e)?c.ResultTypeEnum.ExpectedFailure:c.ResultTypeEnum.Failure,error:e.message,resultCode:Object(i.getResultCodeFromError)(e),extraData:Object(n.__assign)(Object(n.__assign)({},o),Object(i.getQosExtraDataFromError)(e))}),a.a.reject(e)}))},e.prototype._uploadState=function(e,t){var r=this,n=t.sessionUrl,o=t.item,i=t.error;if(o)return a.a.resolve(o);if(i){var c=void 0;return n&&(c=this._uploadService.cancelSession({qosData:e.qosData,sessionUrl:n}).then((function(){}),(function(){}))),a.a.resolve(c).then((function(){return a.a.reject(i)}))}return this._uploadStateMachine.advanceState(e,t).then((function(t){return r._uploadState(e,t)}))},e}();t.default=u},1351:function(e,t,r){e.exports=r(908)},1352:function(e,t,r){e.exports=r(952)},1353:function(e,t,r){e.exports=r(182)},1354:function(e,t,r){e.exports=r(958)},1355:function(e,t,r){e.exports=r(954)},1356:function(e,t,r){e.exports=r(476)},1357:function(e,t,r){e.exports=r(1358)},1358:function(e,t,r){"use strict";r.r(t),r.d(t,"shareLinkActionControl",(function(){return o}));var n=r(14),o=new n.ControlFacet("getDefaultShareLinkActionControl")},1359:function(e,t,r){e.exports=r(1360)},1360:function(e,t,r){"use strict";r.r(t),r.d(t,"permissionInviteActionControl",(function(){return o}));var n=r(14),o=new n.ControlFacet("permissionInviteActionControl")},1361:function(e,t,r){e.exports=r(942)},1362:function(e,t,r){e.exports=r(472)},1363:function(e,t,r){e.exports=r(250)},1364:function(e,t,r){e.exports=r(1058)},1365:function(e,t,r){e.exports=r(313)},1417:function(e,t,r){"use strict";r.r(t),r.d(t,"graphAddonDataOnlyDeferred",(function(){return st}));var n=r(0),o=r(6),a=r(9),i=r(11),c=r(1337),s=r(1338),u=r(1339),l=r(1108),d=r(1352),m=r(1355),p=r(1018),f=r(1356),v=r(1361),h=r(1362),g=r(130),O=r(33),_=r(907),b=r(7),y=r(107),F=r(13),I=Object(o.createSingleItemOperationHandler)({mergeForSameItemKey:!1})((function(e){var t=e.itemKey,r=e.options.folders,o=i.driveItemKeyFacet.deserialize(t),a=o.endpoint,c=o.driveId,s=o.itemId,u=Object.keys(r)[0],l=r[u].progressItemKey,d=Object(g.n)(o);return function(e){return Object(n.__awaiter)(void 0,void 0,void 0,(function(){var r,m,p,f,v,h,I,j;return Object(n.__generator)(this,(function(S){switch(S.label){case 0:return r=Object(g.t)(o)+"/children",m={name:u,folder:{},"@microsoft.graph.conflictBehavior":"rename"},c&&s&&(m.parentReference={driveId:c,id:s}),[4,e(Object(O.getRawData)({url:r,driveUrl:d,method:"POST",body:m,qosName:"createFolder",endpoint:a}))];case 1:return p=S.sent(),f=i.driveItemKeyFacet.serialize({endpoint:a,driveId:c,itemId:p.id}),v=new F.ItemResolver,l&&v.resolveItems({items:(h={},h[l]=Object(n.__assign)({},_.createdItemFacet.pack({itemKey:f})),h)}),v.invalidateItems({items:(I={},I[t]=[b.defaultChildItemSetFacet],I)}),v.resolveItems({items:(j={},j[f]=Object(n.__assign)({},Object(y.e)({driveItem:p,parentFolderItemKey:t,endpoint:a})),j)}),e(v.execute()),[2]}}))}))}})),j=r(64),S=r(5),w=Object(o.createSingleItemOperationHandler)({mergeForSameItemKey:!1})((function(e){var t=e.itemKey,r=i.driveItemKeyFacet.deserialize(t);return function(e){return Object(n.__awaiter)(void 0,void 0,void 0,(function(){var o,a;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return o=Object(g.t)(r),[4,e(Object(O.getRawData)({url:o,method:"DELETE",qosName:"deleteItem",endpoint:r.endpoint}))];case 1:return n.sent(),e(Object(j.invalidateItems)({items:(a={},a[t]=[S.deletedFacet],a)})),[2]}}))}))}})),C=r(208),E=r(920),x=r(311),T=r(504),D=Object(o.createSingleItemOperationHandler)({mergeForSameItemKey:!1})((function(e){var t=e.itemKey,r=e.options.names,o=i.driveItemKeyFacet.deserialize(t);return function(e){return Object(n.__awaiter)(void 0,void 0,void 0,(function(){var a,i,c,s,u,l,d,m;return Object(n.__generator)(this,(function(p){switch(p.label){case 0:return a=Object.keys(r)[0],i=r[a],c=i.newName,s=i.newExtension,u=Object(g.t)(o),l=Object(g.n)(o),d=e(Object(x.readItem)({fileName:S.fileNameFacet},t)).fileName,m="string"==typeof s?s:d&&d.extension||"",[4,e(Object(O.getRawData)({url:u,driveUrl:l,method:"PATCH",body:{name:""+c+m},qosName:"renameItem",endpoint:o.endpoint})).then((function(r){var o,a,i=new F.ItemResolver;i.invalidateItems({items:(o={},o[t]=[S.displayNameFacet],o)}),i.resolveItems({items:(a={},a[t]=Object(n.__assign)(Object(n.__assign)({},S.displayNameFacet.pack(r.name)),S.fileNameFacet.pack(Object(y.t)(r.name||"",!!r.folder))),a)}),e(i.execute())})).catch((function(e){if(e instanceof T.GraphError&&e.status===C.STATUS_CODE_ZERO)throw new C.ItemOperationError({facets:Object(n.__assign)({},E.offlineErrorFacet.pack({})),innerError:e});throw e}))];case 1:return p.sent(),[2]}}))}))}})),R=r(1349),K=r(1345),U=r(1340),A=r(1347),k=r(1343),N=r(269),z=r(423),H=r(148),P=r(79),q=r(1351),B=r(17),W=r(2),L=r(106),M=r.n(L),V=r(568),G=Object(H.asOnceOnly)((function(){return new U.UploadWaiter({},{})})),Q=Object(H.asOnceOnly)((function(e){var t=e(O.getDataRequestor).dataRequestor,r=function(e){function t(t){return e.call(this,t,{performanceNow:k.performanceNow})||this}return Object(n.__extends)(t,e),t}(k.ActivityBandwidthVerifier),o=new K.UploadService({},{dataRequestor:t}),a=new A.UploadStateMachine({},{activityBandwidthVerifierType:r,uploadService:o});return new R.Uploader({},{uploadService:o,uploadStateMachine:a})})),Y=0;function J(e){var t=this,r=e.itemKey,o=e.options.sourceEntries,a=i.driveItemKeyFacet.deserialize(r),c=a.endpoint,s=a.driveId,u=Object.keys(o)[0],l=o[u],d=l.progressItemKey,m=l.conflictResolution,p=void 0===m?"fail":m;return function(e){return Object(n.__awaiter)(t,void 0,void 0,(function(){var t,o,l,m,f,v,h,O,I,j;return Object(n.__generator)(this,(function(S){switch(S.label){case 0:if(!(t=e(Object(x.readItem)({sourceFile:q.sourceFileFacet},u)).sourceFile))throw new Error("No source file for Graph upload.");return o=Object(g.t)(a)+":",l=Object(g.n)(a),d&&e(Object(B.resolveItems)({items:(h={},h[d]=Object(n.__assign)({},_.progressSizeFacet.pack({total:t.size,current:0})),h)})),[4,e(Z({progressItemKey:d,sourceFile:t,itemUrl:o,driveUrl:l,conflictResolution:p,endpoint:c}))];case 1:return m=S.sent(),f=i.driveItemKeyFacet.serialize({endpoint:c,driveId:s,itemId:m.id}),v=new F.ItemResolver,d&&v.resolveItems({items:(O={},O[d]=Object(n.__assign)(Object(n.__assign)({},_.createdItemFacet.pack({itemKey:f})),Object(W.pack)({progressSize:_.progressSizeFacet},{progressSize:{current:t.size}})),O)}),v.invalidateItems({items:(I={},I[r]=[b.defaultChildItemSetFacet],I)}),v.resolveItems({items:(j={},j[f]=Object(n.__assign)({},Object(y.e)({driveItem:m,parentFolderItemKey:r,endpoint:c})),j)}),[2,{itemResolver:v,driveItem:m,itemKey:f}]}}))}))}}function Z(e){var t=this,r=e.progressItemKey,o=e.sourceFile,a=e.itemUrl,i=e.driveUrl,c=e.endpoint,s=function(e){switch(e){case"rename":return"rename";case"replace":return"replace";default:return"fail"}}(e.conflictResolution);return function(e){return Object(n.__awaiter)(t,void 0,void 0,(function(){var t,u,d,m,p,f,v,h,g,O;return Object(n.__generator)(this,(function(b){switch(b.label){case 0:return t=e(Q),u=e(G),[4,e(Object(N.e)(c,i))];case 1:d=b.sent(),m=new z.e,p=0,f=m.debounce((function(t){var n;t>p&&(r&&e(Object(B.resolveItems)({items:(n={},n[r]=Object(W.pack)({progressSize:_.progressSizeFacet},{progressSize:{current:t}}),n)})),p=t)}),300,{leading:!1}),v=e(Object(P.readItems)((function(e){return e.demandItemFacet(_.cancelSourceFacet,r)}))),h=t.upload({conflictBehavior:s,qosData:{uploadId:""+ ++Y},accessToken:d,fileName:o.name,content:o,itemUrl:a,onProgress:f,onPromptForConfictBehavior:function(e){return Promise.reject(e)},onWait:function(e){return u.wait(e)},select:"*,sharepointIds"}),g=v?v.token.subscribe((function(){h.cancel()})):void 0,b.label=2;case 2:return b.trys.push([2,4,5,6]),[4,h];case 3:return[2,b.sent()];case 4:if(O=b.sent(),M.a.isCanceled(O))throw new V.CancelError;throw new l.UploadItemOperationError({facets:Object(n.__assign)({},Object(T.getErrorResolution)(O,(function(e){switch(e){case"authFailure":case"unauthenticated":case 401:return E.accessDeniedErrorFacet.pack({});case"nameAlreadyExists":case 409:return E.conflictErrorFacet.pack({supportsRename:!0})}}))||Object(W.pack)({},{})),innerError:O});case 5:return g&&g(),m.dispose(),[7];case 6:return[2]}}))}))}}var $=Object(o.createSingleItemOperationHandler)({mergeForSameItemKey:!1,maxParallelOperationCount:3,timeout:864e5})((function(e){var t=this;return function(r){return Object(n.__awaiter)(t,void 0,void 0,(function(){var t;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return[4,r(J(e))];case 1:return t=n.sent().itemResolver,r(t.execute()),[2]}}))}))}}));var X=r(272),ee=r(67),te=r(318),re=r(1353),ne=r(355),oe=(new re.ComputedItemFacet("addToOneDrive",(function(e,t){return ue(e,Object(n.__assign)(Object(n.__assign)({},t),{commandFacet:ee.e}))})),new re.ComputedItemFacet("canCreateFolder",(function(e,t){return ue(e,Object(n.__assign)(Object(n.__assign)({},t),{commandFacet:ee.t}))}))),ae=(new re.ComputedItemFacet("canCreateLink",(function(e,t){return ue(e,Object(n.__assign)(Object(n.__assign)({},t),{commandFacet:ee.n}))})),new re.ComputedItemFacet("canDelete",(function(e,t){return ue(e,Object(n.__assign)(Object(n.__assign)({},t),{commandFacet:ee.a}))}))),ie=new re.ComputedItemFacet("canDownload",(function(e,t){return!e.demandItemFacet(ne.oneNoteFacet,t.itemKey)&&ue(e,Object(n.__assign)(Object(n.__assign)({},t),{commandFacet:ee.i}))})),ce=(new re.ComputedItemFacet("canInvite",(function(e,t){return ue(e,Object(n.__assign)(Object(n.__assign)({},t),{commandFacet:ee.r}))})),new re.ComputedItemFacet("canMove",(function(e,t){return ue(e,Object(n.__assign)(Object(n.__assign)({},t),{commandFacet:ee.o}))})),new re.ComputedItemFacet("canUseOfficeLens",(function(e,t){return ue(e,Object(n.__assign)(Object(n.__assign)({},t),{commandFacet:ee.s}))})),new re.ComputedItemFacet("canRename",(function(e,t){return ue(e,Object(n.__assign)(Object(n.__assign)({},t),{commandFacet:ee.c}))}))),se=new re.ComputedItemFacet("canUpload",(function(e,t){return ue(e,Object(n.__assign)(Object(n.__assign)({},t),{commandFacet:ee.d}))}));function ue(e,t){var r=t.itemKey,n=t.commandFacet,o=e.demandItemFacet(i.driveItemKeyFacet,r);if(!o)return!1;var a=o.endpoint,c=o.driveId,s=e.demandItemFacet(n,te.e.serialize({endpoint:a,driveId:c}));return!!s&&!!s.roles&&function(e,t){var r=t.itemKey,n=t.oneOfRequiredRoles,o=function(e,t){if(function(e,t){var r=e.demandItemFacet(X.e,t);return!r||!r.effectiveRoles||!r.owner}(e,t))return["read","write","owner"];var r=e.demandItemFacet(X.e,t);if(r&&r.effectiveRoles)return r.effectiveRoles;return[]}(e,r);return function(e,t){var r=t.oneOfRequiredRoles,n=t.effectiveRoles;for(var o in n)if(o in r)return!0;return!1}(0,{oneOfRequiredRoles:n,effectiveRoles:o})}(e,{itemKey:r,oneOfRequiredRoles:s.roles})}var le=Object(a.createControlHandler)()((function(){return function(){return function(e,t){var r=t.itemKey;return{isAvailable:e.demandItemFacet(oe,r)}}}}));var de=r(1110),me=Object(a.createControlHandler)()((function(){return function(){return function(e,t){var r=t.itemKey;return{isAvailable:e.demandItemFacet(ce,r),validator:de.nameValidator}}}}));var pe=Object(a.createControlHandler)()((function(){return function(){return function(e,t){var r=t.itemKey;return{isAvailable:e.demandItemFacet(ae,r)}}}}));var fe=Object(a.createControlHandler)()((function(){return function(){return function(e,t){var r=t.itemKey;return{isAvailable:e.demandItemFacet(se,r)}}}}));var ve=Object(a.createControlHandler)()((function(){return function(e){return he}}));function he(e,t){if(1!==t.itemKeys.length)return{};var r=t.itemKeys[0];if(e.demandItemFacet(S.folderFacet,r))return{};var o=e.demandItemFacet(i.driveItemKeyFacet,r),a=o?Object(g.t)(o):void 0,c=o?Object(g.n)(o):void 0,s=o&&o.endpoint||"";return{isAvailable:e.demandItemFacet(ie,r),getDownloadData:a&&c?function(){return function(e){var t=this,r=e.itemUrl,o=e.driveUrl,a=e.endpoint;return function(i){return Object(n.__awaiter)(t,void 0,void 0,(function(){var t,c,s,u;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,i(Object(O.getRawData)({url:e.itemUrl,driveUrl:o,method:"GET",qosName:"getItemDownloadUrl",endpoint:a}))];case 1:if(t=n.sent(),!(c=function(e){return 0===e.toLowerCase().lastIndexOf("https://graph.microsoft.com",0)}(r)?t["@microsoft.graph.downloadUrl"]:t["@content.downloadUrl"]))throw new Error("Unable to obtain download URL.");return[2,{method:"GET",url:c}];case 2:throw(s=n.sent())instanceof T.GraphError?(u=Object(T.getErrorResolution)(s,(function(e,t){switch(e){case"unauthenticated":case 401:return E.authFailureErrorFacet.pack({});case"itemNotFound":case 404:return E.fileNotFoundErrorFacet.pack({});case"accessDenied":case 403:return E.accessDeniedErrorFacet.pack({});default:return E.offlineErrorFacet.pack({})}})),new C.ItemOperationError({innerError:s,facets:u})):s;case 3:return[2]}}))}))}}({itemUrl:a,driveUrl:c,endpoint:s})}:void 0}}var ge=Object(a.createControlHandler)()((function(){return function(e){return Oe}}));function Oe(e,t){var r=t.itemKey,o=e.demandItemFacet(i.driveItemKeyFacet,r);return{isAvailable:!0,getShareLink:function(){return function(e){var t=this;return function(r){return Object(n.__awaiter)(t,void 0,void 0,(function(){var t,o,a,i;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return(t=e.driveItem)?(o=Object(g.t)(t)+"/invite",a=Object(g.n)(t),[4,r(Object(O.getRawDataWithCache)({url:o,driveUrl:a,method:"POST",qosName:"getDefaultShareLink",endpoint:t.endpoint,headers:{prefer:"getDefaultLink","Content-type":"application/json"}}))]):[3,2];case 1:if(!(i=n.sent()))throw new Error("Unable to obtain default share URL");return[2,{url:i.value[0].link.webUrl,scope:i.value[0].link.scope}];case 2:throw new Error("Unable to obtain default share URL")}}))}))}}({driveItem:o})}}}var _e=Object(a.createControlHandler)()((function(){return function(){return function(){return{}}}}));var be=Object(a.createControlHandler)()((function(){return function(e){return ye}}));function ye(e,t){var r=t.itemKey,o=t.link,a=t.recipients,c=e.demandItemFacet(i.driveItemKeyFacet,r);return{isAvailable:!0,permissionInvite:function(){return function(e){var t=this;return function(r){return Object(n.__awaiter)(t,void 0,void 0,(function(){var t,o,a,i,c,s,u,l,d,m,p,f;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:if(t=e.driveItem,o=e.link,a=e.recipients,!t||!o)throw new Error("Unable to obtain default share URL");return i=t.endpoint,s=btoa(o),c="u!"+s.replace(/=/g,"").replace(/\//g,"_").replace(/\+/g,"-"),u=a.map((function(e){return{email:e}})),l={recipients:u,roles:["read"]},d=i.replace("v1.0","beta"),m=d+"/shares/"+c+"/permission/grant",[4,r(Object(O.getRawDataWithCache)({url:m,method:"POST",qosName:"permissionGrant",endpoint:t.endpoint,headers:{"Content-type":"application/json",Accept:"application/json"},body:l}))];case 1:return p=n.sent(),f=p.value[0].grantedToIdentities.map((function(e){return{email:e.user.email}})),[2,{recipients:f}]}}))}))}}({driveItem:c,link:o,recipients:a})}}}var Fe=r(1357),Ie=r(1359),je=r(212),Se=r(36),we=r(58),Ce=Object(o.createSingleItemOperationHandler)({mergeForSameItemKey:!1})((function(e){var t=e.itemKey,r=e.options,o=r.isFollowed,a=r.progressItemKey,c=je.e.deserialize(t),s=c.driveItemKey,u=s.itemId,l=void 0===u?"":u,d=Object(g.n)(s);return function(e){return Object(n.__awaiter)(void 0,void 0,void 0,(function(){var t,r,u,m,p,f,v,h,g;return Object(n.__generator)(this,(function(b){switch(b.label){case 0:t=e(Object(we.readConfiguration)({saveForLaterGraphEndpoint:Se.savedForLaterGraphEndpointConfigurationFacet})).saveForLaterGraphEndpoint,r=new F.ItemResolver,u=je.e.serialize(c),m=t||s.endpoint,a&&e(Object(B.resolveItems)({items:(v={},v[a]=Object(n.__assign)({},_.sourceItemFacet.pack({itemKey:i.driveItemKeyFacet.serialize(s)})),v)})),p=o?{url:m+"/drives/"+s.driveId+"/items/"+l+"/follow",method:"POST",qosName:"followItem"}:{url:m+"/drives/"+s.driveId+"/following/"+l,method:"DELETE",qosName:"unfollowItem"},b.label=1;case 1:return b.trys.push([1,3,,4]),[4,e(Object(O.getRawData)({url:p.url,driveUrl:d,method:p.method,qosName:p.qosName,endpoint:m}))];case 2:return b.sent(),r.invalidateItems({items:(h={},h[u]=[S.isFollowedFacet],h)}),r.resolveItems({items:(g={},g[u]=Object(n.__assign)({},S.isFollowedFacet.pack(o||void 0)),g)}),e(r.execute()),[3,4];case 3:throw f=b.sent(),new Error(f.message);case 4:return[2]}}))}))}})),Ee=r(1363),xe=r(1335),Te=r(53),De=r(350);function Re(e,t){return De.e.serialize(Object(n.__assign)({driveItemKey:e.driveItemKey},t?{searchTerm:t}:{searchTerm:void 0}))}var Ke=Object(a.createControlHandler)()(Ae),Ue=Object(a.createControlHandler)()(Ae);function Ae(){return function(e){return function(e,t){var r,n=t.itemKey,o=e.demandItemFacet(Te.driveItemSetKeyFacet,n);if(o)r=function(e){return o?Re(o,e):void 0};else{var a=e.demandItemFacet(De.e,n);r=function(e){return a?Re(a,e):void 0}}return{isAvailable:!0,getSearchItemKey:r}}}}var ke=r(576),Ne=r(577),ze=r(202),He=Object(a.createControlHandler)()((function(){return function(e){return Pe}}));function Pe(e,t){var r=t.handlers,o=t.itemKey,a=e.demandItemFacet(Te.driveItemSetKeyFacet,o),i=e.demandItemFacet(De.e,o);if(r&&(a||i)){for(var c=[],s=0,u=r;s<u.length;s++){var l=u[s];if(l.key===ze.itemPhotoTypeFilterHandler.key)c.push("photo");else if(l.key===ze.itemVideoTypeFilterHandler.key)c.push("video");else if(l.key===ze.itemFolderTypeFilterHandler.key)c.push("folder");else if(l.key===ze.itemOneNoteFilterHandler.key)c.push("onenote");else if(l.key===ze.itemNonPhotoTypeFilterHandler.key)c.push("!photo");else if(l.key===ze.itemNonVideoTypeFilterHandler.key)c.push("!video");else if(l.key===ze.itemNonFolderTypeFilterHandler.key)c.push("!folder");else if(l.key===ze.itemNonOneNoteFilterHandler.key)c.push("!onenote");else{var d=Object(Ne.getExtensionFilterFromFilterHandler)(l);d&&c.push(d)}}if(a)return{itemKey:Te.driveItemSetKeyFacet.serialize(Object(n.__assign)(Object(n.__assign)({},a),{extFilters:c}))}}return{}}var qe=r(1109),Be=r(236),We=r(190),Le=Object(o.createSingleItemOperationHandler)({mergeForSameItemKey:!1})((function(e){var t=e.itemKey,r=e.options,o=Object.keys(r)[0];return function(e){return Object(n.__awaiter)(void 0,void 0,void 0,(function(){var a,c,s,u,l,d,m,p,f,v,h,_,y,I;return Object(n.__generator)(this,(function(j){switch(j.label){case 0:if(!e(Object(P.readItems)((function(e){return e.demandItemFacet(i.driveItemKeyFacet,o)}))))throw new Error("Source item does not have a driveItem key");return a=r[o],c=a.isMove,s=a.conflictBehavior,u=a.progressItemKey,l=i.driveItemKeyFacet.deserialize(t),[4,e(Object(Be.demandItems)((function(e){return e.demandItemFacet(i.driveItemKeyFacet,o)})))];case 1:if(!(d=j.sent()))throw new Error("Unable to get metadata for destination item.");m=Object(g.t)(d),p=Object(g.n)(d),f=d.endpoint,j.label=2;case 2:return j.trys.push([2,4,,5]),[4,e(Object(O.getRawData)({url:m+(c?"":"/copy"),driveUrl:p,method:c?"PATCH":"POST",body:{parentReference:{id:l.itemId||We.ROOT_ITEM_ID,driveId:l.driveId||""},"@microsoft.graph.conflictBehavior":s},qosName:c?"moveItem":"copyItem",endpoint:f}))];case 3:return v=j.sent(),(h=new F.ItemResolver).invalidateItems({items:(y={},y[o]=c?[S.parentFolderItemFacet,S.deletedFacet]:[],y[t]=[b.defaultChildItemSetFacet],y)}),u&&!c&&v.name&&h.resolveItems({items:(I={},I[u]=Object(n.__assign)({},S.displayNameFacet.pack(v.name)),I)}),e(h.execute()),[3,5];case 4:if((_=j.sent())instanceof T.GraphError&&_.status===C.STATUS_CODE_ZERO)throw new qe.MoveCopyItemOperationError({innerError:_,facets:Object(n.__assign)({},E.httpStatusErrorFacet.pack(_.status))});throw _;case 5:return[2]}}))}))}})),Me=r(1354),Ve=Object(a.createControlHandler)()((function(){return function(){return function(e,t){return{validator:de.nameValidator}}}}));var Ge=r(151),Qe=r(274),Ye=r(155),Je=r(243),Ze=r(574),$e=r(83),Xe=r(957),et=r(560),tt=r(89),rt=r(218),nt=r.n(rt),ot=r(1035);function at(e){var t=this;return function(r){return Object(n.__awaiter)(t,void 0,void 0,(function(){var t,o,a,i,c,s,u,l,d,m,p,f,v,h,g,_,b,y,F;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return t=e.name,o=e.endpoint,a=e.sharepointIds,i=e.qosName,c=e.webAbsoluteUrl,s=r(Object(we.readConfiguration)({getUserOneDriveEndpoint:Se.getUserOneDriveEndpointFacet})).getUserOneDriveEndpoint,u=new nt.a(c).authority,(d=o)?[3,3]:(m=s)?[4,r(s({endpoint:u}))]:[3,2];case 1:m=n.sent(),n.label=2;case 2:d=m,n.label=3;case 3:if(l=d)return[3,4];throw new C.ItemOperationError({code:"A2ODAddToOneDrive_missingDriveEndpointInfo"});case 4:return p=l.replace("v2.0","v2.1"),f=p+"/drives/me/root/children",v=a.listId,h=a.listItemUniqueId,g=a.siteId,_=a.siteUrl,b=a.webId,y={name:t,remoteItem:{sharepointIds:{listId:v,listItemUniqueId:h,siteId:g,siteUrl:_,webId:b}},"@microsoft.graph.conflictBehavior":"rename"},F=[{code:"notAllowed"},{code:"shortcutAlreadyExists"},{code:"nestedDescendantShortcutExists"},{code:"nestedAscendantShortcutExists"}],[4,r(Object(O.getRawData)({url:f,qosName:i,method:"POST",body:y,expectedErrors:F,endpoint:l}))];case 5:return[2,n.sent()]}}))}))}}var it=Object(o.createSingleItemOperationHandler)()((function(e){var t=e.itemKey,r=e.options.itemSetKey;return function(e){return Object(n.__awaiter)(void 0,void 0,void 0,(function(){var o,a,c,s,u,l;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:if(!tt.e.matches(r))throw new C.ItemOperationError({code:"invalidItemSetForAddToOneDrive"});if(o=tt.e.deserialize(r).driveItemKey.endpoint,a=e(Object(P.readItems)((function(e){return{fileName:e.demandItemFacet(S.fileNameFacet,t),sharepointIds:e.demandItemFacet(et.e,t),remoteDriveInfo:e.demandItemFacet(i.driveItemKeyFacet,t)}}))),c=a.fileName,s=a.sharepointIds,u=a.remoteDriveInfo,!(o&&c&&u&&s))throw new C.ItemOperationError({code:"missingItemInfoForAddToOneDrive"});n.label=1;case 1:return n.trys.push([1,3,,4]),[4,e(at({name:c.name,sharepointIds:s,qosName:"AddToOneDrive_SWM",endpoint:o}))];case 2:return n.sent(),[3,4];case 3:if(!((l=n.sent())instanceof T.GraphError))throw l;return function(e,t,r){var n=Object(T.getErrorResolution)(e,(function(n,o){var a=e.response,c=a&&a.error;if(c){var s=c["@error.fixItItemIds"],u=c["@error.fixItWebUrl"],l=c["@error.fixItItemName"],d=[];if(s&&t&&r)for(var m=0,p=s;m<p.length;m++){var f=p[m],v=i.driveItemKeyFacet.serialize({endpoint:t,driveId:r,itemId:f});d.push(v)}switch(n){case"unauthenticated":case 401:return E.authFailureErrorFacet.pack({});case"itemNotFound":case 404:return E.fileNotFoundErrorFacet.pack({});case"accessDenied":case 403:return E.accessDeniedErrorFacet.pack({});case"shortcutAlreadyExists":return ot.n.pack({existShortcutUrl:u,existShortcutName:l});case"nestedDescendantShortcutExists":return ot.t.pack({nestDescendantItemKeys:d});case"nestedAscendantShortcutExists":return ot.e.pack({existShortcutUrl:u,existShortcutName:l});default:return E.offlineErrorFacet.pack({})}}}));throw new C.ItemOperationError({innerError:e,facets:n})}(l),[3,4];case 4:return[2]}}))}))}})),ct=Object(Qe.asModuleWithRetries)((function(){return r.e(8).then(r.bind(null,1480))}),{chunkName:"addon-graph-deferredoperations"}),st=Object(o.createAddon)((function(){return function(e){var t=e(Object(we.readConfiguration)({useBatchedDeleteConfiguration:Se.useBatchedDeleteConfigurationFacet})).useBatchedDeleteConfiguration;e(Object($e.asBatch)((function(){e(Object(a.registerControlHandler)(Te.driveItemSetKeyFacet,xe.itemsViewSearchControl)(Ke)),e(Object(a.registerControlHandler)(De.e,xe.itemsViewSearchControl)(Ue)),e(Object(a.registerControlHandler)(Te.driveItemSetKeyFacet,ke.filteredItemSetControl)(He)),e(Object(o.registerOperationHandler)(i.driveItemKeyFacet,c.createFolderOperation)(I)),e(t?Object(o.registerOperationHandler)(i.driveItemKeyFacet,s.deleteItemsOperation)(Object(o.createDeferredOperationHandler)((function(){return Object(n.__awaiter)(void 0,void 0,void 0,(function(){return Object(n.__generator)(this,(function(t){switch(t.label){case 0:return[4,e(Object(Ge.waitForPageLoad)())];case 1:return t.sent(),[4,ct()];case 2:return[2,t.sent().driveItemDeleteItemsBatchedOperationHandler]}}))}))}))):Object(o.registerOperationHandler)(i.driveItemKeyFacet,s.deleteItemsOperation)(w)),e(Object(o.registerOperationHandler)(i.driveItemKeyFacet,u.renameItemOperation)(D)),e(Object(o.registerOperationHandler)(i.driveItemKeyFacet,l.uploadItemsOperation)($)),e(Object(o.registerOperationHandler)(i.driveItemKeyFacet,qe.moveCopyItemsOperation)(Le)),e(Object(o.registerOperationHandler)(i.driveItemKeyFacet,Xe.t)(it)),e(Object(a.registerControlHandler)(i.driveItemKeyFacet,d.createFolderActionControl)(le)),e(Object(a.registerControlHandler)(i.driveItemKeyFacet,Me.createFolderDialogControl)(Ve)),e(Object(a.registerControlHandler)(i.driveItemKeyFacet,m.renameActionControl)(me)),e(Object(a.registerControlHandler)(i.driveItemKeyFacet,p.deleteActionControler)(pe)),e(Object(a.registerControlHandler)(i.driveItemKeyFacet,f.uploadItemsActionControl)(fe)),e(Object(a.registerControlHandler)(i.driveItemKeyFacet,Fe.shareLinkActionControl)(ge)),e(Object(a.registerControlHandler)(i.driveItemKeyFacet,Ie.permissionInviteActionControl)(be)),e(Object(a.registerControlHandler)(i.driveItemKeyFacet,v.downloadItemsActionControlFacet)(ve)),e(Object(a.registerControlHandler)(i.driveItemKeyFacet,h.followItemActionControl)(_e)),e(Object(o.registerOperationHandler)(je.e,Ee.followItemOperation)(Ce)),e(Object(o.registerOperationHandler)(Ye.e,Je.getItemsOperation)(Ze.e))})))}}))},1442:function(e,t,r){"use strict";r.r(t),r.d(t,"ValidatorErrorType",(function(){return n})),r.d(t,"isNameValid",(function(){return i})),r.d(t,"getErrorString",(function(){return c})),r.d(t,"createNameValidator",(function(){return s})),r.d(t,"nameValidator",(function(){return u})),r.d(t,"nameValidatorWithoutPoundPercent",(function(){return l}));var n,o=r(19),a=new Proxy({},{get:(e,t)=>localizationLoader.getLocalizedString("fKIhAYrGcRpBK0dU6G8Klg",t)});function i(e,t){var r=e.trim();return 0===r.length?n.Empty:t.invalidCharactersRegex.test(r)?n.InvalidCharacters:t.cannotStartWithRegex&&t.cannotStartWithRegex.test(r)?n.InvalidStart:t.cannotEndWithRegex&&t.cannotEndWithRegex.test(r)?n.InvalidEnd:void 0}function c(e,t){switch(e){case n.InvalidCharacters:return o.format(a.invalidNameError,t.invalidCharacters);case n.InvalidStart:return o.format(a.invalidNameStartError,t.cannotStartWith);case n.InvalidEnd:return o.format(a.invalidNameEndError,t.cannotEndWith);case n.Empty:return a.emptyNameError;case void 0:return}}function s(e){return function(t){return c(i(t,e),e)}}!function(e){e[e.InvalidStart=0]="InvalidStart",e[e.InvalidEnd=1]="InvalidEnd",e[e.InvalidCharacters=2]="InvalidCharacters",e[e.Empty=3]="Empty"}(n||(n={}));var u=s({invalidCharactersRegex:/["\*:<>\?\/\\\|]/,invalidCharacters:'" * : < > ? / \\ |'}),l=s({invalidCharactersRegex:/["\*:<>\?\/\\\|#%]/,invalidCharacters:'" * : < > ? / \\ # %|'})},1485:function(e,t,r){"use strict";r.r(t),r.d(t,"graphAddonDeferred",(function(){return Ze}));var n=r(6),o=r(275),a=r(357),i=r(9),c=r(188),s=r(268),u=r(2),l=r(1),d=r(435),m=r(0),p=r(205),f=r(55),v=r(358),h=r(336),g=r(51),O=r(957),_=r(164),b=r(166),y=new b.ControlFacet("addToOneDriveActionControl"),F=r(535),I=Object(F.createAsyncActionCreator)((function(e){return function(t){return Object(m.__awaiter)(void 0,void 0,void 0,(function(){var n;return Object(m.__generator)(this,(function(o){switch(o.label){case 0:return[4,r.e(5).then(r.bind(null,1488))];case 1:return n=o.sent().addToOneDriveWithProgress,[4,t(n(e))];case 2:return[2,o.sent()]}}))}))}})),j=Object(f.createItemCacheComponent)((function(e,t){var r=t.itemKey,n=t.addToOneDrive,o=void 0===n?O.e:n,a=Object(v.getCurrentItemSetKey)(e)||"";if(!r)return null;var i=e.dispatch,c=e.demandItemFacet(y,r),s=y.evaluate(c)(e,{itemKey:r,isAvailable:!1}).isAvailable;return l.createElement(p.Action,Object(m.__assign)({isAvailable:s,onExecute:function(){return Object(m.__awaiter)(void 0,void 0,void 0,(function(){var e,t;return Object(m.__generator)(this,(function(n){switch(n.label){case 0:return e={itemSetKey:a},t=Object(h.makeObject)([r],(function(){return e})),[4,i(o({items:t}))];case 1:return n.sent(),[2]}}))}))}},Object(_.getItemActionEngagement)(e,{itemKey:r,engagement:{name:"AddToOneDrive_Folder",isIntentional:!0,extraData:{itemCount:1}}})))}));var S=Object(f.connectToItemCache)((function(){return{addToOneDrive:I}}))(j),w=Object(g.withSelectedItems)()(Object(g.withCurrentItemAsFallback)()(Object(g.withExactlyOneItem)()(S))),C={action:l.createElement(w,null),automationId:"addShortcutFromSharedWithMeCommand",title:d.e.AddShortcutFromSharedWithMeTooltip,iconProps:{iconName:"FabricFolderLink"},key:new u.Facet("AddShortcutFromSharedWithMe").id,name:d.e.AddShortcutFromSharedWithMe},E=r(502),x=new b.ControlFacet("removeFromOneDriveActionControl",{}),T=Object(f.createItemCacheComponent)((function(e,t){var r=e.dispatch,n=t.itemKeys,o=t.removeFromOneDrive;if(!n.length)return null;for(var a=0,i=n;a<i.length;a++){var c=i[a],s=e.demandItemFacet(x,c);if(!x.evaluate(s)(e,{isAvailable:!1,itemKey:c}).isAvailable)return null}var u=Object(g.getCurrentItemSetKey)(e);return l.createElement(p.Action,Object(m.__assign)({onExecute:function(){return Object(m.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(m.__generator)(this,(function(t){switch(t.label){case 0:return e={currentItemSetKey:u},[4,r(o({items:Object(h.makeObject)(n,(function(){return e}))}))];case 1:return t.sent(),[2]}}))}))}},Object(_.getItemActionEngagement)(e,{engagement:{isIntentional:!0,name:"A2OD_RemoveFromOneDrive",privacyClassification:"requiredService"},itemKey:n[0]})))})),D=Object(g.withSelectedItems)()(T),R=Object(F.createAsyncActionCreator)((function(e){return function(t){return Object(m.__awaiter)(void 0,void 0,void 0,(function(){var n;return Object(m.__generator)(this,(function(o){switch(o.label){case 0:return[4,r.e(5).then(r.bind(null,1488))];case 1:return n=o.sent().removeFromOneDriveWithProgress,[4,t(n(e))];case 2:return[2,o.sent()]}}))}))}}));function K(){return{removeFromOneDrive:R}}Object(f.connectToItemCache)(K)(T);var U,A=Object(f.connectToItemCache)(K)(D),k={action:l.createElement(E.ShowOnlyWithSelection,null,l.createElement(A,null)),automationId:"removeShortcutFromSharedWithMeCommand",title:d.e.RemoveShortcutFromSWMTooltip,iconProps:{iconName:"FabricFolderLink"},key:new u.Facet("RemoveShortcutFromSWM").id,name:d.e.RemoveShortcutFromSWM},N=r(118),z=r(938),H=r(1364),P=r(898),q=new u.Facet("removeItemsFromSharedList"),B=new P.ProgressKeyFacet("removeItemsFromSharedList"),W=Object(P.implementOperationWithProgress)({operationTypeFacet:q,progressKeyFacet:B}),L=r(5),M=r(335),V=new b.ControlFacet("removeFromShardListActionControl"),G=Object(f.createItemCacheComponent)((function(e,t){var r=t.itemKeys,n=t.removeFromSharedListWizard,o=t.removeItemsFromSharedList,a=void 0===o?W:o,i=Object(v.getCurrentItemSetKey)(e)||"";if(0===r.length)return null;for(var c=r.length<=200,s=n,u=0,d=r;u<d.length;u++){var f=d[u],g=e.demandItemFacet(V,f);V.evaluate(g)(e,{itemKey:f,isAvailable:!1}).isAvailable||(c=!1)}var O=e.dispatch,b=function(){return Object(m.__awaiter)(void 0,void 0,void 0,(function(){var e,t;return Object(m.__generator)(this,(function(n){switch(n.label){case 0:return e={itemSetKey:i},t=Object(h.makeObject)(r,(function(){return e})),[4,O(a({items:t}))];case 1:return n.sent(),[2]}}))}))},y=Object(M.renderComponentOnExecute)((function(e){return l.createElement(s,Object(m.__assign)({},e,{onItemRemoved:b,itemKeys:r}))}));return l.createElement(p.Action,Object(m.__assign)({isAvailable:c,onExecute:y},Object(_.getItemActionEngagement)(e,{itemKey:void 0,engagement:{name:"RemoveFromSharedList",isIntentional:!0,extraData:{itemCount:r.length}}})))})),Q=Object(g.withSelectedItems)()(G),Y=new Proxy({},{get:(e,t)=>localizationLoader.getLocalizedString("z6lK/AGPNQ6arFUhvFUqkg",t)}),J=new Proxy({},{get:(e,t)=>localizationLoader.getLocalizedString("+dllkbVgq1DYWL5GlCEtTg",t)}),Z=r(19),$=r(907),X=r(1036),ee=((U={})[$.ProgressPhase.started]=function(e){return Object(Z.formatToArray)(Object(Z.getLocalizedCountValue)(J.removeStartedItemsTitle,J.removeCompletedItemsTitleIntervals,e)||"",e)},U[$.ProgressPhase.completed]=function(e){return Object(Z.formatToArray)(Object(Z.getLocalizedCountValue)(J.removeCompletedItemsTitle,J.removeCompletedItemsTitleIntervals,e)||"",e)},U[$.ProgressPhase.failed]=function(e){return Object(Z.formatToArray)(Object(Z.getLocalizedCountValue)(J.removeFailedItemsTitle,J.removeFailedItemsTitleIntervals,e)||"",e)},U[$.ProgressPhase.canceled]=function(e){return Object(Z.formatToArray)(Object(Z.getLocalizedCountValue)(J.removeFailedItemsTitle,J.removeFailedItemsTitleIntervals,e)||"",e)},U),te=Object(n.createAddon)((function(){return function(e){e(Object(i.registerControlHandler)(B,X.progressControl)(Object(i.createControlHandler)()(re)))}}));function re(){return function(e){return ne}}function ne(e,t){var r,n=Object(P.getOverallSimpleProgressBreakdown)(e,t),o=n.phase,a=n.count;return r=ee[o](a),Object(m.__assign)({},r&&"item"!==t.format?{title:r}:{})}var oe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(m.__extends)(t,e),t.prototype.render=function(){var e=this,t=this.props,r=t.resolve,n=t.reject,o=t.onItemRemoved,a=t.itemKeys,i=function(){return Object(m.__awaiter)(e,void 0,void 0,(function(){return Object(m.__generator)(this,(function(e){switch(e.label){case 0:return r(),[4,o()];case 1:return e.sent(),[2]}}))}))},c=function(){return Object(m.__awaiter)(e,void 0,void 0,(function(){return Object(m.__generator)(this,(function(e){return n(new N.CancelError),[2]}))}))};return l.createElement(z.WithItemCache,null,(function(e){var t=e.itemCache,r=ae(t,a),n=r.title,o=r.prompt;return l.createElement(H.ConfirmationDialog,{onCancel:c,onConfirm:i,yesText:J.removeFromSharedListConfirmButtonText,noText:Y.removeFromSharedListCancelButtonText,defaultToYes:!0,title:n,prompt:o})}))},t}(l.PureComponent),ae=function(e,t){if(t.length>1)return{title:Y.itemsTitleWithAccess,prompt:Y.itemsSubTextWithAccess};if(1===t.length){var r=e.demandItemFacet(L.folderFacet,t[0]);return{title:r?Y.folderTitleWithAccess:Y.fileTitleWithAccess,prompt:r?Y.folderSubTextWithAccess:Y.fileSubTextWithAccess}}return{title:"",prompt:""}},ie=Object(P.implementOperationWithProgress)({operationTypeFacet:q,progressKeyFacet:B,initializeBatch:function(){return te}});var ce=Object(f.connectToItemCache)((function(){return{removeFromSharedListWizard:oe,removeItemsFromSharedList:ie}}))(Q),se={key:new u.Facet("removeFromSharedList").id,automationId:"removeFromSharedListCommand",name:d.e.removeFromSharedList,title:d.e.removeFromSharedListTooltip,action:l.createElement(E.ShowOnlyWithSelection,null,l.createElement(ce,null)),iconProps:{iconName:"Cancel"}},ue=Object(i.createControlHandler)()((function(){return function(e){return de}}));var le=[c.openCommand,s.shareCommand,s.copyLinkCommand,C,k,se];function de(e,t){return{commands:le}}var me=r(1417),pe=r(211),fe=Object(i.createControlHandler)()((function(){return function(e){return he}}));var ve=[c.openCommand,s.shareCommand,s.copyLinkCommand,C,k,se];function he(e,t){return{commands:ve}}var ge,Oe=r(89),_e=r(581),be=r(54),ye=r(154),Fe=((ge={})[ye.DISPLAY_NAME_COLUMN_KEY]=!0,ge[ye.NAME_AND_PATH_COLUMN_KEY]=!0,ge[be.i]=!0,ge[be.e]=!0,ge[be.a]=!0,ge),Ie=Object(i.createControlHandler)()((function(){return function(e){return je}}));function je(e,t){var r=t.itemSetKey,n=t.handler,o=n.columnKey,a=n.isAscending;if(!Fe[o])return{};var i=e.demandItemFacet(Oe.e,r);if(!i)return{};var c=be.t[o];return c?{newItemSetKey:Oe.e.serialize(Object(m.__assign)(Object(m.__assign)({},i),{sortBy:c,isAscending:a}))}:{}}var Se,we=r(368),Ce=r(1365),Ee=r(575),xe=Object(i.createControlHandler)()((function(){return function(e){return function(e,t){var r=t.itemKey,n=e.demandItemFacet(Oe.e,r),o=n&&n.driveItemKey.endpoint,a=o&&Object(Ee.e)(e,{parentItemKey:pe.e.serialize({endpoint:o}),stageItem:t.stageItem});return Object(m.__assign)({},a?{stageItem:a}:{})}}}));var Te=((Se={})[be.i]=!0,Se[be.e]=!0,Se),De=Object(i.createControlHandler)()((function(){return function(e){return Re}}));function Re(e,t){var r=t.itemSetKey,n=t.handler.columnKey;if(!Te[n])return{};var o=e.demandItemFacet(Oe.e,r);if(!o)return{};var a=be.t[n];return a?{newItemSetKey:Oe.e.serialize(Object(m.__assign)(Object(m.__assign)({},o),{groupBy:a}))}:{}}var Ke=Object(i.createControlHandler)()((function(){return function(e){return Ue}}));function Ue(e,t){var r=t.itemSetKey,n=e.demandItemFacet(Oe.e,r);return n?{newItemSetKey:Oe.e.serialize(Object(m.__assign)(Object(m.__assign)({},n),{groupBy:void 0}))}:{}}var Ae=r(105),ke=Object(i.createControlHandler)()((function(){return function(e){return function(e,t){return{isAvailable:!1}}}}));var Ne=Object(i.createControlHandler)()((function(){return function(e){return function(e,t){return{isAvailable:!1}}}}));var ze=r(83),He=r(543),Pe=r(243),qe=r(13),Be=r(58),We=r(36),Le=r(33),Me=r(4),Ve=new Me.KeyFacet("topCollaboratorItemKeyFacet",{id:Object(Me.stringPart)()}),Ge=r(347),Qe=r(172),Ye=r(7),Je=Object(n.createSingleItemOperationHandler)()((function(e){var t=this,r=e.itemKey;return function(n){return Object(m.__awaiter)(t,void 0,void 0,(function(){var t,o,a,i,c,s,u,l,d,p,f,v,h,g,O,_;return Object(m.__generator)(this,(function(b){switch(b.label){case 0:return t=new qe.ItemResolver,o=n(Object(Be.readConfiguration)({graphEndpoint:We.graphEndpointConfigurationFacet})).graphEndpoint,a=He.e.deserialize(r),i=o||a.endpoint,c=i+"/me/people/",[4,n(Object(Le.getRawData)({url:c,qosName:"getTopCollaborator",endpoint:i}))];case 1:for(s=b.sent(),u=[],l=0,d=s.value;l<d.length;l++)p=d[l],f=p.id,v=p.displayName,h=p.userPrincipalName,g=Ve.serialize({id:f}),n(Object(Ge.resolveItems)({items:(O={},O[g]=Object(m.__assign)(Object(m.__assign)({},L.displayNameFacet.pack(v)),Qe.emailFacet.pack(h)),O)})),u.push(g);return t.resolveItems({items:(_={},_[e.itemKey]=Object(m.__assign)({},Ye.childItemsFacet.pack({itemKeys:u})),_)}),n(t.execute()),[2]}}))}))}}));var Ze=Object(n.createAddon)((function(){return function(e){e(Object(ze.asBatch)((function(){e(me.graphAddonDataOnlyDeferred),e(Object(i.registerControlHandler)(pe.e,o.itemsCommandBarControl)(fe)),e(Object(i.registerControlHandler)(pe.e,a.itemsContextMenuControl)(ue)),e(Object(i.registerControlHandler)(Oe.e,_e.sortedItemSetControl)(Ie)),e(Object(i.registerControlHandler)(Oe.e,we.openActionControl)(xe)),e(Object(i.registerControlHandler)(Oe.e,Ce.groupedItemSetControl)(De)),e(Object(i.registerControlHandler)(Oe.e,Ce.unGroupedItemSetControl)(Ke)),e(Object(i.registerControlHandler)(Ae.n,we.openActionControl)(ke)),e(Object(i.registerControlHandler)(Ae.t,we.openActionControl)(Ne)),e(Object(n.registerOperationHandler)(He.e,Pe.getItemsOperation)(Je))})))}}))},182:function(e,t,r){"use strict";r.r(t);var n=r(251);for(var o in n)["default"].indexOf(o)<0&&function(e){r.d(t,e,(function(){return n[e]}))}(o)},892:function(e,t,r){"use strict";r.r(t),r.d(t,"WithItemCache",(function(){return i}));var n=r(1),o=r(8),a=r(134),i=Object(o.connectToItemCache)((function(e,t){var r=t.children,n=e.dispatch;return{children:Object(a.renderChildrenWithProps)(r,{itemCache:e,dispatch:n})}}),(function(){return{}}))(n.Fragment);i.displayName="WithItemCache"},895:function(e,t,r){"use strict";r.r(t),r.d(t,"deleteItemsOperation",(function(){return i})),r.d(t,"deleteProgressKeyFacet",(function(){return c})),r.d(t,"deleteItems",(function(){return s})),r.d(t,"deleteItemsWithNoProgress",(function(){return u}));var n=r(3),o=r(60),a=r(332),i=new n.Facet("deleteItems"),c=new a.ProgressKeyFacet("deleteItems"),s=Object(a.implementOperationWithProgress)({operationTypeFacet:i,progressKeyFacet:c}),u=Object(o.implementOperation)({operationTypeFacet:i})},898:function(e,t,r){e.exports=r(332)},904:function(e,t,r){e.exports=r(912)},906:function(e,t,r){"use strict";r.r(t),r.d(t,"httpStatusErrorFacet",(function(){return o})),r.d(t,"conflictErrorFacet",(function(){return a})),r.d(t,"offlineErrorFacet",(function(){return i})),r.d(t,"accessDeniedErrorFacet",(function(){return c})),r.d(t,"retryErrorFacet",(function(){return s})),r.d(t,"fileNotFoundErrorFacet",(function(){return u})),r.d(t,"invalidNameErrorFacet",(function(){return l})),r.d(t,"fileSizeErrorFacet",(function(){return d})),r.d(t,"emptyFolderUnsupportedFacet",(function(){return m})),r.d(t,"overQuotaErrorFacet",(function(){return p})),r.d(t,"lockMismatchErrorFacet",(function(){return f})),r.d(t,"fileLockedErrorFacet",(function(){return v})),r.d(t,"authFailureErrorFacet",(function(){return h})),r.d(t,"folderUploadUnsupportedFacet",(function(){return g})),r.d(t,"targetFolderErrorFacet",(function(){return O})),r.d(t,"malwareErrorFacet",(function(){return _})),r.d(t,"throttleErrorFacet",(function(){return b})),r.d(t,"versionMismatchFacet",(function(){return y})),r.d(t,"itemNotFoundErrorFacet",(function(){return F}));var n=r(3),o=new n.Facet("httpStatus"),a=new n.Facet("conflict"),i=new n.Facet("offlineError"),c=new n.Facet("accessDeniedError"),s=new n.Facet("retryError"),u=new n.Facet("fileNotFound"),l=new n.Facet("invalidNameError"),d=new n.Facet("fileSizeError"),m=new n.Facet("emptyFolderUnsupported"),p=new n.Facet("overQuotaError"),f=new n.Facet("lockMismatchError"),v=new n.Facet("fileLockedError"),h=new n.Facet("authFailureError"),g=new n.Facet("folderUploadUnsupported"),O=new n.Facet("targetFolderError"),_=new n.Facet("malwareError"),b=new n.Facet("throttleError"),y=new n.Facet("versionMismatch"),F=u},907:function(e,t,r){e.exports=r(56)},908:function(e,t,r){"use strict";r.r(t),r.d(t,"entryBatchFacet",(function(){return o})),r.d(t,"sourceFileFacet",(function(){return a}));var n=r(3),o=new n.Facet("entryBatch"),a=new n.Facet("sourceFile")},912:function(e,t,r){"use strict";r.r(t);var n=r(346),o=function(){function e(e){this._promise=new n.SignalPromise(e)}return e.prototype.getPromise=function(){return this._promise},e.prototype.cancel=function(){this._promise.cancel()},e.prototype.complete=function(e){this._promise._completed(e)},e.prototype.error=function(e){this._promise._error(e)},e}();t.default=o},917:function(e,t,r){"use strict";r.r(t),r.d(t,"moveCopyItemsOperation",(function(){return c})),r.d(t,"moveCopyItemsProgressKeyFacet",(function(){return s})),r.d(t,"MoveCopyItemOperationError",(function(){return u}));var n=r(0),o=r(3),a=r(240),i=r(332),c=new o.Facet("moveCopyItems"),s=new i.ProgressKeyFacet("moveCopyItems"),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(n.__extends)(t,e),t}(a.ItemOperationError)},918:function(e,t,r){"use strict";r.r(t),r.d(t,"renameItemOperation",(function(){return i})),r.d(t,"renameProgressKeyFacet",(function(){return s})),r.d(t,"renameItem",(function(){return u}));var n=r(3),o=r(332),a=r(76),i=new n.Facet("renameItem"),c=new a.KeyFacet("renameItemProgressItem",{itemKey:Object(a.stringPart)(),oldName:Object(a.stringPart)()}),s=new o.ProgressKeyFacet("renameItems",(function(e,t){var r=Object.keys(t.names)[0];return c.serialize({itemKey:e,oldName:r})})),u=Object(o.implementOperationWithProgress)({operationTypeFacet:i,progressKeyFacet:s})},919:function(e,t,r){"use strict";r.r(t),r.d(t,"createFolderOperation",(function(){return a})),r.d(t,"createFolder",(function(){return i}));var n=r(3),o=r(60),a=new n.Facet("createFolder"),i=Object(o.implementOperation)({operationTypeFacet:a})},920:function(e,t,r){e.exports=r(906)},931:function(e,t,r){"use strict";r.r(t),r.d(t,"deleteActionControl",(function(){return a})),r.d(t,"deleteActionControler",(function(){return i}));var n=r(14),o=r(31),a=new n.ControlFacet("deleteActionControl",{deleteWizard:Object(o.e)()}),i=a},938:function(e,t,r){e.exports=r(892)},942:function(e,t,r){"use strict";r.r(t),r.d(t,"downloadItemsActionControlFacet",(function(){return a}));var n=r(14),o=r(31),a=new n.ControlFacet("downloadItemsActionControl",{downloader:Object(o.e)()})},945:function(e,t,r){e.exports=r(946)},946:function(e,t,r){"use strict";r.r(t);var n=r(0),o=r(520),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(n.__extends)(t,e),t.prototype.attached=function(e){var t=this,r=function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return t.attach(e.apply(this,r)||this)};if("undefined"!=typeof DEBUG&&DEBUG){var n=r;r=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return n.apply(Object.create(e.prototype),t)}}return r.prototype=e.prototype,r},t}(o.Scope);t.default=a},952:function(e,t,r){"use strict";r.r(t),r.d(t,"createFolderActionControl",(function(){return o}));var n=r(14),o=new n.ControlFacet("createFolderActionControl")},954:function(e,t,r){"use strict";r.r(t),r.d(t,"renameActionControl",(function(){return a}));var n=r(14),o=r(31),a=new n.ControlFacet("renameActionControl",{renameWizard:Object(o.e)()})},957:function(e,t,r){"use strict";r.d(t,"t",(function(){return a})),r.d(t,"n",(function(){return i})),r.d(t,"e",(function(){return c}));var n=r(2),o=r(898),a=new n.Facet("addToOneDrive"),i=new o.ProgressKeyFacet("addToOneDrive"),c=Object(o.implementOperationWithProgress)({operationTypeFacet:a,progressKeyFacet:i})},958:function(e,t,r){"use strict";r.r(t),r.d(t,"createFolderDialogControl",(function(){return o}));var n=r(14),o=new n.ControlFacet("createFolderDialogControl")}}]);
//# sourceMappingURL=index.graphaddondeferred.js.map