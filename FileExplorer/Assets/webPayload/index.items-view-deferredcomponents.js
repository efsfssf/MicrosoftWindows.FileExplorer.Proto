(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{1e3:function(e,t,n){"use strict";n.d(t,"e",(function(){return I}));var r=n(1),a=n(3),o=n(0),c=n(25),i=n(952),s=n(10),l=n(77),u=n(8),d=n(21),m=n(49),p=n(181),f=Object(p.asAsync)((function(){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(20).then(n.bind(null,1040))];case 1:return[2,e.sent().CreateFolderDialog]}}))}))})),b=Object(u.createItemCacheComponent)((function(e,t){var n=t.itemKey,a=t.createFolderWizard;if(!n)return null;var c=!0,u=e.demandItemFacet(s.folderFacet,n),p=e.demandItemFacet(i.createFolderActionControl,n),b=i.createFolderActionControl.evaluate(p)(e,{itemKey:n,isAvailable:!1,createFolderWizard:a}),v=b.isAvailable,h=b.createFolderWizard;v||(c=!1);var O=Object(d.renderComponentOnExecute)((function(e){return r.createElement(f,Object(o.__assign)({},e,{isAvailable:c&&!!u,itemKey:n,createFolderWizard:h}))}));return r.createElement(m.Action,Object(o.__assign)({isAvailable:c,onExecute:O},Object(l.getItemActionEngagement)(e,{itemKey:n,engagement:{name:"CreateFolder",isIntentional:!0}})))})),v=Object(c.withOnlyCurrentItem)()(b),h=Object(c.withCurrentItem)()(b),O=Object(p.asAsync)((function(){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(0),n.e(21)]).then(n.bind(null,1064))];case 1:return[2,e.sent().CreateFolderWizard]}}))}))})),g=(Object(u.connectToItemCache)((function(){return{createFolderWizard:O}}))(b),Object(u.connectToItemCache)((function(){return{createFolderWizard:O}}))(v)),_=(Object(u.connectToItemCache)((function(){return{createFolderWizard:O}}))(h),n(964)),j=n(951),y=n(418),I={key:new a.Facet("createFolder").id,automationId:"createFolderCommand",name:j.e.CreateFolder,ariaLabel:j.e.CreateFolder,action:r.createElement(y.HideWithSelection,null,r.createElement(g,null)),iconProps:Object(_.e)({size:16,type:2})}},1017:function(e,t,n){"use strict";n.r(t),n.d(t,"progressPanelControl",(function(){return o}));var r=n(14),a=n(31),o=new r.ControlFacet("progressPanelControl",{panelAs:Object(a.e)()})},1034:function(e,t,n){"use strict";n.r(t),n.d(t,"uploadItemsOperation",(function(){return i})),n.d(t,"uploadItems",(function(){return s})),n.d(t,"UploadItemOperationError",(function(){return l}));var r=n(0),a=n(60),o=n(240),c=n(3),i=new c.Facet("uploadItems"),s=Object(a.implementOperation)({operationTypeFacet:i}),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t}(o.ItemOperationError)},1045:function(e,t,n){"use strict";n.d(t,"e",(function(){return J}));var r=n(1),a=n(1443),o=n(0),c=n(61),i=n(16);Object(i.e)([{rawString:".tile_43a46e1f{display:block;position:relative;padding-bottom:8px}[dir='ltr'] .tile_43a46e1f{padding-right:40px}[dir='rtl'] .tile_43a46e1f{padding-left:40px}.tile_43a46e1f.hasIcon_43a46e1f{min-height:60px}[dir='ltr'] .tile_43a46e1f.hasIcon_43a46e1f{padding-left:56px}[dir='rtl'] .tile_43a46e1f.hasIcon_43a46e1f{padding-right:56px}.title_43a46e1f{display:inline;white-space:pre-line}.icon_43a46e1f{position:absolute;width:48px;display:block}[dir='ltr'] .icon_43a46e1f{left:0}[dir='rtl'] .icon_43a46e1f{right:0}.icon_43a46e1f.hasProgress_43a46e1f{top:8px}.progress_43a46e1f{display:block}.error_43a46e1f .progress_43a46e1f .ms-ProgressIndicator-itemProgress{display:none}.description_43a46e1f{font-size:12px}.error_43a46e1f .description_43a46e1f{color:"},{theme:"errorText",defaultValue:"#a4262c"},{rawString:"}.actions_43a46e1f{display:block;margin:8px 0 20px 0}.cancel_43a46e1f{position:absolute;display:block;top:0;width:32px;font-size:14px}[dir='ltr'] .cancel_43a46e1f{right:0}[dir='rtl'] .cancel_43a46e1f{left:0}\n"}]);var s=n(1435),l=n(892),u=n(501),d=n(424),m=n(332),p=n(548),f=n(19),b=n(894),v=n(56),h=n(10),O=n(178),g=n(21),_=n(990),j=n(46),y=n(49),I=n(25),F=n(8),w=Object(F.createItemCacheComponent)((function(e,t){var n=t.itemKeys.filter((function(t){return"started"===Object(m.getOverallSimpleProgressBreakdown)(e,{itemKey:t}).phase})),a=e.dispatch;return r.createElement(y.Action,{onExecute:function(){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){return a(Object(_.e)({items:Object(j.makeObject)(n,(function(){return{}}))})),[2]}))}))},isAvailable:n.length>0})})),C=Object(I.withSelectedItems)()(w),E=n(141),K=Object(F.createItemCacheComponent)((function(e,t){var n=t.itemKeys.filter((function(t){var n=e.demandItemFacet(E.isGroupFacet,t),r=Object(m.getOverallSimpleProgressBreakdown)(e,{itemKey:t}).phase;return n&&"failed"===r})),a=e.dispatch;return r.createElement(y.Action,{onExecute:function(){return Object(o.__awaiter)(void 0,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){return a(Object(m.expireProgressItems)({items:Object(j.makeObject)(n,(function(){return!0}))})),[2]}))}))},isAvailable:n.length>0})})),P=Object(I.withSelectedItems)()(K),k=n(118),S=n(415),x=n(1310),T=n(421),A=n(511);Object(i.e)([{rawString:".commandButton_acea5dc0{font-size:14px}\n"}]);var z,D,N=Object(F.createItemCacheComponent)((function(e,t){var n=t.commands;return Object(F.evaluateItemCacheComponent)(e,r.createElement(A.CommandSet,{commands:n},(function(e){var t=e.menuItems;return r.createElement(x.e,{direction:"horizontal"},t.map((function(e){var t=e.onClick,n=t?function(){t()}:void 0,a=e.commandBarButtonAs,o=a?Object(T.e)(a,S.e):S.e;return r.createElement(o,{className:"commandButton_acea5dc0",key:e.key,onClick:n},e.name)})))})))})),W=n(144),L=n(428),U=[],R=((z={})[v.ProgressPhase.started]=function(e){return Object(f.format)(Object(f.getLocalizedCountValue)(b.e.genericStartedItemsTitle,b.e.genericCompletedItemsTitleIntervals,e)||"",e)},z[v.ProgressPhase.completed]=function(e){return Object(f.format)(Object(f.getLocalizedCountValue)(b.e.genericCompletedItemsTitle,b.e.genericCompletedItemsTitleIntervals,e)||"",e)},z[v.ProgressPhase.failed]=function(e){return Object(f.format)(Object(f.getLocalizedCountValue)(b.e.genericFailedItemsTitle,b.e.genericFailedItemsTitleIntervals,e)||"",e)},z[v.ProgressPhase.canceled]=function(e){return Object(f.format)(Object(f.getLocalizedCountValue)(b.e.genericFailedItemsTitle,b.e.genericFailedItemsTitleIntervals,e)||"",e)},z),B=((D={})[v.ProgressPhase.created]=b.e.genericCreatedDescription,D[v.ProgressPhase.canceled]=b.e.genericCanceledDescription,D[v.ProgressPhase.completed]=b.e.genericCompletedDescription,D),H=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.render=function(){var e,t,n=this.props,a=n.icon,o=n.actions,i=n.cancel,l=n.description,u=n.title,d=u?r.createElement("div",{className:Object(c.e)("title_43a46e1f")},u):u,m=l?r.createElement("div",{className:Object(c.e)("description_43a46e1f")},l):l;return r.createElement("div",{className:Object(c.e)("tile_43a46e1f",(e={},e.hasIcon_43a46e1f=!!a,e.error_43a46e1f=!!this.props.error,e))},a?r.createElement("span",{className:Object(c.e)("icon_43a46e1f",(t={},t.hasProgress_43a46e1f=!this.props.progressHidden,t))},this.props.icon):null,r.createElement("div",{className:Object(c.e)("progress_43a46e1f")},r.createElement(s.e,{label:d,description:m,percentComplete:this.props.percentComplete,progressHidden:this.props.progressHidden})),o?r.createElement("div",{className:Object(c.e)("actions_43a46e1f")},o):null,i?r.createElement("span",{className:Object(c.e)("cancel_43a46e1f")},i):null)},t}(r.PureComponent),M=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.itemKey,a=t.format;return r.createElement(l.WithItemCache,null,(function(t){var c=t.itemCache,i=(t.dispatch,c.demandItemFacet(v.sourceItemFacet,n)),s=i&&i.itemKey,l=c.demandItemFacet(h.displayNameFacet,n)||c.demandItemFacet(h.displayNameFacet,s),f=c.demandItemFacet(O.errorFacet,n),_=c.demandItemFacet(u.progressControl,n),j=Object(m.getItemCountsByProgressPhase)(c,{itemKey:n}),y=Object(m.getOverallSimpleProgressBreakdown)(c,{itemKey:n}),I=y.phase,F=y.count,w=Object(m.getOverallProgressPhase)(c,{itemKey:n}),E=c.demandItemFacet(v.overallProgressSizeFacet,n),K=E?0!==E.total?E.current/E.total:void 0:I!==v.ProgressPhase.started?1:void 0,S=u.progressControl.evaluate(_)(c,Object(o.__assign)(Object(o.__assign)({itemKey:e.props.itemKey,title:l||R[I](F),description:f&&!Object(k.isCancel)(f)?f.message:B[w]},K?{percentComplete:K}:{}),{itemCountsByPhase:j,format:a,commands:U})),x=S.title,T=S.description,A=S.percentComplete,z=S.commands,D="started"===I?r.createElement(C,null):"failed"===I?r.createElement(P,null):null,M="started"===I||"failed"===I&&"number"==typeof A&&A<1;return r.createElement(W.e,{controlHandlers:L.selectedItemsControl.pack((function(e,t){return{itemKeys:[n]}}))},r.createElement(g.WithAction,{action:D},(function(e){var t=e.execute,n=e.isAvailable?function(){t().catch((function(){}))}:void 0;return r.createElement(H,{title:x,description:T,percentComplete:A,error:f&&!Object(k.isCancel)(f)?f:void 0,progressHidden:!M,icon:"item"===a?r.createElement(d.ItemFileTypeIcon,{itemKey:s,size:48}):void 0,cancel:n?r.createElement(p.e,{iconProps:{iconName:"Cancel"},ariaLabel:"started"===I?b.e.progresslistCancelButtonAriaLabel:b.e.progresslistRemoveButtonAriaLabel,onClick:n}):void 0,actions:z.length>0?r.createElement(N,{commands:z}):void 0})})))}))},t}(r.PureComponent);Object(i.e)([{rawString:".root_53a50724{overflow-x:hidden}.group_53a50724{margin:14px 0}.item_53a50724{margin:0}\n"}]);var Q=n(71),V=n(989),q=n(939),G=r.createContext(void 0),Z=function(){var e=r.createRef();return r.useEffect((function(){e&&e.current&&e.current.focus()})),r.createElement("p",{ref:e,tabIndex:-1},b.e.progressNoItemsMessage)},J=Object(F.createItemCacheComponent)((function(e,t){for(var n=t.itemKeys,o=t.groupsOnly,c=t.role,i=[],s=e.demandItemFacet(V.e,void 0),l=V.e.evaluate(s)(e,{}).groupControlHandler,u=function(t){if(Object(m.getOverallProgressPhase)(e,{itemKey:t})===v.ProgressPhase.expired)return"continue";var n=function(r,a){if(i.push({key:r,content:{itemKey:r,index:i.length},onRender:0===a?X:$}),!(o&&a>=1)){var c,s=e.demandItemFacet(V.t,t),u=e.demandItemFacet(Q.childItemsFacet,r),d=u&&u.itemKeys;d&&(c=d.filter((function(t){return!e.demandItemFacet(v.progressAggregationOnlyFacet,t)})));var m=V.t.evaluate(s,l)(e,{itemKey:r,childItemKeys:c,maxChildItemCount:void 0}).maxChildItemCount;if(c)for(var p=0,f="number"==typeof m?c.slice(0,m):c;p<f.length;p++){var b=f[p];n(b,a+1)}}};n(t,0)},d=0,p=n;d<p.length;d++){u(p[d])}return i.length>0?r.createElement(q.t.Provider,{value:i.length},r.createElement(G.Provider,{value:c},r.createElement(a.e,{className:"root_53a50724",items:i,role:c}))):r.createElement(Z,null)}));function X(e){var t=e.itemKey,n=e.index;return r.createElement(Y,{itemKey:t,index:n})}function Y(e){var t=e.itemKey,n=e.index,a=r.useContext(q.t),o=r.useContext(G);return r.createElement("div",{className:Object(c.e)("group_53a50724"),role:o?"presentation":"listitem","aria-posinset":o?void 0:n+1,"aria-setsize":o?void 0:a},r.createElement(M,{itemKey:t,format:"group"}))}function $(e){var t=e.itemKey,n=e.index;return r.createElement(ee,{itemKey:t,index:n})}function ee(e){var t=e.itemKey,n=e.index,a=r.useContext(q.t),o=r.useContext(G);return r.createElement("div",{className:Object(c.e)("item_53a50724"),role:o?"presentation":"listitem","aria-posinset":o?void 0:n+1,"aria-setsize":o?void 0:a},r.createElement(M,{itemKey:t,format:"item"}))}},1046:function(e,t,n){"use strict";n.d(t,"e",(function(){return P}));var r=n(1),a=n(3),o=n(78),c=n(418),i=n(517),s=n(0),l=n(142),u=n(423),d=n(455),m=n(16);Object(m.e)([{rawString:".input_8b157f37{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}\n"}]);var p={inputElement:null,files:void 0,hasNothingHappened:!1},f=function(e){function t(t){var n=e.call(this,t)||this;return n._onInputRef=function(e){n.setState({inputElement:e})},n._onInputChange=function(e){var t=e.target,r=t["test-files"]||t.files,a=[];if(r)for(var o=0,c=r.length;o<c;o++)a.push(r[o]);n.setState({files:a})},n._onNothingHappened=function(){n.setState((function(e){return Object(s.__assign)(Object(s.__assign)({},e),{hasNothingHappened:!e.files})}))},n.state=p,n._events=new l.e(n),n._async=new u.e(n),n}return Object(s.__extends)(t,e),t.prototype.render=function(){return r.createElement("input",{className:"input_8b157f37","data-automationid":"directory"===this.props.type?"commandFolderInput":"commandFileInput",type:"file",ref:this._onInputRef,multiple:!0,onChange:this._onInputChange})},t.prototype.componentDidMount=function(){this._onStateChanged(p)},t.prototype.componentDidUpdate=function(e,t){this._onStateChanged(t)},t.prototype.componentWillUnmount=function(){this._events.dispose(),this._async.dispose()},t.prototype._onStateChanged=function(e){var t=this.state,n=t.files,r=t.inputElement,a=t.hasNothingHappened,o=this.props,c=o.onContinue,i=o.onCancel;!e.files&&n?c(Object(d.t)(n)):!e.hasNothingHappened&&a?i():!e.inputElement&&r&&("directory"===this.props.type&&(r.webkitdirectory=!0),this._async.setTimeout(this._onNothingHappened,36e5),r.click())},t}(r.PureComponent),b=n(500),v=n(8),h=new b.PlatformDetection,O=Object(v.connectToItemCache)((function(){return{type:"file"}}))(f),g=Object(v.createItemCacheComponent)((function(e,t){return null})),_=h.isHtml5FileUploadSupported?Object(v.connectToItemCache)((function(){return{fileSelector:O}}))(i.t):g,j={key:new a.Facet("uploadFile").id,automationId:"uploadFileCommand",name:o.default.UploadFile,ariaLabel:o.default.UploadFile,action:r.createElement(c.HideWithSelection,null,r.createElement(_,null))},y=Object(v.createItemCacheComponent)((function(e,t){return null})),I=new b.PlatformDetection,F=Object(v.connectToItemCache)((function(){return{type:"directory"}}))(f),w=I.isFolderUploadSupported?Object(v.connectToItemCache)((function(){return{fileSelector:F}}))(i.t):y,C={key:new a.Facet("uploadFolder").id,automationId:"uploadFolderCommand",name:o.default.UploadFolder,ariaLabel:o.default.UploadFolder,action:r.createElement(c.HideWithSelection,null,r.createElement(w,null))},E=Object(a.getNextId)("upload"),K=new b.PlatformDetection,P={key:E,automationId:"uploadCommand",name:o.default.Upload,ariaLabel:o.default.Upload,title:o.default.UploadCommandTooltip,iconProps:{iconName:"upload"},action:K.isFolderUploadSupported?void 0:j.action,subMenuProps:K.isFolderUploadSupported?{items:[j,C]}:void 0}},1050:function(e,t,n){"use strict";n.r(t),n.d(t,"deleteCommand",(function(){return P}));var r=n(1),a=n(0),o=n(955),c=n(895),i=n(46),s=n(261),l=n(25),u=n(931),d=n(77),m=n(8),p=n(21),f=n(49),b=n(19),v=new(n(14).ControlFacet)("deleteItemsActionControl"),h=Object(m.createItemCacheComponent)((function(e,t){var n=t.itemKeys,l=t.deleteWizard,m=t.deleteItems,h=void 0===m?c.deleteItems:m;if(0===n.length)return null;for(var O=n.length>1,g=n[0],_=e.demandItemFacet(v,g),j=v.evaluate(_)(e,{itemKeys:n,isAvailable:!0,deleteWizard:l}),y=j.isAvailable,I=j.deleteWizard,F=0,w=n;F<w.length;F++){var C=w[F],E=e.demandItemFacet(u.deleteActionControler,C),K=u.deleteActionControler.evaluate(E)(e,{itemKey:C,isAvailable:!1,deleteWizard:l,isBatchDelete:O}),P=K.isAvailable,k=K.deleteWizard;P||(y=!1),I=k}var S=e.dispatch,x=Object(s.getCurrentItemSetKey)(e),T=function(){return Object(a.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(a.__generator)(this,(function(t){switch(t.label){case 0:return e={currentItemSetKey:x},[4,S(h({items:Object(i.makeObject)(n,(function(){return e}))}))];case 1:return t.sent(),[2]}}))}))},A=n.length,z=b.getLocalizedCountValue(o.e.deleteConfirmTextNew,o.e.deleteConfirmTextNewIntervals,A)||o.e.deleteConfirmText,D=Object(p.renderComponentOnExecute)((function(e){return r.createElement(I,Object(a.__assign)({},e,{onDelete:T,deleteWizardStrings:{confirmButtonText:o.e.deleteConfirmButtonText,confirmText:z,confirmTitle:o.e.deleteConfirmTitle},itemKeys:n}))}));return r.createElement(f.Action,Object(a.__assign)({isAvailable:y,onExecute:D},Object(d.getItemActionEngagement)(e,{itemKey:n[0],engagement:{name:"Delete",isIntentional:!0,privacyClassification:"requiredService"}})))})),O=Object(l.withSelectedItems)()(h),g=n(181),_=n(29),j=Object(g.asAsync)((function(){return Object(a.__awaiter)(void 0,void 0,void 0,(function(){return Object(a.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(0),n.e(2),n.e(3),n.e(6),n.e(22)]).then(n.bind(null,1484))];case 1:return[2,e.sent().DeleteWizard]}}))}))})),y=Object(_.createAsyncActionCreator)((function(e){return function(t){return Object(a.__awaiter)(void 0,void 0,void 0,(function(){var r;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return[4,Promise.all([n.e(0),n.e(2),n.e(3),n.e(6),n.e(22)]).then(n.bind(null,1484))];case 1:return r=a.sent().deleteItemsWithProgress,[4,t(r(e))];case 2:return[2,a.sent()]}}))}))}}));function I(){return{deleteWizard:j,deleteItems:y}}Object(m.connectToItemCache)(I)(h);var F=Object(m.connectToItemCache)(I)(O),w=n(78),C=n(418),E=n(503),K=n(3),P={key:Object(K.getNextId)("delete"),automationId:"deleteCommand",name:w.default.DeleteItem,ariaLabel:w.default.DeleteItem,action:r.createElement(C.ShowOnlyWithSelection,null,r.createElement(F,null)),iconProps:{iconName:"delete"},shortcutProps:{keySequences:["Delete"],content:E.e.deleteDesc}}},1051:function(e,t,n){"use strict";n.r(t),n.d(t,"renameCommand",(function(){return C}));var r=n(1),a=n(0),o=n(918),c=n(25),i=n(954),s=n(10),l=n(77),u=n(8),d=n(21),m=n(49),p=new Proxy({},{get:(e,t)=>localizationLoader.getLocalizedString("w5bmZpkm7kNki7nXQ8r5ZA",t)}),f=Object(u.createItemCacheComponent)((function(e,t){var n=t.itemKey,c=t.renameWizard,u=t.renameItem,f=void 0===u?o.renameItem:u;if(!n)return null;var b,v=!e.demandItemFacet(s.malwareDetectedFacet,n),h=e.demandItemFacet(s.fileNameFacet,n),O=h&&h.name||"",g=e.demandItemFacet(i.renameActionControl,n),_=i.renameActionControl.evaluate(g)(e,{itemKey:n,isAvailable:!1,renameWizard:c}),j=_.isAvailable,y=_.renameWizard,I=_.validator,F=_.lockedWarningMessage,w=_.title,C=_.isFolder;j||(v=!1),b=y;var E=e.dispatch,K=C?p.folderNameLabel:p.fileNameLabel,P=function(e){var t=e.name;return Object(a.__awaiter)(void 0,void 0,void 0,(function(){var e,r;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return[4,E(f({items:(e={},e[n]={names:(r={},r[O]={newName:t},r)},e)}))];case 1:return a.sent(),[2]}}))}))},k=Object(d.renderComponentOnExecute)((function(e){return r.createElement(b,Object(a.__assign)({},e,{isAvailable:v&&!!n&&!!h,itemKey:n,onRename:P,oldName:O,lockedWarningMessage:F,fileExtensionText:h&&h.extension,title:w,validator:I,nameFieldAriaLabel:K}))}));return r.createElement(m.Action,Object(a.__assign)({isAvailable:v,onExecute:k},Object(l.getItemActionEngagement)(e,{itemKey:n,engagement:{name:"Rename",isIntentional:!0,privacyClassification:"requiredService"}})))})),b=Object(c.withSelectedItems)()(Object(c.withExactlyOneItem)()(f)),v=n(181),h=n(29),O=Object(v.asAsync)((function(){return Object(a.__awaiter)(void 0,void 0,void 0,(function(){return Object(a.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(0),n.e(2),n.e(3),n.e(6),n.e(22)]).then(n.bind(null,1484))];case 1:return[2,e.sent().RenameWizard]}}))}))})),g=Object(h.createAsyncActionCreator)((function(e){return function(t){return Object(a.__awaiter)(void 0,void 0,void 0,(function(){var r;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return[4,Promise.all([n.e(0),n.e(2),n.e(3),n.e(6),n.e(22)]).then(n.bind(null,1484))];case 1:return r=a.sent().renameItemWithProgress,[4,t(r(e))];case 2:return[2,a.sent()]}}))}))}}));function _(){return{renameWizard:O,renameItem:g}}Object(u.connectToItemCache)(_)(f);var j=Object(u.connectToItemCache)(_)(b),y=n(78),I=n(418),F=n(503),w=n(3),C={key:Object(w.getNextId)("rename"),automationId:"renameCommand",name:y.default.Rename,ariaLabel:y.default.Rename,action:r.createElement(I.ShowOnlyWithSelection,null,r.createElement(j,null)),iconProps:{iconName:"rename"},shortcutProps:{content:F.e.renameDesc,keySequences:["F2"]}}},1065:function(e,t,n){"use strict";n.r(t),n.d(t,"followCommand",(function(){return u}));var r=n(0),a=n(1),o=n(546),c=n(78),i=n(3),s=Object(i.getNextId)("follow"),l=function(e){return e?c.default.RemoveFromSaved:c.default.SaveForLater},u={key:s,automationId:"followCommand",action:a.createElement(o.e,null),name:c.default.SaveForLater,postProcess:function(e){return Object(r.__assign)(Object(r.__assign)({},e),{name:e.iconOnly?void 0:l(e.actionState.isToggled)})},commandBarButtonAs:function(e){var t=e.defaultRender,n=e.actionState&&e.actionState.isToggled,o="boolean"==typeof n&&l(n)||void 0;return t?a.createElement(t,Object(r.__assign)({},e,{iconProps:{iconName:n?"SingleBookmarkSolid":"SingleBookmark"},name:e.iconOnly?void 0:o,text:e.iconOnly?void 0:o,title:o,ariaLabel:o})):null}}},1066:function(e,t,n){"use strict";n.r(t),n.d(t,"downloadCommand",(function(){return u}));var r=n(0),a=n(1),o=n(999),c=n(78),i=n(436),s=n(238),l=n(3),u={key:Object(l.getNextId)("download"),automationId:"downloadCommand",name:c.default.Download,ariaLabel:c.default.Download,action:a.createElement(i.ShowMalwareDetectedAction,{action:a.createElement(o.e,null)}),iconProps:{iconName:"download"},facets:Object(r.__assign)({},s.isReadonlyFacet.pack(!0))}},1127:function(e,t,n){"use strict";n.r(t),n.d(t,"MalwareDetectedDialog",(function(){return O})),n.d(t,"ProgressPanel",(function(){return k})),n.d(t,"ItemsContextMenu",(function(){return ne})),n.d(t,"NO_ITEMS",(function(){return L})),n.d(t,"ActionContextMenu",(function(){return U})),n.d(t,"Uploader",(function(){return re.Uploader}));var r=n(0),a=n(1),o=n(19),c=n(1436),i=n(873),s=n(255),l=n(663),u=n(415),d=n(118),m=new Proxy({},{get:(e,t)=>localizationLoader.getLocalizedString("wmpRw/KmQ9b4qBpO56/v5g",t)}),p=n(988),f=n(27),b=n(21),v=n(999),h=n(296);function O(e){var t=this,n=e.itemKey,O=e.resolve,_=e.reject,j=a.useState(!1),y=j[0],I=j[1],F=Object(h.useEventHandler)((function(){_(new d.CancelError)})),w=Object(f.w)();return a.createElement(b.WithAction,{action:a.createElement(v.t,{itemKeys:[n]})},(function(e){var n=e.isAvailable,d=e.execute,f=n?function(){return Object(r.__awaiter)(t,void 0,void 0,(function(){var e;return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),I(!0),[4,d()];case 1:return t.sent(),O(),[3,3];case 2:return e=t.sent(),_(e),[3,3];case 3:return[2]}}))}))}:void 0,b=n?m.malwareDetectedAllowDownloadMessage:m.malwareDetectedMessage;return y?null:a.createElement(i.e,{hidden:!1,onDismiss:F,title:m.malwareDetectedDialogHeader,closeButtonAriaLabel:m.closeButtonAriaLabel,type:s.e.close,styles:g,dialogContentProps:{styles:function(){return{title:{color:w.semanticColors.errorText,fontWeight:"500"}}}}},a.createElement(c.e,null,o.formatToArray(b,a.createElement("a",{href:"https://go.microsoft.com/fwlink/?linkid=862871",target:"_blank"},m.malwareDetectedLearnMore))),a.createElement(l.e,null,f?a.createElement(u.e,{onClick:f},m.malwareDialogDownload):null,a.createElement(u.e,{onClick:F,primary:!0},p.e.cancelActionText)))}))}function g(){return{main:{maxWidth:"450px !important"}}}var _=n(1500),j=n(332),y=n(894),I=n(1045),F=n(892),w=n(46),C=n(71),E=n(56),K=n(1017),P=[];function k(e){var t=e.resolve,n=a.useState(!0),r=n[0],o=n[1],c=Object(h.useEventHandler)((function(){o(!1)})),i=a.useCallback((function(e){var n=e.itemCache,o=e.dispatch,i=n.demandItemFacet(C.childItemsFacet,j.progressRootItemKey),s=i&&i.itemKeys||P,l=s.filter((function(e){var t=Object(j.getOverallProgressPhase)(n,{itemKey:e});return t===E.ProgressPhase.completed||t===E.ProgressPhase.canceled})),u=n.demandItemFacet(K.progressPanelControl,j.progressRootItemKey),d=K.progressPanelControl.evaluate(u)(n,{itemKeys:s,panelAs:_.e}).panelAs;return a.createElement(d,{isOpen:r,headerText:y.e.progressTitle,isLightDismiss:!0,onDismiss:c,onDismissed:function(){o(Object(j.expireProgressItems)({items:Object(w.makeObject)(l,(function(){return!0}))})),t()},closeButtonAriaLabel:y.e.progressCloseActionText},a.createElement(I.e,{itemKeys:s}))}),[r,t]);return a.createElement(F.WithItemCache,null,i)}var S=n(261),x=n(8),T=n(45),A=n(872),z=n(511),D=n(677),N=new Proxy({},{get:(e,t)=>localizationLoader.getLocalizedString("Gx3uM2FS3uwE0AIRIKnZBg",t)});var W=n(421),L=[],U=Object(x.createItemCacheComponent)((function(e,t){var n=t.items,o=void 0===n?L:n,c=t.directionalHint,i=void 0===c?T.e.rightTopEdge:c,s=t.isBeakVisible,l=void 0!==s&&s,u=t.isOpen,d=t.contextMenuAs,m=Object(r.__rest)(t,["items","directionalHint","isBeakVisible","isOpen","contextMenuAs"]),p=d?Object(W.e)(d,A.e):A.e;return a.createElement(z.CommandSet,{commands:t.commands},(function(e){var n=e.menuItems,c=Object(D.concat)(o,function e(t,n){var a=n.target,o=n.preserveIcons,c=void 0!==o&&o;return t.map((function(t){var o=t.subMenuProps,i=t.onClick,s=t.hasLaunchTarget,l=Object(r.__rest)(t,["subMenuProps","onClick","hasLaunchTarget"]);return Object(r.__assign)(Object(r.__assign)({},l),{name:t.iconProps&&"More"===t.iconProps.iconName?N.More:t.name,icon:void 0,iconProps:c?t.iconProps:void 0,subMenuProps:o?Object(r.__assign)(Object(r.__assign)({},o),{items:e(o.items,n)}):void 0,onClick:s&&i?function(e){e&&a&&(a instanceof Event?e.target=a.target:a instanceof Element&&(e.target=a)),i(e)}:i})}))}(n,t));return u?a.createElement(p,Object(r.__assign)({},m,{items:c,directionalHint:i,isBeakVisible:l})):null}))})),R=n(688),B=n(996),H=n(702),M=n(1046),Q=n(703),V=n(1066),q=n(1051),G=n(1050),Z=n(256),J=n(260),X=n(298),Y=n(1065),$=n(465),ee=[B.newCommand,H.openCommand,M.e,Q.shareCommand,Q.copyLinkCommand,Y.followCommand,V.downloadCommand,G.deleteCommand,q.renameCommand],te=Object(Z.createTelemetryProvider)({withContext:{component:"ContextMenu"}}),ne=Object(J.n)(te)(Object(x.createItemCacheComponent)((function(e,t){t.isOpen&&Object($.mark)("ItemsContextMenu.render");var n=Object(X.getCurrentItemKey)(e),o=Object(S.getCurrentItemSetKey)(e),c=t.commands,i=void 0===c?[]:c,s=e.demandItemFacet(R.itemsContextMenuControl,n),l=R.itemsContextMenuControl.evaluate(s)(e,{itemKey:n||"",itemSetKey:o,commands:ee,preserveIcons:t.preserveIcons}),u=l.commands,d=l.onMenuOpened,m=l.contextMenuAs,p=l.preserveIcons;return a.createElement(U,Object(r.__assign)({},t,{commands:Object(D.concat)(u,i),onMenuOpened:d,contextMenuAs:m,preserveIcons:p}))})));ne.displayName="ItemsContextMenu";var re=n(824)},824:function(e,t,n){"use strict";n.r(t),n.d(t,"Uploader",(function(){return Re}));var r=n(0),a=n(1),o=n(118),c=n(678),i=n(562),s=n(71),l=n(29),u=n(10),d=n(1034),m=n(919),p=n(56),f=n(60),b=n(332),v=n(62),h=n(20),O=n(3),g=n(141),_=n(300),j=n(35),y=n(908),I=n(178),F=n(76),w=new F.KeyFacet("uploadProgress",{sourceEntryKey:Object(F.stringPart)()});function C(e){return w.serialize({sourceEntryKey:e})}var E=n(81),K=n(345),P=n(251),k=new P.ComputedItemFacet("uploadStats",(function(e,t){var n,r={file:x(),folder:x(),extensions:{}},a=e.demandItemFacet(s.childItemsFacet,t.itemKey);if(a)for(var o=0,c=a.itemKeys;o<c.length;o++){var i=c[o],l=e.demandItemFacet(k,i);l&&(T(r.file,l.file),T(r.folder,l.folder),A(r.extensions,l.extensions))}var d=e.demandItemFacet(p.sourceItemFacet,t.itemKey),m=d&&d.itemKey;if(m){var f=e.demandItemFacet(u.folderFacet,m),b=e.demandItemFacet(p.progressPhaseFacet,t.itemKey),v=Object(p.getSimpleProgessPhase)(b||p.ProgressPhase.expired),h=Object(p.getItemCountsBySimpleProgressPhase)(v);if(e.demandItemFacet(y.entryBatchFacet,m));else if(f)T(r.folder,h);else{T(r.file,h);var O=e.demandItemFacet(u.fileNameFacet,m),g=O&&O.extension||"unknown";A(r.extensions,((n={})[g]=h,n))}}return r})),S=new P.ComputedItemFacet("overallUploadProgressSize",(function(e,t){var n=e.demandItemFacet(p.progressSizeFacet,t.itemKey);if(n)return n;var r=e.demandItemFacet(s.childItemsFacet,t.itemKey);if(r){for(var a={total:0,current:0},o=0,c=r.itemKeys;o<c.length;o++){var i=c[o],l=e.demandItemFacet(S,i);if(!l)return;a.total+=l.total,a.current+=l.current}return a}var d=e.demandItemFacet(p.sourceItemFacet,t.itemKey);if(d){var m=e.demandItemFacet(u.fileSizeFacet,d.itemKey);if("number"!=typeof m)return;return{total:m,current:e.demandItemFacet(p.createdItemFacet,t.itemKey)?m:0}}}));function x(e){var t={started:0,completed:0,canceled:0,failed:0};return e&&(t.started+=e.started,t.completed+=e.completed,t.failed+=e.failed,t.canceled+=e.canceled),t}function T(e,t){e.started+=t.started,e.completed+=t.completed,e.failed+=t.failed,e.canceled+=t.canceled}function A(e,t){for(var n=0,a=Object.keys(t);n<a.length;n++){var o=a[n],c=t[o];o in e?T(e[o],c):e[o]=Object(r.__assign)({},c)}}var z=n(594),D=n(232),N=n(928),W=n(127),L=0;var U=function(){},R={onItemQueued:U,onItemUploaded:U,onItemFailed:U,onEntryBatchCreated:U,onEntryBatchUploaded:U,onEntryBatchFailed:U};function B(e){var t=this,n=e.parentItemKey,a=e.sourceEntryKey,c=e.callbacks,i=void 0===c?R:c,s=e.options,l=void 0===s?{}:s;return function(c){return Object(r.__awaiter)(t,void 0,void 0,(function(){var t,s,u,d,m,p;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return c(b.progressAddon),t=++L,s={operation:B},c(Object(E.e)({owner:s,items:(p={},p[a]={},p)})),u=new o.CancelSource,e.cancelToken&&e.cancelToken.subscribe(u.cancel),[4,c(Q({sourceEntryKey:a}))];case 1:return d=r.sent(),[4,c(d({parentItemKey:n,cancelToken:u.token,callbacks:i,options:l,uploadId:t}))];case 2:m=r.sent().completed,r.label=3;case 3:return r.trys.push([3,,5,6]),[4,m];case 4:return r.sent(),[3,6];case 5:return u.dispose(),c(Object(E.n)({owner:s})),[7];case 6:return[2]}}))}))}}function H(e){var t=this,n=e.sourceEntryKey,a=e.cancelToken,o=e.onReceiveChildUploader,c=C(n);return function(e){return Object(r.__awaiter)(t,void 0,void 0,(function(){var t,i,l,u=this;return Object(r.__generator)(this,(function(d){switch(d.label){case 0:t={operation:H},e(Object(E.e)({owner:t,items:(i={},i[c]={},i)})),d.label=1;case 1:return d.trys.push([1,,3,4]),e(Object(v.resolveItems)({items:(l={},l[c]=Object(r.__assign)({},s.childItemsFacet.pack({itemKeys:[]})),l)})),[4,e(M({itemKey:n,cancelToken:a,onReceiveChildKeys:function(t){return Object(r.__awaiter)(u,void 0,void 0,(function(){var n,i,l,u,d,m,p=this;return Object(r.__generator)(this,(function(f){switch(f.label){case 0:for(a.throwIfCanceled(),n=new W.ItemResolver,i=0,l=t;i<l.length;i++)u=l[i],d=C(u),n.resolveItems({items:(m={},m[d]=Object(r.__assign)({},s.parentItemFacet.pack({itemKey:c})),m[c]=Object(O.pack)({childItems:s.childItemsFacet},{childItems:{itemKeys:new h.ArrayConcatIfNotMatchKeyPatch([d],(function(e){return e}))}}),m)});return e(n.execute()),[4,Object(_.waitForAll)(t.map((function(t){return Object(r.__awaiter)(p,void 0,void 0,(function(){var n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=o,[4,e(Q({sourceEntryKey:t}))];case 1:return n.apply(void 0,[r.sent()]),[2]}}))}))})))];case 1:return f.sent(),[2]}}))}))}}))];case 2:return d.sent(),[3,4];case 3:return e(Object(E.n)({owner:t})),[7];case 4:return[2]}}))}))}}function M(e){var t=this,n=e.itemKey,a=e.cancelToken,o=e.onReceiveChildKeys;return function(e){return Object(r.__awaiter)(t,void 0,void 0,(function(){var t,l,u=this;return Object(r.__generator)(this,(function(d){switch(d.label){case 0:return t={},[4,e(Object(c.demandItems)((function(e){var t=e.demandItemFacet(s.defaultChildItemSetFacet,n);return t&&t.itemKey})))];case 1:return(l=d.sent())?[4,e(Object(i.e)((function(e){a&&a.throwIfCanceled();var t=e.demandItemFacet(s.childItemsFacet,l),n=[];if(t)for(var r=0,o=t.itemKeys;r<o.length;r++){var c=o[r];e.isItemFacetResolved(s.pageFacet,c)?e.demandItemFacet(s.childItemsFacet,c):n.push(c)}return n}),(function(e){return Object(r.__awaiter)(u,void 0,void 0,(function(){var n,a,c,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:for(n=[],a=0,c=e;a<c.length;a++)(i=c[a])in t||(n.push(i),t[i]=!0);return[4,o(n)];case 1:return r.sent(),[2]}}))}))})))]:[2];case 2:return d.sent(),[2]}}))}))}}function Q(e){var t=this,n=e.sourceEntryKey;return function(e){return Object(r.__awaiter)(t,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return[4,e(Object(c.demandItems)((function(e){return e.demandItemFacet(y.entryBatchFacet,n)})))];case 1:return t.sent()?[2,V(n)]:[4,e(Object(c.demandItems)((function(e){return e.demandItemFacet(u.folderFacet,n)})))];case 2:return t.sent()?[2,q(n)]:[2,G(n)]}}))}))}}function V(e){var t=this;return Object(l.createAsyncActionCreator)((function(n){var a=n.parentItemKey,c=n.callbacks,i=n.options,l=n.uploadId,u=C(e);return function(d){var m,f,j=new o.CancelSource;n.cancelToken.subscribe(j.cancel);var y={operation:V};d(Object(E.e)({owner:{},items:(m={},m[u]={},m)})),d(Object(v.resolveItems)({items:(f={},f[b.progressRootItemKey]=Object(O.pack)({childItems:s.childItemsFacet},{childItems:{itemKeys:new h.ArrayConcatIfNotMatchKeyPatch([u],(function(e){return e}))}}),f[u]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},g.isGroupFacet.pack(!0)),p.cancelSourceFacet.pack(j)),p.sourceItemFacet.pack({itemKey:e})),p.destinationItemFacet.pack({itemKey:a})),f)}));var I=Object(r.__awaiter)(t,void 0,void 0,(function(){var t,n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=[],n=[],[4,d(H({sourceEntryKey:e,cancelToken:j.token,onReceiveChildUploader:function(e){j.token.throwIfCanceled();var r=d(e({parentItemKey:a,cancelToken:j.token,callbacks:c,options:i,uploadId:l})),o=r.started,s=r.completed;t.push(o),n.push(s)}}))];case 1:return r.sent(),[2,{startedWork:t,completedWork:n}]}}))})),F=Object(r.__awaiter)(t,void 0,void 0,(function(){var e,t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return t=(e=Promise).race,[4,I];case 1:return[4,t.apply(e,[n.sent().startedWork])];case 2:return n.sent(),[2]}}))})),w=Object(r.__awaiter)(t,void 0,void 0,(function(){var e;return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return e=_.waitForAll,[4,I];case 1:return[4,e.apply(void 0,[t.sent().completedWork])];case 2:return t.sent(),[2]}}))})),C=Object(r.__awaiter)(t,void 0,void 0,(function(){var e,t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:e=d(Z({uploadProgressKey:u,uploadId:l,qosName:"Uploader.uploadBatch"})),c.onEntryBatchCreated({progressItemKey:u}),n.label=1;case 1:return n.trys.push([1,,3,4]),[4,d(Object(b.trackItemProgress)({progressItemKey:u,started:F,completed:w,onStarted:function(e){},onCompleted:function(t){c.onEntryBatchUploaded({progressItemKey:u}),d(e({error:t.error}))},onFailed:function(t){c.onEntryBatchFailed({error:t.error||new Error("No error reported from batch upload."),progressItemKey:u}),d(e({error:t.error}))}}))];case 2:return n.sent(),[3,4];case 3:return d(Object(v.resolveItems)({items:(t={},t[u]=Object(O.pack)({cancelSource:p.cancelSourceFacet},{cancelSource:new h.Delete}),t)})),d(Object(E.n)({owner:y})),[7];case 4:return[2]}}))}));return{started:F,completed:Object(r.__awaiter)(t,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Object(_.waitForAll)([w,C])];case 1:return e.sent(),[2]}}))}))}}}))}function q(e){var t=this;return Object(l.createAsyncActionCreator)((function(n){var a=n.parentItemKey,i=n.callbacks,s=n.options,l=n.uploadId,d=C(e);return function(y){var F,w,K=new o.CancelSource;n.cancelToken.subscribe(K.cancel);var P={operation:q};y(Object(E.e)({owner:P,items:(F={},F[d]={},F[e]={},F)})),y(Object(v.resolveItems)({items:(w={},w[d]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},I.errorFacet.pack(void 0)),p.progressPhaseFacet.pack(p.ProgressPhase.created)),g.isGroupFacet.pack(!0)),p.destinationItemFacet.pack({itemKey:a})),p.sourceItemFacet.pack({itemKey:e})),p.cancelSourceFacet.pack(K)),w)}));var k=y(function(e){var t=this;return function(n){var a=e.sourceEntryKey,o=e.parentItemKey,i=e.cancelToken,s=C(a),l=Object(r.__awaiter)(t,void 0,void 0,(function(){var e,t,l,d,b,h,O,g,_,y=this;return Object(r.__generator)(this,(function(I){switch(I.label){case 0:return[4,n(Object(c.demandItems)((function(e){return e.demandItemFacet(u.fileNameFacet,a)})))];case 1:if(!(e=I.sent()))throw new Error("Invalid folder name.");return t={folders:(O={},O[e.name]={progressItemKey:s},O)},n(Object(v.resolveItems)({items:(g={},g[s]=Object(r.__assign)({},m.createFolderOperation.pack(t)),g)})),l=n(Object(f.startOperation)({operationTypeFacet:m.createFolderOperation,items:(_={},_[o]=t,_)})),d=l.started,b=l.completed,h=i.subscribe((function(){var e;n(Object(f.cancelOperation)({operationTypeFacet:m.createFolderOperation,items:(e={},e[o]=t,e)}))})),Object(r.__awaiter)(y,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){switch(e.label){case 0:return[4,d];case 1:return e.sent(),h(),[2]}}))})),[2,{started:d,itemCreated:Object(r.__awaiter)(y,void 0,void 0,(function(){var e,t;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,b];case 1:if(r.sent(),e=n(Object(j.readItems)((function(e){return e.demandItemFacet(p.createdItemFacet,s)}))),!(t=e&&e.itemKey))throw new Error("No folder created.");return[2,t]}}))}))}]}}))}));return{started:Object(r.__awaiter)(t,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){switch(e.label){case 0:return[4,l];case 1:return[4,e.sent().started];case 2:return e.sent(),[2]}}))})),itemCreated:Object(r.__awaiter)(t,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){switch(e.label){case 0:return[4,l];case 1:return[4,e.sent().itemCreated];case 2:return[2,e.sent()]}}))}))}}}({sourceEntryKey:e,parentItemKey:a,cancelToken:K.token})),S=k.started,x=k.itemCreated,T=Object(r.__awaiter)(t,void 0,void 0,(function(){var t,n,a;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,x];case 1:return t=r.sent(),n=[S],a=[],[4,y(H({sourceEntryKey:e,cancelToken:K.token,onReceiveChildUploader:function(e){var r=y(e({parentItemKey:t,cancelToken:K.token,callbacks:i,options:s,uploadId:l})),o=r.started,c=r.completed;n.push(o),a.push(c)}}))];case 2:return r.sent(),[2,{startedWork:n,completedWork:a}]}}))})),A=Object(r.__awaiter)(t,void 0,void 0,(function(){var e,t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return t=(e=Promise).race,[4,T];case 1:return[4,t.apply(e,[n.sent().startedWork])];case 2:return n.sent(),[2]}}))})),z=Object(r.__awaiter)(t,void 0,void 0,(function(){var e;return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return e=_.waitForAll,[4,T];case 1:return[4,e.apply(void 0,[t.sent().completedWork])];case 2:return t.sent(),[2]}}))})),D=Object(r.__awaiter)(t,void 0,void 0,(function(){var e,t,n=this;return Object(r.__generator)(this,(function(a){switch(a.label){case 0:e=y(Z({uploadProgressKey:d,uploadId:l,qosName:"Uploader.createFolder"})),i.onItemQueued({progressItemKey:d}),a.label=1;case 1:return a.trys.push([1,,3,4]),[4,y(Object(b.trackItemProgress)({progressItemKey:d,started:A,completed:Object(r.__awaiter)(n,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){switch(e.label){case 0:return[4,x];case 1:return e.sent(),[2]}}))})),onStarted:function(e,t){t&&t(e)},onCompleted:function(t,n){n&&n(t),i.onItemUploaded({progressItemKey:d}),y(e({error:t.error}))},onFailed:function(t,n){n&&n(t),i.onItemFailed({progressItemKey:d}),y(e({error:t.error}))}}))];case 2:return a.sent(),[3,4];case 3:return y(Object(v.resolveItems)({items:(t={},t[d]=Object(O.pack)({cancelSource:p.cancelSourceFacet},{cancelSource:new h.Delete}),t)})),K.dispose(),y(Object(E.n)({owner:P})),[7];case 4:return[2]}}))})),N=Object(r.__awaiter)(t,void 0,void 0,(function(){var e;return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return e=y(Z({uploadProgressKey:d,uploadId:l,qosName:"Uploader.uploadFolder"})),[4,y(Object(b.trackItemProgress)({progressItemKey:d,started:A,completed:z,onStarted:function(e,t){},onCompleted:function(t,n){var a,o=y(Object(j.readItems)((function(e){return{overallProgressCounts:e.demandItemFacet(p.overallProgressCountsFacet,d),overallProgressSize:e.demandItemFacet(p.overallProgressSizeFacet,d)}}))),c=o.overallProgressCounts,i=o.overallProgressSize,s=new W.ItemResolver;s.resolveItems({items:(a={},a[d]=Object(r.__assign)(Object(r.__assign)({},p.progressCountsFacet.pack(c)),p.progressSizeFacet.pack(i)),a)}),y(s.execute()),y(e({error:t.error}))},onFailed:function(t,n){y(e({error:t.error}))}}))];case 1:return t.sent(),[2]}}))}));return{started:A,completed:Object(r.__awaiter)(t,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Object(_.waitForAll)([z,D,N])];case 1:return e.sent(),[2]}}))}))}}}))}function G(e){var t=this;return Object(l.createAsyncActionCreator)((function(n){var a=n.parentItemKey,i=n.callbacks,s=n.options,l=n.uploadId,m=C(e);return function(y){var F,w,K=new o.CancelSource;n.cancelToken.subscribe(K.cancel);var P=y(Z({uploadProgressKey:m,uploadId:l,qosName:"Uploader.uploadFile"}));if(y(Object(j.readItems)((function(e){return e.demandItemFacet(p.createdItemFacet,m)}))))return{started:Object(r.__awaiter)(t,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){return[2]}))})),completed:Object(r.__awaiter)(t,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){return[2]}))}))};var k={operation:G};y(Object(E.e)({owner:k,items:(F={},F[m]={},F[e]={},F)})),y(Object(v.resolveItems)({items:(w={},w[m]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},I.errorFacet.pack(void 0)),p.progressPhaseFacet.pack(p.ProgressPhase.created)),g.isGroupFacet.pack(!1)),p.destinationItemFacet.pack({itemKey:a})),p.sourceItemFacet.pack({itemKey:e})),p.cancelSourceFacet.pack(K)),w)}));var S=y(function(e){var t=this,n=e.sourceEntryKey,a=e.parentItemKey,o=e.cancelToken,i=e.options,s=C(n);return function(e){var l,m,b={sourceEntries:(l={},l[n]=Object(r.__assign)({progressItemKey:s},i),l)};e(Object(v.resolveItems)({items:(m={},m[s]=Object(r.__assign)({},d.uploadItemsOperation.pack(b)),m)}));var h=Object(r.__awaiter)(t,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return[4,e(Object(c.demandItems)((function(e){return{fileSize:e.demandItemFacet(u.fileSizeFacet,n),fileName:e.demandItemFacet(u.fileNameFacet,n)}})))];case 1:return[2,t.sent()]}}))})),O=Object(r.__awaiter)(t,void 0,void 0,(function(){var t,n,c,i,l,u,m,O=this;return Object(r.__generator)(this,(function(g){switch(g.label){case 0:return[4,h];case 1:return void 0!==(t=g.sent().fileSize)&&e(Object(v.resolveItems)({items:(u={},u[s]=Object(r.__assign)({},p.progressSizeFacet.pack({total:t,current:0})),u)})),n=e(Object(f.startOperation)({operationTypeFacet:d.uploadItemsOperation,items:(m={},m[a]=b,m)})),c=n.started,i=n.completed,l=o.subscribe((function(){var t;e(Object(f.cancelOperation)({operationTypeFacet:d.uploadItemsOperation,items:(t={},t[a]=b,t)}))})),Object(r.__awaiter)(O,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){switch(e.label){case 0:return[4,c];case 1:return e.sent(),l(),[2]}}))})),[2,{started:c,completed:i}]}}))}));return{started:Object(r.__awaiter)(t,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){switch(e.label){case 0:return[4,O];case 1:return[4,e.sent().started];case 2:return e.sent(),[2]}}))})),completed:Object(r.__awaiter)(t,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){switch(e.label){case 0:return[4,O];case 1:return[4,e.sent().completed];case 2:return e.sent(),[2]}}))}))}}}({sourceEntryKey:e,parentItemKey:a,cancelToken:K.token,options:s})),x=S.started,T=S.completed,A=Object(r.__awaiter)(t,void 0,void 0,(function(){var e;return Object(r.__generator)(this,(function(t){switch(t.label){case 0:i.onItemQueued({progressItemKey:m}),t.label=1;case 1:return t.trys.push([1,,3,4]),[4,y(Object(b.trackItemProgress)({progressItemKey:m,started:x,completed:T,onStarted:function(e,t){t&&t(e)},onCompleted:function(e,t){t&&t(e),i.onItemUploaded({progressItemKey:m}),y(P({error:e.error}))},onFailed:function(e,t){t&&t(e),i.onItemFailed({progressItemKey:m}),y(P({error:e.error}))}}))];case 2:return t.sent(),[3,4];case 3:return y(Object(v.resolveItems)({items:(e={},e[m]=Object(O.pack)({cancelSource:p.cancelSourceFacet},{cancelSource:new h.Delete}),e)})),K.dispose(),y(Object(E.n)({owner:k})),[7];case 4:return[2]}}))}));return{started:x,completed:Object(r.__awaiter)(t,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Object(_.waitForAll)([T,A])];case 1:return e.sent(),[2]}}))}))}}}))}function Z(e){var t=e.qosName,n=e.uploadProgressKey,a=e.uploadId;return function(e){var o=e(Object(K.logQoS)({name:t}));return function(t){var c=t.error;return function(){var t=e(Object(j.readItems)((function(e){var t=e.demandItemFacet(p.sourceItemFacet,n),r=t&&t.itemKey,a=e.demandItemFacet(u.folderFacet,r),o=e.demandItemFacet(y.entryBatchFacet,r);return{entryBatch:o,folder:a,fileName:e.demandItemFacet(u.fileNameFacet,r),uploadStats:a||o?e.demandItemFacet(k,n):void 0,progressSize:e.demandItemFacet(S,n)}}))),i=t.entryBatch,s=t.folder,l=t.fileName,d=t.uploadStats,m=t.progressSize,f=Object(z.e)(l&&l.extension),b=i?"Batch":s?"Folder":"File",v=m?m.total:0,h=m?m.current:0;e(o(Object(N.mergeQosEndSchema)(Object(D.getQosEndSchemaFromError)(c),{extraData:Object(r.__assign)(Object(r.__assign)({uploadId:a,totalBytes:v,uploadedBytes:h,objectType:b},i?{}:{extension:f}),d?{"count.file.started":d.file.started,"count.file.completed":d.file.completed,"count.file.failed":d.file.failed,"count.file.canceled":d.file.canceled,"count.folder.started":d.folder.started,"count.folder.completed":d.folder.completed,"count.folder.failed":d.folder.failed,"count.folder.canceled":d.folder.canceled}:{})})))}}}}var J=n(117),X=n(240),Y=n(265),$=n(501),ee=n(19),te=new Proxy({},{get:(e,t)=>localizationLoader.getLocalizedString("RwLq20S1Efyu85xVcyjViw",t)}),ne=n(894),re=n(512),ae=n.n(re),oe=n(966),ce=n(990),ie=n(921),se=n(46),le=n(49),ue=n(25),de=n(8),me=Object(de.createItemCacheComponent)((function(e,t){var n=t.itemKeys.filter((function(t){return"failed"===Object(b.getOverallSimpleProgressBreakdown)(e,{itemKey:t}).phase})),o=e.dispatch;return a.createElement(le.Action,{onExecute:function(){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){return o(Object(ie.retryProgressItems)({items:Object(se.makeObject)(n,(function(){return{}}))})),[2]}))}))},isAvailable:n.length>0})})),pe=Object(ue.withSelectedItems)()(me),fe={key:new O.Facet("retryProgressCommand").id,name:ne.e.progressRetryActionText,action:a.createElement(pe,null)},be=new O.Facet("resolveProgressItemsOperation"),ve=Object(f.implementOperation)({operationTypeFacet:be}),he=Object(de.createItemCacheComponent)((function(e,t){var n=t.itemKeys,o=t.conflictResolution,c=n.filter((function(t){return"failed"===Object(b.getOverallSimpleProgressBreakdown)(e,{itemKey:t}).phase})),i=e.dispatch;return a.createElement(le.Action,{onExecute:function(){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){return i(ve({items:Object(se.makeObject)(c,(function(){return{conflictResolution:o}}))})),[2]}))}))},isAvailable:c.length>0})})),Oe=Object(ue.withSelectedItems)()(he),ge={key:new O.Facet("renameProgressCommand").id,name:ne.e.progressReplaceActionText,action:a.createElement(Oe,{conflictResolution:"replace"})},_e={key:new O.Facet("addNewVersionProgressCommand").id,name:ne.e.progressAddNewVersionActionText,action:a.createElement(Oe,{conflictResolution:"replace"})},je={key:new O.Facet("renameProgressCommand").id,name:ne.e.progressRenameActionText,action:a.createElement(Oe,{conflictResolution:"rename"})},ye=n(906),Ie=new F.KeyFacet("uploadProgress",{type:Object(F.stringPart)()}),Fe=n(26),we=n(126);var Ce,Ee,Ke=new(n(14).ControlFacet)("uploadProgress"),Pe=((Ce={})[p.ProgressPhase.started]=function(e){var t=e.count;return Object(ee.formatToArray)(Object(ee.getLocalizedCountValue)(te.uploadStartedItemsTitle,te.uploadCompletedItemsTitleIntervals,t)||"",t)},Ce[p.ProgressPhase.completed]=function(e){var t=e.count;return Object(ee.formatToArray)(Object(ee.getLocalizedCountValue)(te.uploadCompletedItemsTitle,te.uploadCompletedItemsTitleIntervals,t)||"",t)},Ce[p.ProgressPhase.failed]=function(e){var t=e.count;return Object(ee.formatToArray)(Object(ee.getLocalizedCountValue)(te.uploadFailedItemsTitle,te.uploadFailedItemsTitleIntervals,t)||"",t)},Ce[p.ProgressPhase.canceled]=function(e){var t=e.count;return Object(ee.formatToArray)(Object(ee.getLocalizedCountValue)(te.uploadFailedItemsTitle,te.uploadFailedItemsTitleIntervals,t)||"",t)},Ce),ke=((Ee={})[p.ProgressPhase.started]=function(e){var t=e.count,n=e.itemKey;return Object(ee.formatToArray)(Object(ee.getLocalizedCountValue)(te.uploadStartedItemsDestinationTitle,te.uploadCompletedItemsDestinationTitleIntervals,t)||"",t,a.createElement(oe.ItemLink,{key:"link",itemKey:n}))},Ee[p.ProgressPhase.completed]=function(e){var t=e.count,n=e.itemKey;return Object(ee.formatToArray)(Object(ee.getLocalizedCountValue)(te.uploadCompletedItemsDestinationTitle,te.uploadCompletedItemsDestinationTitleIntervals,t)||"",t,a.createElement(oe.ItemLink,{key:"link",itemKey:n}))},Ee[p.ProgressPhase.failed]=function(e){var t=e.count,n=e.itemKey;return Object(ee.formatToArray)(Object(ee.getLocalizedCountValue)(te.uploadFailedItemsDestinationTitle,te.uploadFailedItemsDestinationTitleIntervals,t)||"",t,a.createElement(oe.ItemLink,{key:"link",itemKey:n}))},Ee[p.ProgressPhase.canceled]=function(e){var t=e.count,n=e.itemKey;return Object(ee.formatToArray)(Object(ee.getLocalizedCountValue)(te.uploadFailedItemsDestinationTitle,te.uploadFailedItemsDestinationTitleIntervals,t)||"",t,a.createElement(oe.ItemLink,{key:"link",itemKey:n}))},Ee),Se=Object(J.createAddon)((function(){return function(e){e(Object(Y.registerControlHandler)(w,$.progressControl)(Object(Y.createControlHandler)()(xe))),e(Object(f.registerOperationHandler)(w,ce.t)(Object(J.createBatchedItemsOperationHandler)()((function(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,(function(){var t,a,o;return Object(r.__generator)(this,(function(c){for(t=n(Object(j.readItems)((function(t){var n=new W.ItemResolver,a=[];function o(e){var c,i=t.demandItemFacet(p.cancelSourceFacet,e);i&&a.push(i),n.resolveItems({items:(c={},c[e]=Object(r.__assign)(Object(r.__assign)({},i?{}:Object(r.__assign)({},p.progressPhaseFacet.pack(p.ProgressPhase.canceled))),Object(O.pack)({error:I.errorFacet},{error:new h.Delete})),c)});var l=t.demandItemFacet(s.childItemsFacet,e);if(l)for(var u=0,d=l.itemKeys;u<d.length;u++)o(d[u])}for(var c in e.items)Object.prototype.hasOwnProperty.call(e.items,c)&&o(c);return{itemResolver:n,sourcesToCancel:a}}))),n(t.itemResolver.execute()),a=0,o=t.sourcesToCancel;a<o.length;a++)o[a].cancel();return[2]}))}))}})))),e(Object(f.registerOperationHandler)(w,ie.retryProgressItemsOperation)(Object(J.createSingleItemOperationHandler)()(Ae))),e(Object(f.registerOperationHandler)(w,be)(Object(J.createSingleItemOperationHandler)()(ze)))}}));function xe(){return function(e){return Te}}function Te(e,t){var n,a=e.demandItemFacet(p.sourceItemFacet,t.itemKey),o=e.demandItemFacet(y.entryBatchFacet,a&&a.itemKey);n=a&&!o?function(e,t){var n,a=Object(we.getConfiguration)(e,{enableNewConflictUploadErrorStrings:Fe.enableNewConflictUploadErrorStringsConfigurationFacet}).enableNewConflictUploadErrorStrings,o=e.demandItemFacet(S,t.itemKey),c=o?o.total>0?o.current/o.total:1:void 0,i=Object(b.getOverallProgressPhase)(e,t),s=e.demandItemFacet(u.folderFacet,t.sourceItemKey);i===p.ProgressPhase.completed&&o?n=ae.a.getDisplayString(o.total):s?i!==p.ProgressPhase.created&&i!==p.ProgressPhase.started||(n=De(o)||ne.e.genericStartedIndeterminateDescription):i===p.ProgressPhase.started?n=De(o):i===p.ProgressPhase.created&&(n=ne.e.genericCreatedDescription);var l,d=e.demandItemFacet(I.errorFacet,t.itemKey),m=[];if(d)if(d instanceof X.ItemOperationError){var f=Object(O.unpack)({conflict:ye.conflictErrorFacet,retry:ye.retryErrorFacet,offline:ye.offlineErrorFacet,accessDenied:ye.accessDeniedErrorFacet,invalidName:ye.invalidNameErrorFacet,emptyFolder:ye.emptyFolderUnsupportedFacet,overQuota:ye.overQuotaErrorFacet,lockMismatch:ye.lockMismatchErrorFacet,authFailure:ye.authFailureErrorFacet,folderUpload:ye.folderUploadUnsupportedFacet,targetFolder:ye.targetFolderErrorFacet,malware:ye.malwareErrorFacet,throttle:ye.throttleErrorFacet},d.facets),v=f.conflict,h=f.retry,g=f.offline,_=f.accessDenied,j=f.invalidName,y=f.emptyFolder,F=f.overQuota,w=f.lockMismatch,C=f.authFailure,E=f.folderUpload,K=f.targetFolder,P=f.malware,k=f.throttle;v?(n=a?te.newConflictUploadWithoutRenameErrorText:te.conflictUploadWithoutRenameErrorText,m.push(a?_e:ge),v.supportsRename?(n=a?te.newConflictUploadErrorText:te.conflictUploadErrorText,l=Ie.serialize({type:"conflict+rename"}),m.push(je)):l=Ie.serialize({type:"conflict"})):_?(n=te.accessDeniedUploadErrorText,l=Ie.serialize({type:"accessDenied"})):j?(n=te.invalidNameUploadErrorText,m.push(je),l=Ie.serialize({type:"invalidName"})):y||E?(n=te.folderUploadNotSupported,l=Ie.serialize({type:"folderUpload"})):F?(n=te.overQuotaSharedFolderUploadErrorText,l=Ie.serialize({type:"overQuota"})):w?(n=te.lockMismatchUploadErrorText,m.push(fe),l=Ie.serialize({type:"lockMismatch"})):C?(n=te.authFailureUploadErrorText,m.push(fe),l=Ie.serialize({type:"authFailure"})):K?(n=te.targetFolderMissingUploadErrorText,l=Ie.serialize({type:"targetFolder"})):P?(n=te.malwareDetectedUploadErrorText,l=Ie.serialize({type:"malware"})):k?(n=te.throttledUploadErrorText,m.push(fe),l=Ie.serialize({type:"throttle"})):g?(n=te.disconnectedUploadText,m.push(fe),l=Ie.serialize({type:"offline"})):h||(n=d.message||te.generalUploadNoRetryErrorText,l=Ie.serialize({type:"noRetry"})),h&&(n=te.generalUploadErrorText,m.push(fe),l=Ie.serialize({type:"retry"}))}else n=d.message||te.generalUploadErrorText,m.push(fe),l=Ie.serialize({type:"unknown"});return Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({percentComplete:c},l?{errorKey:l}:{}),n?{description:n}:{}),{commands:m})}(e,{itemKey:t.itemKey,sourceItemKey:a.itemKey}):function(e,t){var n,a,o=e.demandItemFacet(S,t.itemKey),c=o?o.total>0?o.current/o.total:1:void 0,i=e.demandItemFacet(p.destinationItemFacet,t.itemKey),s=i&&i.itemKey,l=Object(b.getOverallSimpleProgressBreakdown)(e,t),u=l.phase,d=l.count;return u===p.ProgressPhase.completed&&o?n=ae.a.getDisplayString(o.total):u===p.ProgressPhase.started&&(n=De(o)||ne.e.genericStartedIndeterminateDescription),a="group"===t.format&&s?ke[u]({count:d,itemKey:s}):Pe[u]({count:d}),Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},a&&"item"!==t.format?{title:a}:{}),n?{description:n}:{}),{percentComplete:c})}(e,t);var c=e.demandItemFacet(Ke,t.itemKey),i=Ke.evaluate(c)(e,{itemKey:t.itemKey,commands:n.commands,description:n.description}),s=i.description,l=i.commands,d=void 0===l?[]:l;return Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},n),{commands:d}),s?{description:s}:{})}function Ae(e){var t=this,n=e.itemKey;return function(e){return Object(r.__awaiter)(t,void 0,void 0,(function(){var t,a,o,c,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(t=e(Object(j.readItems)((function(e){return{sourceItem:e.demandItemFacet(p.sourceItemFacet,n),destinationItem:e.demandItemFacet(p.destinationItemFacet,n)}}))),a=t.sourceItem,o=t.destinationItem,c=a&&a.itemKey,i=o&&o.itemKey,!c)throw new Error("No source entry to retry.");if(!i)throw new Error("No parent item to retry.");return[4,e(B({sourceEntryKey:c,parentItemKey:i}))];case 1:return r.sent(),[2]}}))}))}}function ze(e){var t=this,n=e.itemKey,a=e.options;return function(e){return Object(r.__awaiter)(t,void 0,void 0,(function(){var t,o,c,i,s;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(t=e(Object(j.readItems)((function(e){return{sourceItem:e.demandItemFacet(p.sourceItemFacet,n),destinationItem:e.demandItemFacet(p.destinationItemFacet,n)}}))),o=t.sourceItem,c=t.destinationItem,i=o&&o.itemKey,s=c&&c.itemKey,!i)throw new Error("No source entry to retry.");if(!s)throw new Error("No parent item to retry.");return[4,e(B({sourceEntryKey:i,parentItemKey:s,options:a}))];case 1:return r.sent(),[2]}}))}))}}function De(e){return e&&e.total>0?Object(ee.format)(ne.e.genericStartedByteProgressDescription,ae.a.getDisplayString(e.current),ae.a.getDisplayString(e.total)):void 0}var Ne=n(991),We=n(408),Le=n(296),Ue=n(162);function Re(e){var t=this,n=e.resolve,c=e.reject,i=e.entries,s=e.itemKey,l=e.onUploadStarted,u=e.onUploadCompleted,d=e.onUploadFailed,m=e.onItemQueued,p=e.onItemUploaded,f=e.onItemFailed,b=a.useState(!1),v=b[0],h=b[1],O=a.useState(!1),g=O[0],_=O[1],j=a.useState(),y=j[0],I=j[1],F=a.useState(!1),w=F[0],C=F[1],E=a.useRef(),K=E.current||(E.current=new o.CancelSource);a.useLayoutEffect((function(){return function(){K.dispose(),E.current=void 0}}),[]);var P=Object(We.usePreviousValue)(g),k=Object(We.usePreviousValue)(y),S=Object(We.usePreviousValue)(w),x=Object(Ue.useItemCacheDispatch)(),T=Object(Le.useEventHandler)((function(e){l&&l(e)})),A=Object(Le.useEventHandler)((function(e){u&&u(e)})),z=Object(Le.useEventHandler)((function(e){d&&d(e)})),D=Object(Le.useEventHandler)((function(e){m&&m(e)})),N=Object(Le.useEventHandler)((function(e){p&&p(e)})),W=Object(Le.useEventHandler)((function(e){f&&f(e)})),L=Object(Le.useEventHandler)((function(){return Object(r.__awaiter)(t,void 0,void 0,(function(){var e,t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:h(!0),n.label=1;case 1:return n.trys.push([1,3,,4]),x(Se),e=x(Object(Ne.e)({entries:i})).itemKey,[4,x(B({parentItemKey:s,sourceEntryKey:e,callbacks:{onEntryBatchCreated:T,onEntryBatchFailed:z,onEntryBatchUploaded:A,onItemFailed:W,onItemUploaded:N,onItemQueued:D},cancelToken:K.token}))];case 2:return n.sent(),K.token.isCanceled()?[2]:(C(!0),[3,4]);case 3:return t=n.sent(),K.token.isCanceled()?[2]:(Object(o.isCancel)(t)?_(!0):I(t),[3,4]);case 4:return[2]}}))}))}));return a.useLayoutEffect((function(){w&&!S?n():y&&!k?c(y):g&&!P?c(new o.CancelError):v||L()}),[v,g,y,w]),null}},892:function(e,t,n){"use strict";n.r(t),n.d(t,"WithItemCache",(function(){return c}));var r=n(1),a=n(8),o=n(134),c=Object(a.connectToItemCache)((function(e,t){var n=t.children,r=e.dispatch;return{children:Object(o.renderChildrenWithProps)(n,{itemCache:e,dispatch:r})}}),(function(){return{}}))(r.Fragment);c.displayName="WithItemCache"},894:function(e,t,n){"use strict";var r=new Proxy({},{get:(e,t)=>localizationLoader.getLocalizedString("6jFjkkZMXzaW3GLQ0f2nLA",t)});t.e=r},895:function(e,t,n){"use strict";n.r(t),n.d(t,"deleteItemsOperation",(function(){return c})),n.d(t,"deleteProgressKeyFacet",(function(){return i})),n.d(t,"deleteItems",(function(){return s})),n.d(t,"deleteItemsWithNoProgress",(function(){return l}));var r=n(3),a=n(60),o=n(332),c=new r.Facet("deleteItems"),i=new o.ProgressKeyFacet("deleteItems"),s=Object(o.implementOperationWithProgress)({operationTypeFacet:c,progressKeyFacet:i}),l=Object(a.implementOperation)({operationTypeFacet:c})},897:function(e,t,n){"use strict";var r;n.d(t,"e",(function(){return r})),function(e){e[e.Word=1]="Word",e[e.Excel=2]="Excel",e[e.PowerPoint=3]="PowerPoint",e[e.OneNote=4]="OneNote",e[e.ExcelSurvey=5]="ExcelSurvey",e[e.Text=6]="Text",e[e.ExcelForm=7]="ExcelForm",e[e.Visio=8]="Visio",e[e.Bohemia=9]="Bohemia",e[e.Prague=10]="Prague"}(r||(r={}))},906:function(e,t,n){"use strict";n.r(t),n.d(t,"httpStatusErrorFacet",(function(){return a})),n.d(t,"conflictErrorFacet",(function(){return o})),n.d(t,"offlineErrorFacet",(function(){return c})),n.d(t,"accessDeniedErrorFacet",(function(){return i})),n.d(t,"retryErrorFacet",(function(){return s})),n.d(t,"fileNotFoundErrorFacet",(function(){return l})),n.d(t,"invalidNameErrorFacet",(function(){return u})),n.d(t,"fileSizeErrorFacet",(function(){return d})),n.d(t,"emptyFolderUnsupportedFacet",(function(){return m})),n.d(t,"overQuotaErrorFacet",(function(){return p})),n.d(t,"lockMismatchErrorFacet",(function(){return f})),n.d(t,"fileLockedErrorFacet",(function(){return b})),n.d(t,"authFailureErrorFacet",(function(){return v})),n.d(t,"folderUploadUnsupportedFacet",(function(){return h})),n.d(t,"targetFolderErrorFacet",(function(){return O})),n.d(t,"malwareErrorFacet",(function(){return g})),n.d(t,"throttleErrorFacet",(function(){return _})),n.d(t,"versionMismatchFacet",(function(){return j})),n.d(t,"itemNotFoundErrorFacet",(function(){return y}));var r=n(3),a=new r.Facet("httpStatus"),o=new r.Facet("conflict"),c=new r.Facet("offlineError"),i=new r.Facet("accessDeniedError"),s=new r.Facet("retryError"),l=new r.Facet("fileNotFound"),u=new r.Facet("invalidNameError"),d=new r.Facet("fileSizeError"),m=new r.Facet("emptyFolderUnsupported"),p=new r.Facet("overQuotaError"),f=new r.Facet("lockMismatchError"),b=new r.Facet("fileLockedError"),v=new r.Facet("authFailureError"),h=new r.Facet("folderUploadUnsupported"),O=new r.Facet("targetFolderError"),g=new r.Facet("malwareError"),_=new r.Facet("throttleError"),j=new r.Facet("versionMismatch"),y=l},908:function(e,t,n){"use strict";n.r(t),n.d(t,"entryBatchFacet",(function(){return a})),n.d(t,"sourceFileFacet",(function(){return o}));var r=n(3),a=new r.Facet("entryBatch"),o=new r.Facet("sourceFile")},918:function(e,t,n){"use strict";n.r(t),n.d(t,"renameItemOperation",(function(){return c})),n.d(t,"renameProgressKeyFacet",(function(){return s})),n.d(t,"renameItem",(function(){return l}));var r=n(3),a=n(332),o=n(76),c=new r.Facet("renameItem"),i=new o.KeyFacet("renameItemProgressItem",{itemKey:Object(o.stringPart)(),oldName:Object(o.stringPart)()}),s=new a.ProgressKeyFacet("renameItems",(function(e,t){var n=Object.keys(t.names)[0];return i.serialize({itemKey:e,oldName:n})})),l=Object(a.implementOperationWithProgress)({operationTypeFacet:c,progressKeyFacet:s})},919:function(e,t,n){"use strict";n.r(t),n.d(t,"createFolderOperation",(function(){return o})),n.d(t,"createFolder",(function(){return c}));var r=n(3),a=n(60),o=new r.Facet("createFolder"),c=Object(a.implementOperation)({operationTypeFacet:o})},921:function(e,t,n){"use strict";n.r(t),n.d(t,"retryProgressItemsOperation",(function(){return o})),n.d(t,"retryProgressItems",(function(){return c}));var r=n(3),a=n(60),o=new r.Facet("retryProgressItemsOperation"),c=Object(a.implementOperation)({operationTypeFacet:o})},928:function(e,t,n){e.exports=n(943)},931:function(e,t,n){"use strict";n.r(t),n.d(t,"deleteActionControl",(function(){return o})),n.d(t,"deleteActionControler",(function(){return c}));var r=n(14),a=n(31),o=new r.ControlFacet("deleteActionControl",{deleteWizard:Object(a.e)()}),c=o},939:function(e,t,n){"use strict";n.d(t,"e",(function(){return a})),n.d(t,"t",(function(){return o}));var r=n(1),a=r.createContext(void 0),o=r.createContext(0)},942:function(e,t,n){"use strict";n.r(t),n.d(t,"downloadItemsActionControlFacet",(function(){return o}));var r=n(14),a=n(31),o=new r.ControlFacet("downloadItemsActionControl",{downloader:Object(a.e)()})},943:function(e,t,n){"use strict";n.r(t),n.d(t,"mergeQosEndSchema",(function(){return a}));var r=n(0);function a(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return t.reduce((function(e,t){return Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},e),t),e.extraMetrics||t.extraMetrics?{extraMetrics:Object(r.__assign)(Object(r.__assign)({},e.extraMetrics||{}),t.extraMetrics||{})}:{}),e.extraData||t.extraData?{extraData:Object(r.__assign)(Object(r.__assign)({},e.extraData||{}),t.extraData||{})}:{})}),e)}},951:function(e,t,n){"use strict";var r=new Proxy({},{get:(e,t)=>localizationLoader.getLocalizedString("lCkOaabZgA7Kib8AwGWvbg",t)});t.e=r},952:function(e,t,n){"use strict";n.r(t),n.d(t,"createFolderActionControl",(function(){return a}));var r=n(14),a=new r.ControlFacet("createFolderActionControl")},953:function(e,t,n){"use strict";n.d(t,"e",(function(){return a}));var r=n(14),a=new r.ControlFacet("createDocumentAction")},954:function(e,t,n){"use strict";n.r(t),n.d(t,"renameActionControl",(function(){return o}));var r=n(14),a=n(31),o=new r.ControlFacet("renameActionControl",{renameWizard:Object(a.e)()})},955:function(e,t,n){"use strict";var r=new Proxy({},{get:(e,t)=>localizationLoader.getLocalizedString("OK1cqyFLEiEczO/bjozpJA",t)});t.e=r},964:function(e,t,n){"use strict";n.d(t,"e",(function(){return c}));var r=n(0),a=n(833),o=n(16);Object(o.e)([{rawString:".newDocumentCommandIcon_810ca8e5{height:16px;width:16px}.newDocumentCommandIcon_810ca8e5 img{line-height:normal;display:block}#obf-TPromptContainer:focus{outline:1px solid #605e5c}#obf-TFormRating{color:#333333}#obf-TFormComment{background-color:#fff}\n"}]);function c(e){return Object(r.__assign)(Object(r.__assign)({},Object(a.e)(e)),{className:"newDocumentCommandIcon_810ca8e5"})}},966:function(e,t,n){"use strict";n.r(t),n.d(t,"ItemLink",(function(){return m}));var r=n(1),a=n(892),o=n(21),c=n(880),i=n(334),s=n(10),l=n(298),u=n(301),d=n(302);var m=function(e){var t=e.itemKey,n=e.action;return r.createElement(a.WithItemCache,null,(function(a){var m,p=a.itemCache;if(e.children)m=e.children;else{var f=p.demandItemFacet(s.displayNameFacet,t);m=f}var b=Object(l.getCurrentItemKey)(p),v=(n||!function(e,t){var n=Object(u.e)(e,{itemKey:t.itemKey1}),r=Object(u.e)(e,{itemKey:t.itemKey2});return Object(d.getPreferredItemKey)(e,{itemKey:n})===Object(d.getPreferredItemKey)(e,{itemKey:r})}(p,{itemKey1:t,itemKey2:b}))&&t?r.createElement(i.ItemDefaultClickAction,{itemKey:t}):null;return r.createElement(o.WithAction,{action:v},(function(e){var t=e.isAvailable,n=e.execute,a=t?function(){n().catch((function(){}))}:void 0;return a?r.createElement(c.e,{onClick:a},m):r.createElement("span",null,m)}))}))}},967:function(e,t,n){"use strict";n.d(t,"t",(function(){return k})),n.d(t,"e",(function(){return S}));var r=n(0),a=n(1),o=n(431),c=n(62),i=n(690),s=n(531),l=n(26),u=n(72),d=n(8),m=a.createContext(void 0),p=function(e){var t=e.store,n=e.configuration,o=e.initializer,c=e.children;if("store"in e&&!e.store)throw new Error("The 'store' prop was passed to ItemCacheProvider, but did not have a value.");if(t&&n)throw new Error("Cannot initialize an ItemCacheProvider with both 'store' and 'configuration' props.");var b=a.useContext(m);if(b&&n)throw new Error("Cannot initialize an ItemCacheProvider with 'configuration' when a store is already available via context.");var v,h=a.useRef(),O=a.useRef(),g=t||b||(v=h.current||(h.current=Object(i.createItemCacheStore)({configuration:n}))),_=a.useRef(),j=_.current;if(_.current=!0,g===b||j||o&&g.dispatch(o()),a.useEffect((function(){return g!==b||j||o&&g.dispatch(o()),function(){v&&v.dispose()}}),[]),g!==b){var y=O.current||(O.current=function(e){var t=e.dispatch(Object(u.readConfiguration)({backgroundTaskQueueFromConfiguration:l.backgroundTaskQueueFacet})).backgroundTaskQueueFromConfiguration;return t?{enqueue:function(n){t.enqueue(Object(r.__assign)(Object(r.__assign)({},n),{content:a.createElement(p,{store:e},n.content)}))}}:void 0}(g));return a.createElement(m.Provider,{value:g},a.createElement(d.ConnectToItemCacheProvider,{store:g},a.createElement(s.e,{scope:"headless",queue:y,onQueueTask:y?void 0:f},a.createElement(s.e,{scope:"global"},c))))}return a.createElement(a.Fragment,null,c)};function f(e){return Object(r.__assign)(Object(r.__assign)({},e),{content:a.createElement(s.e,{scope:"global"},e.content)})}var b=n(94),v=n(134),h=n(30),O=n(144),g=n(444),_=n(443),j=n(676),y=n(345),I=n(178),F=n(242),w=n(50),C=n(928),E=n(232),K=function(e){function t(t){var n=e.call(this,t)||this;return n._sessionAttemptCount=0,n._endQoS=n.props.itemCacheDispatch(Object(y.logQoS)({name:"ItemsScope.Session"})),n.state={hasError:!1},n}return Object(r.__extends)(t,e),t.getDerivedStateFromProps=function(e,t){return e.itemsScopeError?{hasError:!1}:t},t.getDerivedStateFromError=function(e){return{hasError:!0}},t.prototype.render=function(){return this.state.hasError?null:a.createElement(a.Fragment,null,this.props.children)},t.prototype.componentDidCatch=function(e,t){var n,a=this.props,o=a.itemCacheDispatch,i=a.itemsScopeError,s=a.onError;if(o(this._endQoS(Object(C.mergeQosEndSchema)({resultType:h.ResultType.failure,resultCode:"RenderError"},Object(E.getQosEndSchemaFromError)(e),{extraData:{stack:e.stack,componentStack:t.componentStack,sessionCount:++this._sessionAttemptCount}}))),i)throw i;o(Object(F.handleError)({error:e})),o(Object(c.resolveItems)({items:(n={},n[this.props.itemsScopeItemKey]=Object(r.__assign)({},I.errorFacet.pack(e)),n)})),this._endQoS=o(Object(y.logQoS)({name:"ItemsScope.Session"})),s&&s(e)},t.prototype.componentWillUnmount=function(){try{this.props.itemCacheDispatch(this._endQoS({resultType:h.ResultType.success}))}catch(e){}},t}(a.PureComponent),P=Object(d.connectToItemCache)((function(e,t){var n=t.itemsScopeItemKey,r=e.demandItemFacet(w.currentItemFacet,n),a=r&&r.itemKey,o=e.demandItemFacet(g.e,a),c=g.e.evaluate(o)(e,{currentItemKey:a,itemsScopeItemKey:n}).onError;return{itemsScopeError:e.demandItemFacet(I.errorFacet,n),onError:c}}))(K);function k(e,t){return function(n){return function(r){r(e),r(Object(o.openItem)({itemsScopeItemKey:n.itemsScopeItemKey,currentItemKey:t}))}}}function S(e){var t=e.initializer,n=(e.itemsScopeItemKey,e.children),o=Object(r.__rest)(e,["initializer","itemsScopeItemKey","children"]),c=a.useState((function(){var t=e.itemsScopeItemKey;return void 0===t?Object(j.getNextItemsScopeItemKey)():t}))[0],i=a.useState((function(){return function(){return function(e){t&&e(t({itemsScopeItemKey:c}))}}}))[0],s=a.useCallback((function(e,t){return t.itemsScopeItemKey?{}:{itemsScopeItemKey:c}}),[c]),l=a.useMemo((function(){return _.e.pack(s)}),[s]);return a.createElement(p,Object(r.__assign)({},o,{initializer:i}),Object(O.t)(a.createElement(P,{itemsScopeItemKey:c},Object(v.renderChildrenWithProps)(n,{itemsScopeItemKey:c})),l))}Object(d.createItemCacheComponent)((function(e,t){var n=Object(b.e)(e).itemsScopeItemKey;return Object(v.renderChildrenWithProps)(t.children,{itemsScopeItemKey:n})})).displayName="WithItemsScope"},988:function(e,t,n){"use strict";var r=new Proxy({},{get:(e,t)=>localizationLoader.getLocalizedString("Tvup0ra/Ii8Za4Q22T6nzQ",t)});t.e=r},989:function(e,t,n){"use strict";n.d(t,"t",(function(){return a})),n.d(t,"e",(function(){return o}));var r=n(14),a=new r.ControlFacet("progressListGroupControl",{}),o=new r.ControlFacet("progressListControl",{groupControlHandler:Object(r.childControlOption)(a)})},990:function(e,t,n){"use strict";n.d(t,"t",(function(){return o})),n.d(t,"e",(function(){return c}));var r=n(3),a=n(60),o=new r.Facet("cancelProgressItemsOperation"),c=Object(a.implementOperation)({operationTypeFacet:o})},991:function(e,t,n){"use strict";n.d(t,"t",(function(){return S})),n.d(t,"e",(function(){return x}));var r=n(0),a=n(279),o=n(62),c=n(529),i=n(895),s=n(76),l=n(200),u=n(3),d=n(117),m=n(60),p=n(71),f=n(10),b=n(35),v=n(127),h=n(686),O=n(908),g=n(235),_=n(82),j=n(139),y=Object(_.asOnceOnly)((function(e){var t,n=[];return function(r){var a=new j.Signal,o=a.resolve,c=a.promise;return n.push({resolve:o,itemResolver:r}),t||(t=setTimeout((function(){!function(){var r=n;n=[],t=void 0;var a=[];e(Object(g.asBatch)((function(){for(var t=0,n=r;t<n.length;t++){var o=n[t],c=o.resolve,i=o.itemResolver;a.push(c),e(i.execute())}})));for(var o=0,c=a;o<c.length;o++){(0,c[o])()}}()}),500)),c}})),I=new l.AutoKeyFacet("batch");var F=new s.KeyFacet("batchChildren",{batch:Object(s.subKeyPart)(I)}),w=new s.KeyFacet("fileEntry",{batch:Object(s.subKeyPart)(I),index:Object(s.numberPart)(),path:Object(s.stringPart)()}),C=new s.KeyFacet("fileEntryChildren",{fileEntry:Object(s.subKeyPart)(w)}),E=new s.KeyFacet("fileEntryDirectoryPage",{fileEntryChildren:Object(s.subKeyPart)(C),startIndex:Object(s.numberPart)()}),K=new u.Facet("entry"),P=new u.Facet("rootEntries"),k=new u.Facet("directoryPage"),S=Object(d.createAddon)((function(){return function(e){e(Object(g.asBatch)((function(){e(Object(o.supportFacets)({keyFacet:I,facets:[p.defaultChildItemSetFacet]})),e(Object(o.supportFacets)({keyFacet:F,facets:[p.childItemsFacet]})),e(Object(o.supportFacets)({keyFacet:w,facets:[f.displayNameFacet,p.defaultChildItemSetFacet,O.sourceFileFacet,f.fileSizeFacet,f.fileNameFacet,f.folderFacet,f.parentFolderItemFacet,f.dateModifiedFacet]})),e(Object(o.supportFacets)({keyFacet:C,facets:[p.childItemsFacet]})),e(Object(o.supportFacets)({keyFacet:E,facets:[p.childItemsFacet]})),e(Object(m.registerOperationHandler)(I,a.getItemsOperation)(Object(d.createSingleItemOperationHandler)({maxParallelOperationCount:8})(T))),e(Object(m.registerOperationHandler)(F,a.getItemsOperation)(Object(d.createSingleItemOperationHandler)({maxParallelOperationCount:8})(A))),e(Object(m.registerOperationHandler)(w,a.getItemsOperation)(Object(d.createSingleItemOperationHandler)({maxParallelOperationCount:128})(z))),e(Object(m.registerOperationHandler)(C,a.getItemsOperation)(Object(d.createSingleItemOperationHandler)({maxParallelOperationCount:32})(D))),e(Object(m.registerOperationHandler)(E,a.getItemsOperation)(Object(d.createSingleItemOperationHandler)({maxParallelOperationCount:32})(N))),e(Object(m.registerOperationHandler)(I,i.deleteItemsOperation)(Object(d.createSingleItemOperationHandler)({maxParallelOperationCount:8})(W)))})))}}));function x(e){return function(t){var n;t(S);var a=I.serializeNext(),o=new v.ItemResolver;return o.resolveItems({items:(n={},n[a]=Object(r.__assign)(Object(r.__assign)({},O.entryBatchFacet.pack({})),P.pack(e.entries)),n)}),t(o.execute()),{itemKey:a}}}function T(e){var t=this,n=e.itemKey,a=I.deserialize(n);return function(e){return Object(r.__awaiter)(t,void 0,void 0,(function(){var t,o;return Object(r.__generator)(this,(function(c){switch(c.label){case 0:return e(Object(b.readItems)((function(e){return e.demandItemFacet(P,n)})))?((t=new v.ItemResolver).resolveItems({items:(o={},o[n]=Object(r.__assign)(Object(r.__assign)({},O.entryBatchFacet.pack({})),p.defaultChildItemSetFacet.pack({itemKey:F.serialize({batch:a})})),o)}),[4,e(y)(t)]):[3,2];case 1:c.sent(),c.label=2;case 2:return[2]}}))}))}}function A(e){var t=this,n=e.itemKey,a=F.deserialize(n).batch,o=I.serialize(a);return function(e){return Object(r.__awaiter)(t,void 0,void 0,(function(){var t,c,i,s,l,u,d,m,f,h;return Object(r.__generator)(this,(function(O){switch(O.label){case 0:if(!(t=e(Object(b.readItems)((function(e){return e.demandItemFacet(P,o)})))))return[3,2];for(c=new v.ItemResolver,i=[],s=0,l=0,u=t;l<u.length;l++)d=u[l],m=w.serialize({batch:a,index:s,path:d.name}),c.resolveItems({items:(f={},f[m]=Object(r.__assign)({},K.pack(d)),f)}),i.push(m),s++;return c.resolveItems({items:(h={},h[n]=Object(r.__assign)({},p.childItemsFacet.pack({itemKeys:i})),h)}),[4,e(y)(c)];case 1:O.sent(),O.label=2;case 2:return[2]}}))}))}}function z(e){var t=this,n=e.itemKey;return function(e){return Object(r.__awaiter)(t,void 0,void 0,(function(){var t,a,o,c,i;return Object(r.__generator)(this,(function(s){switch(s.label){case 0:return(t=e(Object(b.readItems)((function(e){return e.demandItemFacet(K,n)}))))?((a=new v.ItemResolver).resolveItems({items:(c={},c[n]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},f.displayNameFacet.pack(t.name)),2===t.type?Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},f.folderFacet.pack({})),f.fileNameFacet.pack({name:t.name,extension:""})),p.defaultChildItemSetFacet.pack({itemKey:C.serialize({fileEntry:w.deserialize(n)})})):Object(r.__assign)(Object(r.__assign)({},p.defaultChildItemSetFacet.pack(void 0)),f.folderFacet.pack(void 0))),1===t.type?Object(r.__assign)({},f.fileNameFacet.pack(L(t.name))):{}),c)}),1!==t.type&&0!==t.type?[3,2]:[4,t.getFile()]):[2];case 1:o=s.sent(),a.resolveItems({items:(i={},i[n]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},f.fileNameFacet.pack(L(o.name))),f.folderFacet.pack(void 0)),f.fileSizeFacet.pack(o.size)),f.dateModifiedFacet.pack(o.lastModified)),O.sourceFileFacet.pack(o)),i)}),s.label=2;case 2:return[4,e(y)(a)];case 3:return s.sent(),[2]}}))}))}}function D(e){var t=this,n=e.itemKey,a=C.deserialize(n),o=a.fileEntry,c=w.serialize(o);return function(e){return Object(r.__awaiter)(t,void 0,void 0,(function(){function t(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,t,n,a,i,m,p;return Object(r.__generator)(this,(function(b){switch(b.label){case 0:for(e=s.entries,t=s.getEntries,n=0,a=e;n<a.length;n++)i=a[n],m=w.serialize(Object(r.__assign)(Object(r.__assign)({},o),{index:u,path:o.path+"/"+i.name})),d.resolveItems({items:(p={},p[m]=Object(r.__assign)(Object(r.__assign)({},K.pack(i)),f.parentFolderItemFacet.pack({itemKey:c})),p)}),l.push(m),u++;return t?[4,t()]:[3,2];case 1:s=b.sent(),b.label=2;case 2:return[2,!!t]}}))}))}var i,s,l,u,d,m,O,g,_;return Object(r.__generator)(this,(function(f){switch(f.label){case 0:return(i=e(Object(b.readItems)((function(e){return e.demandItemFacet(K,w.serialize(o))}))))&&2===i.type?[4,i.getEntries()]:[2];case 1:return s=f.sent(),l=[],u=0,d=new v.ItemResolver,[4,t()];case 2:return(m=f.sent())?[4,t()]:[3,4];case 3:m=f.sent(),f.label=4;case 4:return m&&(O=E.serialize({fileEntryChildren:a,startIndex:u}),d.merge(Object(h.resolveNewPage)({itemKey:O}).itemResolver),d.resolveItems({items:(g={},g[O]=Object(r.__assign)({},k.pack(s)),g)}),l.push(O)),d.resolveItems({items:(_={},_[n]=Object(r.__assign)(Object(r.__assign)({},p.childItemsFacet.pack({itemKeys:l})),p.parentItemFacet.pack({itemKey:c})),_)}),[4,e(y)(d)];case 5:return f.sent(),[2]}}))}))}}function N(e){var t=this,n=e.itemKey,a=E.deserialize(n),o=a.fileEntryChildren,c=a.startIndex,i=o.fileEntry,s=w.serialize(i);return function(e){return Object(r.__awaiter)(t,void 0,void 0,(function(){function t(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,t,n,a,o,c,p;return Object(r.__generator)(this,(function(b){switch(b.label){case 0:for(e=l.entries,t=l.getEntries,n=0,a=e;n<a.length;n++)o=a[n],c=w.serialize(Object(r.__assign)(Object(r.__assign)({},i),{index:u,path:i.path+"/"+o.name})),m.resolveItems({items:(p={},p[c]=Object(r.__assign)(Object(r.__assign)({},K.pack(o)),f.parentFolderItemFacet.pack({itemKey:s})),p)}),d.push(c),u++;return t?[4,t()]:[3,2];case 1:l=b.sent(),b.label=2;case 2:return[2,!!t]}}))}))}var a,l,u,d,m,p,O,g;return Object(r.__generator)(this,(function(i){switch(i.label){case 0:return(a=e(Object(b.readItems)((function(e){return e.demandItemFacet(k,n)}))))&&a.getEntries?[4,a.getEntries()]:[2];case 1:return l=i.sent(),u=c,d=[],m=new v.ItemResolver,[4,t()];case 2:return(p=i.sent())?[4,t()]:[3,4];case 3:p=i.sent(),i.label=4;case 4:return p&&(O=E.serialize({fileEntryChildren:o,startIndex:u}),m.merge(Object(h.resolveNewPage)({itemKey:O}).itemResolver),m.resolveItems({items:(g={},g[O]=Object(r.__assign)({},k.pack(l)),g)}),d.push(O)),m.merge(Object(h.resolveExistingPage)({itemKey:n,itemSetKey:C.serialize(o),childItemKeys:d}).itemResolver),[4,e(y)(m)];case 5:return i.sent(),[2]}}))}))}}function W(e){var t=this,n=e.itemKey;return function(e){return Object(r.__awaiter)(t,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){return e(Object(c.e)({items:e(Object(b.readItems)((function(e){for(var t,r={},a=[n];t=a.pop();){r[t]=!0;var o=e.demandItemFacet(p.defaultChildItemSetFacet,t),c=o&&o.itemKey;c&&(r[c]=!0);var i=e.demandItemFacet(p.childItemsFacet,c),s=i&&i.itemKeys;s&&a.push.apply(a,s)}return r})))})),[2]}))}))}}function L(e){var t=e.lastIndexOf(".");return t>-1?{name:e.slice(0,t),extension:e.slice(t)}:{name:e,extension:""}}},996:function(e,t,n){"use strict";n.r(t),n.d(t,"newCommand",(function(){return S}));var r=n(1e3),a=n(116),o=n(78),c=n(1),i=n(951),s=n(3),l=n(897),u=n(0),d=n(10),m=n(953),p=n(25),f=n(8),b=n(49),v=n(77),h=n(21),O=n(181),g=Object(O.asAsync)((function(){return Object(u.__awaiter)(void 0,void 0,void 0,(function(){return Object(u.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(0),n.e(25)]).then(n.bind(null,1055))];case 1:return[2,e.sent().DocumentCreator]}}))}))})),_=Object(f.createItemCacheComponent)((function(e,t){var n=t.itemKey,r=t.documentType,a=n&&e.demandItemFacet(d.folderFacet,n),o=e.demandItemFacet(m.e,n),i=m.e.evaluate(o)(e,{itemKey:n,documentType:r,isAvailable:!1}).isAvailable,s=Object(h.renderComponentOnExecute)((function(e){return c.createElement(g,Object(u.__assign)({},e,t))}));return c.createElement(b.Action,Object(u.__assign)({isAvailable:i&&!!a,onExecute:s},Object(v.getItemActionEngagement)(e,{itemKey:n,engagement:{name:"CreateDocument",isIntentional:!0,extraData:{documentType:l.e[r]}}})))})),j=Object(p.withOnlyCurrentItem)()(_),y=(Object(p.withCurrentItem)()(_),n(964)),I=n(418),F={key:new s.Facet("createWord").id,automationId:"createWordCommand",name:i.e.CreateWord,ariaLabel:i.e.CreateWord,action:c.createElement(I.HideWithSelection,null,c.createElement(j,{documentType:l.e.Word})),iconProps:Object(y.e)({extension:"docx",size:16})},w={key:new s.Facet("createExcel").id,automationId:"createExcelCommand",name:i.e.CreateExcel,ariaLabel:i.e.CreateExcel,action:c.createElement(I.HideWithSelection,null,c.createElement(j,{documentType:l.e.Excel})),iconProps:Object(y.e)({extension:"xlsx",size:16})},C={key:new s.Facet("createPowerPoint").id,automationId:"createPowerPointCommand",name:i.e.CreatePowerPoint,ariaLabel:i.e.CreatePowerPoint,action:c.createElement(I.HideWithSelection,null,c.createElement(j,{documentType:l.e.PowerPoint})),iconProps:Object(y.e)({extension:"pptx",size:16})},E={key:new s.Facet("createOneNote").id,automationId:"createOneNoteCommand",name:i.e.CreateOneNote,ariaLabel:i.e.CreateOneNote,action:c.createElement(I.HideWithSelection,null,c.createElement(j,{documentType:l.e.OneNote})),iconProps:Object(y.e)({extension:"onetoc",size:16})},K={key:new s.Facet("createExcelSurvey").id,automationId:"createExcelSurveyCommand",name:i.e.CreateExcelSurvey,ariaLabel:i.e.CreateExcelSurvey,action:c.createElement(I.HideWithSelection,null,c.createElement(j,{documentType:l.e.ExcelSurvey})),iconProps:Object(y.e)({extension:"xlsx",size:16})},P={key:new s.Facet("createFormForExcel").id,automationId:"createFormForExcelCommand",name:i.e.CreateFormForExcel,ariaLabel:i.e.CreateFormForExcel,action:c.createElement(I.HideWithSelection,null,c.createElement(j,{documentType:l.e.ExcelForm})),iconProps:Object(y.e)({extension:"xlsx",size:16})},k={key:new s.Facet("createVisio").id,automationId:"createVisioCommand",name:i.e.CreateVisio,ariaLabel:i.e.CreateVisio,action:c.createElement(I.HideWithSelection,null,c.createElement(j,{documentType:l.e.Visio})),iconProps:Object(y.e)({extension:"vsdx",size:16})},S={key:Object(s.getNextId)("newCommand"),automationId:"newCommand",name:o.default.Create,title:o.default.CreateCommandAriaLabel,engagement:{name:"newCommand",isIntentional:!0},iconProps:{iconName:"CalculatorAddition"},subMenuProps:{items:[r.e,{name:"-",key:"divider_1",itemType:a.e.Divider},F,w,C,E,K,P,k]}}},999:function(e,t,n){"use strict";n.d(t,"t",(function(){return j})),n.d(t,"e",(function(){return y}));var r=n(0),a=n(1),o=n(423),c=n(500),i=n(530),s=(new c.PlatformDetection).isIE,l={},u=function(e){function t(t){var n=e.call(this,t)||this;return n._onFrameRef=function(e){var t=e&&e.contentDocument;n.setState({targetDocument:t||void 0})},n._async=new o.e(n),n._window=null,n.state=l,n}return Object(r.__extends)(t,e),t.prototype.render=function(){var e=this.state.downloadData;return e?s||this.props.preferOpenInBrowser||this.props.preferSameWindow?null:a.createElement("div",{style:{display:"none"}},a.createElement("iframe",{hidden:!0,ref:this._onFrameRef,src:"GET"===e.method?e.url:"about:blank"})):null},t.prototype.UNSAFE_componentWillMount=function(){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){return this._getDownloadData(),[2]}))}))},t.prototype.componentDidMount=function(){if(this.props.preferSameWindow)this._window=window;else if(s||this.props.preferOpenInBrowser)try{this._window=window.open()}catch(e){}if(this._onUpdate(l),this._window){var e=this._window&&this._window.document;this.setState({targetDocument:e||void 0})}},t.prototype.componentDidUpdate=function(e,t){this._onUpdate(t)},t.prototype.componentWillUnmount=function(){this._window&&!this.props.preferSameWindow&&(this._window.close(),this._window=null)},t.prototype.componentDidCatch=function(e){this.props.reject(e)},t.prototype._onUpdate=function(e){var t=this.state,n=t.downloadData,r=t.targetDocument;!e.downloadData&&n&&this._async.setTimeout(this._onDownloadTimeout,2e4);try{!e.downloadData&&n&&"GET"===n.method&&this._window&&(this._window.location.href=n.url),e.targetDocument&&e.downloadData||!r||!n||"POST"!==n.method||Object(i.navigateViaPost)({document:r,postdata:n.postData,url:n.url})}catch(e){this.props.reject(e)}},t.prototype._getDownloadData=function(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.props.getDownloadData()];case 1:return e=n.sent(),this.setState({downloadData:e}),[3,3];case 2:return t=n.sent(),this.props.reject(t),[3,3];case 3:return[2]}}))}))},t.prototype._onDownloadTimeout=function(){this.props.resolve()},t}(a.PureComponent),d=n(942),m=n(25),p=n(77),f=n(967),b=n(94),v=n(8),h=n(21),O=n(49),g=Object(v.createItemCacheComponent)((function(e,t){var n=t.itemKeys,o=t.downloader,c=n[0];if(!c)return null;var i=Object(b.e)(e).itemsScopeItemKey,s=e.demandItemFacet(d.downloadItemsActionControlFacet,c),l=d.downloadItemsActionControlFacet.evaluate(s)(e,{itemKeys:n,downloader:o,isAvailable:!1}),u=l.downloader,m=l.getDownloadData,v=l.isAvailable;if(!u||!m||!v)return null;var g=e.dispatch,_=function(){return g(m())},j=Object(h.renderComponentOnExecute)((function(e){return a.createElement(f.e,{itemsScopeItemKey:i},a.createElement(u,Object(r.__assign)({itemKeys:n,getDownloadData:_},e)))}),{scope:"headless"});return a.createElement(O.Action,Object(r.__assign)({isAvailable:v,onExecute:j},Object(p.getItemActionEngagement)(e,{itemKey:c,engagement:{name:"Download",privacyClassification:"requiredService",isIntentional:!0}})))})),_=Object(m.withSelectedItems)()(Object(m.withCurrentItemAsFallback)()(g)),j=Object(v.connectToItemCache)((function(){return{downloader:u}}))(g),y=Object(v.connectToItemCache)((function(){return{downloader:u}}))(_)}}]);
//# sourceMappingURL=index.items-view-deferredcomponents.js.map