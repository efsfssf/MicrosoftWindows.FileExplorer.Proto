(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{1067:function(e,t,n){"use strict";n.d(t,"e",(function(){return l})),n.d(t,"t",(function(){return m}));var r,a=n(0),s=n(1),i=n(423),o=n(142),d=n(621),c=n(416);!function(e){e[e.horizontal=0]="horizontal",e[e.vertical=1]="vertical"}(r||(r={}));var p=n(885),u=function(e){var t;void 0===e&&(t={},e={getCachedMeasurement:function(e){if(e&&e.cacheKey&&t.hasOwnProperty(e.cacheKey))return t[e.cacheKey]},addMeasurementToCache:function(e,n){e.cacheKey&&(t[e.cacheKey]=n)}});var n,r=e;function s(e,t){var n=r.getCachedMeasurement(e);if(void 0!==n)return n;var a=t();return r.addMeasurementToCache(e,a),a}function i(e,t,a){for(var i=e,o=s(e,a);o>n;){var d=t(i);if(void 0===d)return{renderedData:i,resizeDirection:void 0,dataToMeasure:void 0};if(void 0===(o=r.getCachedMeasurement(d)))return{dataToMeasure:d,resizeDirection:"shrink"};i=d}return{renderedData:i,resizeDirection:void 0,dataToMeasure:void 0}}return{getNextState:function(e,t,o,d){if(void 0!==d||void 0!==t.dataToMeasure){if(d){if(n&&t.renderedData&&!t.dataToMeasure)return Object(a.__assign)(Object(a.__assign)({},t),function(e,t,r,s){var i;return i=e>n?s?{resizeDirection:"grow",dataToMeasure:s(r)}:{resizeDirection:"shrink",dataToMeasure:t}:{resizeDirection:"shrink",dataToMeasure:r},n=e,Object(a.__assign)(Object(a.__assign)({},i),{measureContainer:!1})}(d,e.data,t.renderedData,e.onGrowData));n=d}var c=Object(a.__assign)(Object(a.__assign)({},t),{measureContainer:!1});return t.dataToMeasure&&(c="grow"===t.resizeDirection&&e.onGrowData?Object(a.__assign)(Object(a.__assign)({},c),function(e,t,o,d){for(var c=e,p=s(e,o);p<n;){var u=t(c);if(void 0===u)return{renderedData:c,resizeDirection:void 0,dataToMeasure:void 0};if(void 0===(p=r.getCachedMeasurement(u)))return{dataToMeasure:u};c=u}return Object(a.__assign)({resizeDirection:"shrink"},i(c,d,o))}(t.dataToMeasure,e.onGrowData,o,e.onReduceData)):Object(a.__assign)(Object(a.__assign)({},c),i(t.dataToMeasure,e.onReduceData,o))),c}},shouldRenderDataForMeasurement:function(e){return!(!e||void 0!==r.getCachedMeasurement(e))},getInitialResizeGroupState:function(e){return{dataToMeasure:Object(a.__assign)({},e),resizeDirection:"grow",measureContainer:!0}}}},l=s.createContext({isMeasured:!1}),h={position:"fixed",visibility:"hidden"},_={position:"relative"},m=function(e){function t(t){var n=e.call(this,t)||this;return n._nextResizeGroupStateProvider=u(),n._root=s.createRef(),n._initialHiddenDiv=s.createRef(),n._updateHiddenDiv=s.createRef(),n._hasRenderedContent=!1,n.state=n._nextResizeGroupStateProvider.getInitialResizeGroupState(n.props.data),Object(p.e)(n),n._async=new i.e(n),n._events=new o.e(n),Object(d.e)("ResizeGroup",t,{styles:"className"}),n}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.className,n=e.onRenderData,r=this.state,i=r.dataToMeasure,o=r.renderedData,d=Object(c.a)(this.props,c.n,["data"]),p=this._nextResizeGroupStateProvider.shouldRenderDataForMeasurement(i),u=!this._hasRenderedContent&&p;return s.createElement("div",Object(a.__assign)({},d,{className:t,ref:this._root}),s.createElement("div",{style:_},p&&!u&&s.createElement("div",{style:h,ref:this._updateHiddenDiv},s.createElement(l.Provider,{value:{isMeasured:!0}},n(i))),s.createElement("div",{ref:this._initialHiddenDiv,style:u?h:void 0,"data-automation-id":"visibleContent"},u?n(i):o&&n(o))))},t.prototype.componentDidMount=function(){this._afterComponentRendered(this.props.direction),this._events.on(window,"resize",this._async.debounce(this._onResize,16,{leading:!0}))},t.prototype.UNSAFE_componentWillReceiveProps=function(e){this.setState({dataToMeasure:Object(a.__assign)({},e.data),resizeDirection:"grow",measureContainer:!0})},t.prototype.componentDidUpdate=function(e){this.state.renderedData&&(this._hasRenderedContent=!0,this.props.dataDidRender&&this.props.dataDidRender(this.state.renderedData)),this._afterComponentRendered(this.props.direction)},t.prototype.componentWillUnmount=function(){this._async.dispose(),this._events.dispose()},t.prototype.remeasure=function(){this._root.current&&this.setState({measureContainer:!0})},t.prototype._afterComponentRendered=function(e){var t=this;this._async.requestAnimationFrame((function(){var n=void 0;if(t.state.measureContainer&&t._root.current){var a=t._root.current.getBoundingClientRect();n=e&&e===r.vertical?a.height:a.width}var s=t._nextResizeGroupStateProvider.getNextState(t.props,t.state,(function(){var n=t._hasRenderedContent?t._updateHiddenDiv:t._initialHiddenDiv;return n.current?e&&e===r.vertical?n.current.scrollHeight:n.current.scrollWidth:0}),n);s&&t.setState(s)}),this._root.current)},t.prototype._onResize=function(){this._root.current&&this.setState({measureContainer:!0})},t}(s.Component)},1313:function(e,t,n){"use strict";n.d(t,"e",(function(){return r}));var r=n(1067).t},1487:function(e,t,n){"use strict";n.d(t,"e",(function(){return F}));var r=n(889),a=n(27),s={host:"ms-HoverCard-host"};var i,o,d=n(0),c=n(1),p=n(856),u=n(102),l=n(885),h=n(423),_=n(142),m=n(486),v=n(416),f=n(111);!function(e){e[e.hover=0]="hover",e[e.hotKey=1]="hotKey"}(i||(i={})),function(e){e.plain="PlainCard",e.expanding="ExpandingCard"}(o||(o={}));var g,C={root:"ms-ExpandingCard-root",compactCard:"ms-ExpandingCard-compactCard",expandedCard:"ms-ExpandingCard-expandedCard",expandedCardScroll:"ms-ExpandingCard-expandedCardScrollRegion"};!function(e){e[e.compact=0]="compact",e[e.expanded=1]="expanded"}(g||(g={}));var b=n(45),y=n(835),O=n(888),D=function(e){return c.createElement(y.e,Object(d.__assign)({},e),c.createElement(O.e,Object(d.__assign)({disabled:e.hidden},e.focusTrapProps),e.children))},x=function(e){var t=e.gapSpace,n=void 0===t?0:t,r=e.directionalHint,a=void 0===r?b.e.bottomLeftEdge:r,s=e.directionalHintFixed,i=e.targetElement,o=e.firstFocus,p=e.trapFocus,u=e.onLeave,l=e.className,h=e.finalHeight,_=e.content,m=e.calloutProps,f=Object(d.__assign)(Object(d.__assign)(Object(d.__assign)({},Object(v.a)(e,v.n)),{className:l,target:i,isBeakVisible:!1,directionalHint:a,directionalHintFixed:s,finalHeight:h,minPagePadding:24,onDismiss:u,gapSpace:n}),m);return c.createElement(c.Fragment,null,p?c.createElement(D,Object(d.__assign)({},f,{focusTrapProps:{forceFocusInsideTrap:!1,isClickableOutsideFocusTrap:!0,disableFirstFocus:!o}}),_):c.createElement(y.e,Object(d.__assign)({},f),_))},E=Object(p.e)(),j=function(e){function t(t){var n=e.call(this,t)||this;return n._expandedElem=c.createRef(),n._onKeyDown=function(e){e.which===u.e.escape&&n.props.onLeave&&n.props.onLeave(e)},n._onRenderCompactCard=function(){return c.createElement("div",{className:n._classNames.compactCard},n.props.onRenderCompactCard(n.props.renderData))},n._onRenderExpandedCard=function(){return!n.state.firstFrameRendered&&n._async.requestAnimationFrame((function(){n.setState({firstFrameRendered:!0})})),c.createElement("div",{className:n._classNames.expandedCard,ref:n._expandedElem},c.createElement("div",{className:n._classNames.expandedCardScroll},n.props.onRenderExpandedCard&&n.props.onRenderExpandedCard(n.props.renderData)))},n._checkNeedsScroll=function(){var e=n.props.expandedCardHeight;n._async.requestAnimationFrame((function(){n._expandedElem.current&&n._expandedElem.current.scrollHeight>=e&&n.setState({needsScroll:!0})}))},n._async=new h.e(n),Object(l.e)(n),n.state={firstFrameRendered:!1,needsScroll:!1},n}return Object(d.__extends)(t,e),t.prototype.componentDidMount=function(){this._checkNeedsScroll()},t.prototype.componentWillUnmount=function(){this._async.dispose()},t.prototype.render=function(){var e=this.props,t=e.styles,n=e.compactCardHeight,r=e.expandedCardHeight,a=e.theme,s=e.mode,i=e.className,o=this.state,p=o.needsScroll,u=o.firstFrameRendered,l=n+r;this._classNames=E(t,{theme:a,compactCardHeight:n,className:i,expandedCardHeight:r,needsScroll:p,expandedCardFirstFrameRendered:s===g.expanded&&u});var h=c.createElement("div",{onMouseEnter:this.props.onEnter,onMouseLeave:this.props.onLeave,onKeyDown:this._onKeyDown},this._onRenderCompactCard(),this._onRenderExpandedCard());return c.createElement(x,Object(d.__assign)({},this.props,{content:h,finalHeight:l,className:this._classNames.root}))},t.defaultProps={compactCardHeight:156,expandedCardHeight:384,directionalHintFixed:!0},t}(c.Component),T=Object(r.e)(j,(function(e){var t,n=e.theme,r=e.needsScroll,s=e.expandedCardFirstFrameRendered,i=e.compactCardHeight,o=e.expandedCardHeight,d=e.className,c=n.palette,p=Object(a.D)(C,n);return{root:[p.root,{width:320,pointerEvents:"none",selectors:(t={},t[a.i]={border:"1px solid WindowText"},t)},d],compactCard:[p.compactCard,{pointerEvents:"auto",position:"relative",height:i}],expandedCard:[p.expandedCard,{height:1,overflowY:"hidden",pointerEvents:"auto",transition:"height 0.467s cubic-bezier(0.5, 0, 0, 1)",selectors:{":before":{content:'""',position:"relative",display:"block",top:0,left:24,width:272,height:1,backgroundColor:c.neutralLighter}}},s&&{height:o}],expandedCardScroll:[p.expandedCardScroll,r&&{height:"100%",boxSizing:"border-box",overflowY:"auto"}]}}),void 0,{scope:"ExpandingCard"}),w={root:"ms-PlainCard-root"};var H=Object(p.e)(),R=function(e){function t(t){var n=e.call(this,t)||this;return n._onKeyDown=function(e){e.which===u.e.escape&&n.props.onLeave&&n.props.onLeave(e)},Object(l.e)(n),n}return Object(d.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.styles,n=e.theme,r=e.className;this._classNames=H(t,{theme:n,className:r});var a=c.createElement("div",{onMouseEnter:this.props.onEnter,onMouseLeave:this.props.onLeave,onKeyDown:this._onKeyDown},this.props.onRenderPlainCard(this.props.renderData));return c.createElement(x,Object(d.__assign)({},this.props,{content:a,className:this._classNames.root}))},t}(c.Component),M=Object(r.e)(R,(function(e){var t,n=e.theme,r=e.className;return{root:[Object(a.D)(w,n).root,{pointerEvents:"auto",selectors:(t={},t[a.i]={border:"1px solid WindowText"},t)},r]}}),void 0,{scope:"PlainCard"}),S=Object(p.e)(),N=function(e){function t(t){var n=e.call(this,t)||this;return n._hoverCard=c.createRef(),n.dismiss=function(e){n._async.clearTimeout(n._openTimerId),n._async.clearTimeout(n._dismissTimerId),e?n._dismissTimerId=n._async.setTimeout((function(){n._setDismissedState()}),n.props.cardDismissDelay):n._setDismissedState()},n._cardOpen=function(e){n._shouldBlockHoverCard()||"keydown"===e.type&&e.which!==n.props.openHotKey||(n._async.clearTimeout(n._dismissTimerId),"mouseenter"===e.type&&(n._currentMouseTarget=e.currentTarget),n._executeCardOpen(e))},n._executeCardOpen=function(e){n._async.clearTimeout(n._openTimerId),n._openTimerId=n._async.setTimeout((function(){n.setState((function(t){return t.isHoverCardVisible?t:{isHoverCardVisible:!0,mode:g.compact,openMode:"keydown"===e.type?i.hotKey:i.hover}}))}),n.props.cardOpenDelay)},n._cardDismiss=function(e,t){if(e){if(!(t instanceof MouseEvent))return;if("keydown"===t.type&&t.which!==u.e.escape)return;n.props.sticky||n._currentMouseTarget!==t.currentTarget&&t.which!==u.e.escape||n.dismiss(!0)}else{if(n.props.sticky&&!(t instanceof MouseEvent)&&t.nativeEvent instanceof MouseEvent&&"mouseleave"===t.type)return;n.dismiss(!0)}},n._setDismissedState=function(){n.setState({isHoverCardVisible:!1,mode:g.compact,openMode:i.hover})},n._instantOpenAsExpanded=function(e){n._async.clearTimeout(n._dismissTimerId),n.setState((function(e){return e.isHoverCardVisible?e:{isHoverCardVisible:!0,mode:g.expanded}}))},n._setEventListeners=function(){var e=n.props,t=e.trapFocus,r=e.instantOpenOnClick,a=e.eventListenerTarget,s=a?n._getTargetElement(a):n._getTargetElement(n.props.target),i=n._nativeDismissEvent;s&&(n._events.on(s,"mouseenter",n._cardOpen),n._events.on(s,"mouseleave",i),t?n._events.on(s,"keydown",n._cardOpen):(n._events.on(s,"focus",n._cardOpen),n._events.on(s,"blur",i)),r?n._events.on(s,"click",n._instantOpenAsExpanded):(n._events.on(s,"mousedown",i),n._events.on(s,"keydown",i)))},Object(l.e)(n),n._async=new h.e(n),n._events=new _.e(n),n._nativeDismissEvent=n._cardDismiss.bind(n,!0),n._childDismissEvent=n._cardDismiss.bind(n,!1),n.state={isHoverCardVisible:!1,mode:g.compact,openMode:i.hover},n}return Object(d.__extends)(t,e),t.prototype.componentDidMount=function(){this._setEventListeners()},t.prototype.componentWillUnmount=function(){this._async.dispose(),this._events.dispose()},t.prototype.componentDidUpdate=function(e,t){var n=this;e.target!==this.props.target&&(this._events.off(),this._setEventListeners()),t.isHoverCardVisible!==this.state.isHoverCardVisible&&(this.state.isHoverCardVisible?(this._async.setTimeout((function(){n.setState({mode:g.expanded},(function(){n.props.onCardExpand&&n.props.onCardExpand()}))}),this.props.expandedCardOpenDelay),this.props.onCardVisible&&this.props.onCardVisible()):(this.setState({mode:g.compact}),this.props.onCardHide&&this.props.onCardHide()))},t.prototype.render=function(){var e=this.props,t=e.expandingCardProps,n=e.children,r=e.id,a=e.setAriaDescribedBy,s=void 0===a||a,p=e.styles,u=e.theme,l=e.className,h=e.type,_=e.plainCardProps,f=e.trapFocus,g=e.setInitialFocus,C=this.state,b=C.isHoverCardVisible,y=C.mode,O=C.openMode,D=r||Object(m.e)("hoverCard");this._classNames=S(p,{theme:u,className:l});var x=Object(d.__assign)(Object(d.__assign)({},Object(v.a)(this.props,v.n)),{id:D,trapFocus:!!f,firstFocus:g||O===i.hotKey,targetElement:this._getTargetElement(this.props.target),onEnter:this._cardOpen,onLeave:this._childDismissEvent}),E=Object(d.__assign)(Object(d.__assign)(Object(d.__assign)({},t),x),{mode:y}),j=Object(d.__assign)(Object(d.__assign)({},_),x);return c.createElement("div",{className:this._classNames.host,ref:this._hoverCard,"aria-describedby":s&&b?D:void 0,"data-is-focusable":!this.props.target},n,b&&(h===o.expanding?c.createElement(T,Object(d.__assign)({},E)):c.createElement(M,Object(d.__assign)({},j))))},t.prototype._getTargetElement=function(e){switch(typeof e){case"string":return Object(f.e)().querySelector(e);case"object":return e;default:return this._hoverCard.current||void 0}},t.prototype._shouldBlockHoverCard=function(){return!(!this.props.shouldBlockHoverCard||!this.props.shouldBlockHoverCard())},t.defaultProps={cardOpenDelay:500,cardDismissDelay:100,expandedCardOpenDelay:1500,instantOpenOnClick:!1,setInitialFocus:!1,openHotKey:u.e.c,type:o.expanding},t}(c.Component),F=Object(r.e)(N,(function(e){var t=e.className,n=e.theme;return{host:[Object(a.D)(s,n).host,t]}}),void 0,{scope:"HoverCard"})}}]);
//# sourceMappingURL=index.fabric~shared-react-filehovercard.js.map