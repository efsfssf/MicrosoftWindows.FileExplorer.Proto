(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{1039:function(e,t,n){"use strict";n.d(t,"e",(function(){return l}));var r=n(0),o=n(1),i=n(885),a=n(621),s=n(416),l=function(e){function t(t){var n=e.call(this,t)||this;return Object(i.e)(n),Object(a.e)("PivotItem",t,{linkText:"headerText"}),n}return Object(r.__extends)(t,e),t.prototype.render=function(){return o.createElement("div",Object(r.__assign)({},Object(s.a)(this.props,s.n)),this.props.children)},t}(o.Component)},1122:function(e,t,n){e.exports=n(1407)},1123:function(e,t,n){e.exports=n(1061)},1407:function(e,t,n){"use strict";n.r(t),n.d(t,"withMemoizer",(function(){return a})),n.d(t,"useMemoizer",(function(){return s}));var r=n(1),o=n(257),i=n(260);function a(){return function(e){return Object(i.t)((function(){return{memoizer:new o.e}}))(e)}}function s(){var e=r.useRef();return e.current||(e.current=new o.e),e.current}},1408:function(e,t,n){e.exports=n(1023)},1409:function(e,t,n){e.exports=n(579)},1431:function(e,t,n){"use strict";n.d(t,"e",(function(){return S}));var r=n(889),o=n(0),i=n(1),a=n(856),s=n(885),l=n(486),c=n(416),u=n(245),d=n(102),m=n(525).e,f=n(884),p=n(123),b=n(1039),h=n(962),v=n(887),g=Object(a.e)(),y=function(e){function t(t){var n=e.call(this,t)||this;n._focusZone=i.createRef(),n._renderPivotLink=function(e,t,r){var a,s=t.itemKey,l=t.headerButtonProps,c=e.keyToTabIdMapping[s],u=t.onRenderItemLink,d=r===s;a=u?u(t,n._renderLinkContent):n._renderLinkContent(t);var f=t.headerText||"";return f+=t.itemCount?" ("+t.itemCount+")":"",f+=t.itemIcon?" xx":"",i.createElement(m,Object(o.__assign)({},l,{id:c,key:s,className:d?n._classNames.linkIsSelected:n._classNames.link,onClick:n._onLinkClick.bind(n,s),onKeyDown:n._onKeyDown.bind(n,s),"aria-label":t.ariaLabel,role:"tab","aria-selected":d,name:t.headerText,keytipProps:t.keytipProps,"data-content":f}),a)},n._renderLinkContent=function(e){var t=e.itemCount,r=e.itemIcon,o=e.headerText,a=n._classNames;return i.createElement("span",{className:a.linkContent},void 0!==r&&i.createElement("span",{className:a.icon},i.createElement(v.e,{iconName:r})),void 0!==o&&i.createElement("span",{className:a.text}," ",e.headerText),void 0!==t&&i.createElement("span",{className:a.count}," (",t,")"))},Object(s.e)(n),n._pivotId=Object(l.e)("Pivot");var r,a=n._getPivotLinks(t).links,c=t.defaultSelectedKey,u=void 0===c?t.initialSelectedKey:c,d=t.defaultSelectedIndex,f=void 0===d?t.initialSelectedIndex:d;return u?r=u:"number"==typeof f?r=a[f].itemKey:a.length&&(r=a[0].itemKey),n.state={selectedKey:r},n}return Object(o.__extends)(t,e),t.prototype.focus=function(){this._focusZone.current&&this._focusZone.current.focus()},t.prototype.render=function(){var e=this,t=this._getPivotLinks(this.props),n=this._getSelectedKey(t),r=Object(c.a)(this.props,c.n);return this._classNames=this._getClassNames(this.props),i.createElement("div",Object(o.__assign)({role:"toolbar"},r),this._renderPivotLinks(t,n),n&&t.links.map((function(r){return(!0===r.alwaysRender||n===r.itemKey)&&e._renderPivotItem(t,r.itemKey,n===r.itemKey)})))},t.prototype._getSelectedKey=function(e){var t=this.props.selectedKey;if(this._isKeyValid(e,t)||null===t)return t;var n=this.state.selectedKey;return this._isKeyValid(e,n)?n:e.links.length?e.links[0].itemKey:void 0},t.prototype._renderPivotLinks=function(e,t){var n=this,r=e.links.map((function(r){return n._renderPivotLink(e,r,t)}));return i.createElement(f.e,{className:this._classNames.root,role:"tablist",componentRef:this._focusZone,direction:p.e.horizontal},r)},t.prototype._renderPivotItem=function(e,t,n){if(this.props.headersOnly||!t)return null;var r=e.keyToIndexMapping[t],o=e.keyToTabIdMapping[t];return i.createElement("div",{role:"tabpanel",hidden:!n,key:t,"aria-hidden":!n,"aria-labelledby":o,className:this._classNames.itemContainer},i.Children.toArray(this.props.children)[r])},t.prototype._getPivotLinks=function(e){var t=this,n={links:[],keyToIndexMapping:{},keyToTabIdMapping:{}};return i.Children.map(i.Children.toArray(e.children),(function(e,r){if(_(e)){var i=e,a=i.props,s=a.linkText,l=Object(o.__rest)(a,["linkText"]),c=i.props.itemKey||r.toString();n.links.push(Object(o.__assign)(Object(o.__assign)({headerText:s},l),{itemKey:c})),n.keyToIndexMapping[c]=r,n.keyToTabIdMapping[c]=t._getTabId(c,r)}else Object(u.e)("The children of a Pivot component must be of type PivotItem to be rendered.")})),n},t.prototype._getTabId=function(e,t){return this.props.getTabId?this.props.getTabId(e,t):this._pivotId+"-Tab"+t},t.prototype._isKeyValid=function(e,t){return null!=t&&void 0!==e.keyToIndexMapping[t]},t.prototype._onLinkClick=function(e,t){t.preventDefault(),this._updateSelectedItem(e,t)},t.prototype._onKeyDown=function(e,t){t.which===d.e.enter&&(t.preventDefault(),this._updateSelectedItem(e))},t.prototype._updateSelectedItem=function(e,t){this.setState({selectedKey:e});var n=this._getPivotLinks(this.props);if(this.props.onLinkClick&&n.keyToIndexMapping[e]>=0){var r=n.keyToIndexMapping[e],o=i.Children.toArray(this.props.children)[r];_(o)&&this.props.onLinkClick(o,t)}},t.prototype._getClassNames=function(e){var t=e.theme,n=e.linkSize===h.t.large,r=e.linkFormat===h.e.tabs;return g(e.styles,{theme:t,rootIsLarge:n,rootIsTabs:r})},t}(i.Component);function _(e){return!!e&&"object"==typeof e&&!!e.type&&e.type.name===b.e.name}var k=n(27),I=n(324),x={count:"ms-Pivot-count",icon:"ms-Pivot-icon",linkIsSelected:"is-selected",link:"ms-Pivot-link",linkContent:"ms-Pivot-linkContent",root:"ms-Pivot",rootIsLarge:"ms-Pivot--large",rootIsTabs:"ms-Pivot--tabs",text:"ms-Pivot-text"},C=function(e){var t,n,r=e.rootIsLarge,o=e.rootIsTabs,i=e.theme,a=i.semanticColors,s=i.fonts;return[s.medium,{color:a.actionLink,display:"inline-block",lineHeight:44,height:44,marginRight:8,padding:"0 8px",textAlign:"center",position:"relative",backgroundColor:"transparent",border:0,borderRadius:0,selectors:(t={":before":{backgroundColor:"transparent",bottom:0,content:'""',height:2,left:8,position:"absolute",right:8,transition:"left "+k.n.durationValue2+" "+k.n.easeFunction2+",\n                      right "+k.n.durationValue2+" "+k.n.easeFunction2},":after":{color:"transparent",content:"attr(data-content)",display:"block",fontWeight:k.a.bold,height:1,overflow:"hidden",visibility:"hidden"},":hover":{backgroundColor:a.buttonBackgroundHovered,color:a.buttonTextHovered,cursor:"pointer"},":active":{backgroundColor:a.buttonBackgroundPressed,color:a.buttonTextHovered},":focus":{outline:"none"}},t["."+I.e+" &:focus"]={outline:"1px solid "+a.focusBorder},t["."+I.e+" &:focus:after"]={content:"attr(data-content)",position:"relative",border:0},t)},r&&{fontSize:s.large.fontSize},o&&[{marginRight:0,height:44,lineHeight:44,backgroundColor:a.buttonBackground,padding:"0 10px",verticalAlign:"top",selectors:(n={":focus":{outlineOffset:"-1px"}},n["."+I.e+" &:focus::before"]={height:"auto",background:"transparent",transition:"none"},n)}]]},S=Object(r.e)(y,(function(e){var t,n,r,i=e.className,a=e.rootIsLarge,s=e.rootIsTabs,l=e.theme,c=l.semanticColors,u=l.fonts,d=Object(k.D)(x,l);return{root:[d.root,u.medium,k.T,{position:"relative",color:c.link,whiteSpace:"nowrap"},a&&d.rootIsLarge,s&&d.rootIsTabs,i],itemContainer:{selectors:{"&[hidden]":{display:"none"}}},link:Object(o.__spreadArrays)([d.link],C(e),[s&&{selectors:{"&:hover, &:focus":{color:c.buttonTextCheckedHovered},"&:active, &:hover":{color:c.primaryButtonText,backgroundColor:c.primaryButtonBackground}}}]),linkIsSelected:Object(o.__spreadArrays)([d.link,d.linkIsSelected],C(e),[{fontWeight:k.a.semibold,selectors:(t={":before":{backgroundColor:c.inputBackgroundChecked,selectors:(n={},n[k.i]={backgroundColor:"Highlight"},n)},":hover::before":{left:0,right:0}},t[k.i]={color:"Highlight"},t)},s&&{backgroundColor:c.primaryButtonBackground,color:c.primaryButtonText,fontWeight:k.a.regular,selectors:(r={":before":{backgroundColor:"transparent",transition:"none",position:"absolute",top:0,left:0,right:0,bottom:0,content:'""',height:"auto"},":hover":{backgroundColor:c.primaryButtonBackgroundHovered,color:c.primaryButtonText},"&:active":{backgroundColor:c.primaryButtonBackgroundPressed,color:c.primaryButtonText}},r[k.i]={fontWeight:k.a.semibold,color:"HighlightText",background:"Highlight",MsHighContrastAdjust:"none"},r)}]),linkContent:[d.linkContent,{flex:"0 1 100%",selectors:{"& > * ":{marginLeft:4},"& > *:first-child":{marginLeft:0}}}],text:[d.text,{display:"inline-block",verticalAlign:"top"}],count:[d.count,{display:"inline-block",verticalAlign:"top"}],icon:d.icon}}),void 0,{scope:"Pivot"})},1489:function(e,t,n){"use strict";n.r(t),n.d(t,"TestListPage",(function(){return V}));var r=n(1),o=n(1030),i=n(1031),a=n(16);Object(a.e)([{rawString:".testListPivotContainer_771dbe7b{position:absolute;top:107px;bottom:0;left:0;right:0;border-top:1px solid "},{theme:"bodyDivider",defaultValue:"#edebe9"},{rawString:"}.item_771dbe7b{display:-webkit-box;display:-ms-flexbox;display:flex;border-bottom:1px solid #f3f2f1}.tabContentContainer_771dbe7b{position:absolute;top:45px;bottom:0;left:0;right:0}\n"}]);var s=n(1431),l=n(962),c=n(1039),u=n(934),d=n(1021),m=n(956),f=n(1408),p=n(61);var b=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},h=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),v=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},g=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},y=function(e){function t(){var e,n,r;b(this,t);for(var o=arguments.length,i=Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=r=v(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),r._lastRenderedStartIndex=-1,r._lastRenderedStopIndex=-1,r._memoizedUnloadedRanges=[],r._onItemsRendered=function(e){var t=e.visibleStartIndex,n=e.visibleStopIndex;r._lastRenderedStartIndex=t,r._lastRenderedStopIndex=n,r._ensureRowsLoaded(t,n)},r._setRef=function(e){r._listRef=e},v(r,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),h(t,[{key:"resetloadMoreItemsCache",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._memoizedUnloadedRanges=[],e&&this._ensureRowsLoaded(this._lastRenderedStartIndex,this._lastRenderedStopIndex)}},{key:"componentDidMount",value:function(){0}},{key:"render",value:function(){return(0,this.props.children)({onItemsRendered:this._onItemsRendered,ref:this._setRef})}},{key:"_ensureRowsLoaded",value:function(e,t){var n=this.props,r=n.isItemLoaded,o=n.itemCount,i=n.minimumBatchSize,a=void 0===i?10:i,s=n.threshold,l=void 0===s?15:s,c=function(e){for(var t=e.isItemLoaded,n=e.itemCount,r=e.minimumBatchSize,o=e.startIndex,i=e.stopIndex,a=[],s=null,l=null,c=o;c<=i;c++){t(c)?null!==l&&(a.push([s,l]),s=l=null):(l=c,null===s&&(s=c))}if(null!==l){for(var u=Math.min(Math.max(l,s+r-1),n-1),d=l+1;d<=u&&!t(d);d++)l=d;a.push([s,l])}if(a.length)for(var m=a[0];m[1]-m[0]+1<r&&m[0]>0;){var f=m[0]-1;if(t(f))break;m[0]=f}return a}({isItemLoaded:r,itemCount:o,minimumBatchSize:a,startIndex:Math.max(0,e-l),stopIndex:Math.min(o-1,t+l)});(this._memoizedUnloadedRanges.length!==c.length||this._memoizedUnloadedRanges.find((function(e,t){var n=g(e,2),r=n[0],o=n[1];return c[t][0]!==r||c[t][1]!==o})))&&(this._memoizedUnloadedRanges=c,this._loadUnloadedRanges(c))}},{key:"_loadUnloadedRanges",value:function(e){var t=this,n=this.props.loadMoreItems||this.props.loadMoreRows;e.forEach((function(e){var r=g(e,2),o=r[0],i=r[1],a=n(o,i);null!=a&&a.then((function(){if(function(e){var t=e.lastRenderedStartIndex,n=e.lastRenderedStopIndex,r=e.startIndex,o=e.stopIndex;return!(r>n||o<t)}({lastRenderedStartIndex:t._lastRenderedStartIndex,lastRenderedStopIndex:t._lastRenderedStopIndex,startIndex:o,stopIndex:i})){if(null==t._listRef)return;"function"==typeof t._listRef.resetAfterIndex?t._listRef.resetAfterIndex(o,!0):("function"==typeof t._listRef._getItemStyleCache&&t._listRef._getItemStyleCache(-1),t._listRef.forceUpdate())}}))}))}}]),t}(r.PureComponent),_=n(1123),k=n(1122),I=n(0),x=n(24),C=function(){function e(){this._items=new Array(2e4),this._callbacks=new Set}return e.prototype.loadRange=function(e,t){return Object(I.__awaiter)(this,void 0,void 0,(function(){var n,r,o,i,a,s,l;return Object(I.__generator)(this,(function(c){switch(c.label){case 0:return n=e>0?"&skiptoken="+e+"/20000&skip="+e:"",[4,fetch(x.c+"/me/drive/items/3096224744569320,3826129865/children?$top="+(t-e)+n)];case 1:return[4,c.sent().json()];case 2:for(r=c.sent(),o=r.value,i=e,a=0,s=o;a<s.length;a++)l=s[a],this._items[i]={id:l.id,name:l.name,fileSize:l.size,dateModified:l.lastModifiedDateTime},i++;return this._notifySubscribers(),[2]}}))}))},e.prototype.subscribe=function(e){var t=this;return this._callbacks.add(e),function(){t._callbacks.delete(e)}},Object.defineProperty(e.prototype,"items",{get:function(){return this._items},enumerable:!0,configurable:!0}),e.prototype._notifySubscribers=function(){var e=this;this._callbacks.forEach((function(t){t(e._items)}))},e}(),S=n(914);function R(e){var t=Object(k.useMemoizer)(),n=r.useState((function(){return new C}))[0],o=r.useState(),i=o[0],a=o[1],s=r.useCallback((function(e,t){return n.loadRange(e,t+1),Promise.resolve(void 0)}),[]),l=r.useCallback((function(e){return!!i&&!!i[e]}),[i]),c=r.useCallback((function(e){var t=e.key,n=e.index,o=e.style;if(!i)return null;var a=i[n];return a?r.createElement("div",{key:t,style:o,className:Object(p.e)(f.root,"item_771dbe7b")},a.name):null}),[i]),d=Object(S.useTelemetry)().telemetry,b=Object(_.useScrollLoadTracker)({itemCount:2e4,isItemLoaded:l,layoutTypeName:"testBasicListLayout",telemetry:d});return r.useEffect((function(){return n.subscribe((function(e){a(e)}))}),[]),r.createElement("div",{style:{height:700,width:1300}},r.createElement(m.ScrollContainer,null,r.createElement(y,{isItemLoaded:l,loadMoreItems:s,itemCount:2e4,threshold:50,minimumBatchSize:50},(function(e){var n=e.onItemsRendered,o=e.ref;return r.createElement(u.EqualItemSizeList,{ref:o,itemCount:2e4,surfaceOffset:0,overscanRatio:.5,itemSize:32,renderItem:c,onItemsRendered:t.evaluate(T)({onInfiniteLoaderItemsRendered:n,onScrollTelemetryItemsRendered:b}),unstable_enableElementRecycling:!0,viewportHeight:700,viewportWidth:1300})}))))}function T(e){var t=e.onInfiniteLoaderItemsRendered,n=e.onScrollTelemetryItemsRendered;return function(e){var r=e.visibleRange;t({visibleStartIndex:r[d.ItemRangeIndex.startIndex],visibleStopIndex:r[d.ItemRangeIndex.endIndex]-1}),n(e)}}var O=n(992),j=n(1103),L=n(1409),w=n(213),E=n(534),P=n(360),M=n(359),z=n(540),B=n(541),N=n(1099),K=n(539),A=[],D=function(){},H=[Object(I.__assign)(Object(I.__assign)({},M.fileTypeIconColumn),{onRender:function(e){return r.createElement(E.FileTypeIcon,{extension:e.name&&(t=e.name,n=t.lastIndexOf("."),t.substring(n))||void 0,size:24,iconAs:N.Icon});var t,n}}),Object(I.__assign)(Object(I.__assign)({},P.displayNameColumn),{onRender:function(e){return r.createElement(j.NameField,{isDisabled:!1,linkText:e.name,onClick:D,linkAs:K.Link})}}),Object(I.__assign)(Object(I.__assign)({},z.dateModifiedColumn),{onRender:function(e){var t=window.navigator.language;return e.dateModified?Object(w.getRelativeDateTimeStringPast)(new Date(e.dateModified),t):null}}),Object(I.__assign)(Object(I.__assign)({},B.fileSizeColumn),{onRender:function(e){return r.createElement(L.FileSizeField,{size:e.fileSize})}})];function F(e){var t=r.useState((function(){return new C}))[0],n=r.useState(A),o=n[0],i=n[1];r.useEffect((function(){return t.subscribe((function(e){i(e)}))}),[]);var a=r.useCallback((function(e){return r.createElement(U,Object(I.__assign)({},e,{items:o,dataProvider:t}))}),[o,t]);return r.createElement(m.ScrollContainer,null,r.createElement(O.DetailsList,{items:o,columns:H,onRenderList:a,compact:!0,enterModalSelectionOnTouch:!0}))}function U(e){var t=e.items,n=e.dataProvider,o=Object(I.__rest)(e,["items","dataProvider"]),i=Object(k.useMemoizer)(),a=r.useCallback((function(e,t){return n.loadRange(e,t+1),Promise.resolve(void 0)}),[]),s=r.useCallback((function(e){return!!t&&!!t[e]}),[t]),l=Object(S.useTelemetry)().telemetry,c=Object(_.useScrollLoadTracker)({itemCount:2e4,isItemLoaded:s,layoutTypeName:"testFabricListLayout",telemetry:l});return r.createElement(y,{isItemLoaded:s,loadMoreItems:a,itemCount:2e4,threshold:50,minimumBatchSize:50},(function(e){var t=e.onItemsRendered,n=e.ref;return r.createElement(u.EqualItemSizeList,Object(I.__assign)({ref:n,itemCount:2e4,surfaceOffset:0,overscanRatio:1,itemSize:32},o,{onItemsRendered:i.evaluate(W)({onInfiniteLoaderItemsRendered:t,onScrollTelemetryItemsRendered:c}),unstable_enableElementRecycling:!0}))}))}function W(e){var t=e.onInfiniteLoaderItemsRendered,n=e.onScrollTelemetryItemsRendered;return function(e){var r=e.visibleRange;t({visibleStartIndex:r[d.ItemRangeIndex.startIndex],visibleStopIndex:r[d.ItemRangeIndex.endIndex]-1}),n(e)}}function V(e){return r.createElement(r.Fragment,null,r.createElement("div",{className:o.t},r.createElement(i.ItemsBreadcrumbBeta,{className:o.e})),r.createElement("div",{className:"testListPivotContainer_771dbe7b"},r.createElement(s.e,{linkSize:l.t.large},r.createElement(c.e,{headerText:"Basic"},r.createElement("div",{className:"tabContentContainer_771dbe7b"},r.createElement(R,null))),r.createElement(c.e,{headerText:"With Fabric"},r.createElement("div",{className:"tabContentContainer_771dbe7b"},r.createElement(F,null))))))}},257:function(e,t,n){"use strict";n.d(t,"e",(function(){return o}));var r=n(46),o=function(){function e(){this._lastInvocations=new WeakMap}return e.prototype.evaluate=function(e){var t=this._lastInvocations;return function(n){var o=t.get(e);if(!o||!Object(r.areShallowEqual)(o.props,n)){var i=e(n);return t.set(e,{props:n,result:i}),i}return o.result}},e}()},962:function(e,t,n){"use strict";var r,o;n.d(t,"e",(function(){return r})),n.d(t,"t",(function(){return o})),function(e){e[e.links=0]="links",e[e.tabs=1]="tabs"}(r||(r={})),function(e){e[e.normal=0]="normal",e[e.large=1]="large"}(o||(o={}))},992:function(e,t,n){e.exports=n(1047)}}]);
//# sourceMappingURL=index.fileexplorer-testlistpage.js.map