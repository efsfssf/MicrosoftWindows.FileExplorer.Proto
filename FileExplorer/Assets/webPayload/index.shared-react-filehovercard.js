(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{1001:function(e,t,n){"use strict";var r,a,i,o,s,c,l,d,u,p,m,f;n.d(t,"e",(function(){return h})),n.d(t,"n",(function(){return g})),n.d(t,"t",(function(){return y})),function(e){e[e.HEADER=0]="HEADER",e[e.NAV=1]="NAV",e[e.FOOTER=2]="FOOTER",e[e.SEARCHBOX=3]="SEARCHBOX"}(r||(r={})),function(e){e[e.LEFT=0]="LEFT",e[e.HORIZONTAL=1]="HORIZONTAL"}(a||(a={})),function(e){e[e.FULLBLEED=0]="FULLBLEED",e[e.WITHLEFTNAV=1]="WITHLEFTNAV"}(i||(i={})),function(e){e[e.none=0]="none",e[e.standard=1]="standard",e[e.compact=2]="compact",e[e.minimal=3]="minimal",e[e.extended=4]="extended"}(o||(o={})),function(e){e[e.left=0]="left",e[e.middle=1]="middle",e[e.right=2]="right"}(s||(s={})),function(e){e[e.SIMPLE=0]="SIMPLE",e[e.EXTENDED=1]="EXTENDED",e[e.STACKED=2]="STACKED"}(c||(c={})),function(e){e[e.Strong=0]="Strong",e[e.Neutral=1]="Neutral",e[e.Soft=2]="Soft",e[e.None=3]="None"}(l||(l={})),function(e){e[e.NoWarning=0]="NoWarning",e[e.Warning=1]="Warning",e[e.OverQuota=2]="OverQuota"}(d||(d={})),function(e){e[e.Default=0]="Default",e[e.AllPages=1]="AllPages",e[e.ModernOnly=2]="ModernOnly",e[e.Hidden=3]="Hidden"}(u||(u={})),function(e){e[e.None=0]="None",e[e.PrivateChannel=1]="PrivateChannel",e[e.SharedChannel=2]="SharedChannel",e[e.StandardChannel=3]="StandardChannel"}(p||(p={})),function(e){e[e.Default=0]="Default",e[e.Tenant=1]="Tenant",e[e.Hub=2]="Hub",e[e.Site=3]="Site"}(m||(m={})),function(e){e[e.FooterEnabled=2]="FooterEnabled",e[e.MegaMenuEnabled=128]="MegaMenuEnabled",e[e.FooterEmphasis0=256]="FooterEmphasis0",e[e.FooterEmphasis1=512]="FooterEmphasis1",e[e.FooterLayout0=1024]="FooterLayout0",e[e.FooterLayout1=2048]="FooterLayout1",e[e.HideTitleInHeader=33554432]="HideTitleInHeader"}(f||(f={}));function h(e){return"/"===e.webServerRelativeUrl?"":e.webServerRelativeUrl}function g(e){return e&&e.webAbsoluteUrl===e.siteAbsoluteUrl}function y(e){return!!(e.companyPortalReference&&e.companyPortalReference.SiteId&&e.siteId&&e.siteId.indexOf(e.companyPortalReference.SiteId)>=0)}},1009:function(e,t,n){e.exports=n(452)},1010:function(e,t,n){"use strict";var r,a=n(0),i=n(106),o=n.n(i),s=n(995),c=n(944),l=n(1012),d=n(1011),u=n.n(d),p=(r=function(e){return u.a.isFeatureEnabled(e)},Object(l.isDataSyncEnabled)(r)?n.e(9).then(n.t.bind(null,1120,7)).then((function(e){return function(t){return e.getDataSyncClient(t,r)}})):o.a.resolve((function(e){}))),m=function(){function e(e,t){var n=this._pageContext=t.pageContext,r=t.tokenProvider,i=t.dataRequestorType,o=void 0===i?function(e){function t(t){return e.call(this,t,{pageContext:n,tokenProvider:r})||this}return Object(a.__extends)(t,e),t}(s.default):i,c=t.dataSyncClient,l=e.dataSourceName,d=void 0===l?"DataSource":l;this.dataSyncClient=c,this.dataRequestor=new o({qosName:d})}return e.prototype.needsRequestDigest=function(e){return!0},e.prototype.getData=function(e,t,n,r,a,i,s,l,d,u,m,f,h){var g=this;void 0===a&&(a="POST");var y=e(),v=r&&r(),_=function(){return g.dataRequestor.getData({url:y,parseResponse:t,qosName:n,additionalPostData:v,method:a,additionalHeaders:i,contentType:s,maxRetries:l,noRedirect:d,crossSiteCollectionCall:u,telemetryHandler:m,qosExtraData:f,needsRequestDigest:g.needsRequestDigest(y),authToken:h})};if(!this._pageContext.aadUserId)return _();var C=function(e){var r=Object(c.e)(e,m);return e.getData({url:y},(function(e){return g.dataRequestor.getData({url:e.url,authToken:e.authToken,parseResponse:t,qosName:n,additionalPostData:v,method:a,additionalHeaders:i,contentType:s,maxRetries:l,noRedirect:d,crossSiteCollectionCall:u,telemetryHandler:function(t){return r(t,e)},qosExtraData:f,needsRequestDigest:g.needsRequestDigest(e.url),useExactAuthToken:!0})}),_)};return this.dataSyncClient?o.a.wrap(C(this.dataSyncClient)):o.a.wrap(p).then((function(e){var t=e(g._pageContext.aadUserId);return t?C(t):_()}))},e}();t.e=m},1011:function(e,t,n){e.exports=n(975)},1012:function(e,t,n){e.exports=n(977)},1013:function(e,t,n){e.exports=n(1048)},1014:function(e,t,n){"use strict";n.r(t),n.d(t,"RUMOneDataUpload",(function(){return a}));var r=n(167),a=Object(r.createSingleEvent)({eventName:"RUMOneDataUpload,",shortEventName:"RUMOneDataUpload"},{streamName:1,dictionary:4,privacyClassification:{isPrefixingDisabled:!0,type:1}}).withData({privacyClassification:"requiredService"})},1015:function(e,t,n){e.exports=n(1016)},1016:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return a}));var r=n(912);function a(e){var t,n=e.adjustRetries,a=e.async,i=e.beforeRetry,o=e.callback,s=e.canRetry,c=void 0===s?function(){return!0}:s,l=e.delay,d=e.resetAttemptsOnRestart,u=e.retries,p=e.shouldRestart,m=0,f=new r.default((function(){t.cancel()}));function h(e){p&&p()?(d&&(m=0),y()):f.complete(e)}function g(e){n&&(u=n(e)),m<u&&c(e)?(m++,i&&i(),"number"==typeof l&&a?a.setTimeout(y,l):y()):f.error(e)}function y(){(t=o()).then(h,g)}return y(),f.getPromise()}},1048:function(e,t,n){"use strict";n.r(t),n.d(t,"APICallHostType",(function(){return C})),n.d(t,"APICallPerformanceData",(function(){return x})),n.d(t,"ControlPerformanceData",(function(){return T})),n.d(t,"RUMOneLogger",(function(){return I}));var r,a=n(0),i=n(519);!function(e){e[e.none=0]="none",e[e.fullPageLoad=4]="fullPageLoad",e[e.onePageAppNavigation=5]="onePageAppNavigation"}(r||(r={}));var o=r,s=n(1287),c=n(500),l=window.performance,d=!!l&&"function"==typeof l.mark&&"function"==typeof l.clearMarks&&"function"==typeof l.now,u=0,p=window._perfMarks=window._perfMarks||[];function m(e){var t=f(e);if(d){var n=l.getEntriesByName(t,"mark");return n&&n.length>0?Math.round(n[0].startTime):NaN}var r=p.filter((function(e){return e.name===t}))[0];return r&&r.startTime}function f(e){return 0===e.lastIndexOf("EUPL.",0)?e:"EUPL."+e}var h=n(263);function g(){return window.performance&&performance.now?Math.round(performance.now()):Date.now()}var y,v="undefined"==typeof window?self:window;!function(e){e[e.xhr=0]="xhr",e[e.fetch=1]="fetch"}(y||(y={}));var _,C,b=function(){function e(){var e;this._requestIdGenerator=(e=0,function(){return(e++).toString()})}return e.prototype.instrument=function(e){var t=this;if(!v.__RUMOneAPITrackerInstrumented){v.__RUMOneAPITrackerInstrumented=!0;var n=e.fetch,r=e.xhr;if("XMLHttpRequest"in v&&"undefined"!=typeof XMLHttpRequest){this._originalXhrSend=XMLHttpRequest.prototype.send,this._originalXhrOpen=XMLHttpRequest.prototype.open;var a=this;XMLHttpRequest.prototype.open=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.requestUrl=e[1],a._originalXhrOpen.apply(this,e)},XMLHttpRequest.prototype.send=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var i=a._requestIdGenerator();return r.onRequest({request:this,id:i,type:0}),this.addEventListener("readystatechange",(function(){4===e.readyState&&r.onResponse({request:e,id:i,type:0})})),a._originalXhrSend.apply(this,t)}}"fetch"in v&&void 0!==v.fetch&&(this._originalFetch=v.fetch.bind(v),v.fetch=function(e,r){return new Promise((function(a,i){var o=t._requestIdGenerator();n.onRequest({request:e,id:o,type:1}),t._originalFetch(e,r).then((function(e){n.onResponse({response:e,id:o,type:1}),a(e)}),(function(e){i(e)}))}))})}},e.prototype.undoInstrument=function(){v.__RUMOneAPITrackerInstrumented=!1,this._originalXhrOpen&&(XMLHttpRequest.prototype.open=this._originalXhrOpen),this._originalXhrSend&&(XMLHttpRequest.prototype.send=this._originalXhrSend),this._originalFetch&&(v.fetch=this._originalFetch)},e}(),w=n(354),S=n(518);!function(e){e[e.Incomplete=1]="Incomplete",e[e.ReadyToUpload=2]="ReadyToUpload",e[e.Uploaded=3]="Uploaded",e[e.TimeOut=4]="TimeOut",e[e.Skipped=5]="Skipped"}(_||(_={})),function(e){e[e.own=0]="own",e[e.cors=1]="cors"}(C||(C={}));var x=function(e,t,n,r,a,i,o){this.url=e,this.duration=t,this.correlationId=n,this.status=r,this.startTime=a,this.endTime=i,this.name=o,this.clientDurationInMilliseconds=new Date(i).getTime()-new Date(a).getTime(),this.origin=e&&new w.default(e).getHost()},D=["EUPL","ScenarioId"],E=/^[a-zA-Z0-9](([a-zA-Z0-9|_|\.]){0,98}[a-zA-Z0-9])?$/,T=function(e,t,n,r,a,i,o){this.controlId=e,this.startTime=t,this.endTime=n,this.renderTimeCalculator=r,this.renderTimeRequiredDataChecker=a,this.ignoreForEUPL=void 0===i||i,this.needFlatten=void 0!==o&&o};function k(e){return null==e}var O={checkInterval:100,error_timeout:3e4,max_markers:200},I=function(){function e(e,t,n){void 0===n&&(n=O),this._keyMetrics=D.slice(0),this.async=new i.default(this),this.dataStartTime=Date.now(),this._rumoneData={},this.dataState=_.Incomplete,this.controls=[],this.apis=[],this._apiBuffer={},this._loggingFunctions=[],this.euplBreakDown={},this.ttiBreakDown={},this.serverMetrics={},this.isW3cTimingCollected=!1,this.isW3cResourceTimingCollected=!1,this.tempData={},this._settings={},this._emergencyUpdateFunc=this._emergencyUpload.bind(this),this._name=e,this.registerLoggingFunc(t),this._config=n,this.setPerfDataTimer(),this._platformDetection=new c.PlatformDetection,this._hookUnloadEvent(),this._apiTracker=new b}return e.getRUMOneLogger=function(t,n,r){void 0===t&&(t="__default_rumone__"),void 0===r&&(r=O);var a=n||function(e,t){s.RUMOneDataUpload.logData({streamName:e,dictionary:t})};if(!e.Loggers[t])try{var i=new e(t,a,r);"__default_rumone__"===t&&(e.rumOneLogger=i),e.Loggers[t]=i}catch(e){}return e.Loggers[t]},e.prototype.registerLoggingFunc=function(e){var t=this,n=this._loggingFunctions.indexOf(e);return n<0&&this._loggingFunctions.push(e),function(){n>=0&&t._loggingFunctions.splice(n,1)}},Object.defineProperty(e.prototype,"KeyMetrics",{get:function(){return this._TTIMeasurementEnabled()&&(this.addExpectedKeyMetric("TTI"),this.addExpectedKeyMetric("FCI")),this._keyMetrics},enumerable:!0,configurable:!0}),e.prototype.getPerformanceData=function(){return this._rumoneData},e.prototype.startAPIMeasurement=function(e){var t=this,n=e&&e.ignore||function(e){return!1},r=function(e){var n=e.id,r=e.request,a=e.type,i=new x;i.startTime=(new Date).toISOString(),i.startTimeRelative=t.now(),1===a&&(i.url="string"==typeof r?r:r.url),t._apiBuffer[n]=i};return this._apiTracker.instrument({fetch:{onRequest:r,onResponse:function(e){var r=e.response,i=e.id,o=t._apiBuffer[i];if(o&&!n(o.url)){var s=void 0;try{s=r.headers.get("SPClientServiceRequestDuration")}catch(e){}var c=void 0;try{c=r.headers.get("SPRequestGuid")}catch(e){}o=Object(a.__assign)(Object(a.__assign)({},o),Object(a.__assign)(Object(a.__assign)({endTime:(new Date).toISOString(),endTimeRelative:t.now(),clientDurationInMilliseconds:t.now()-o.startTimeRelative,status:r.status},s?{duration:Number(s)}:{}),c?{correlationId:c}:{})),t.apis.push(o)}}},xhr:{onRequest:r,onResponse:function(e){var r=e.request,i=e.id,o=t._apiBuffer[i],s=r.responseURL||r.requestUrl;if(o&&!n(s)){var c;c=r.getResponseHeader("SPClientServiceRequestDuration");var l;l=r.getResponseHeader("SPRequestGuid"),o=Object(a.__assign)(Object(a.__assign)({},o),Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({endTime:(new Date).toISOString(),endTimeRelative:t.now(),clientDurationInMilliseconds:t.now()-o.startTimeRelative,status:r.status},c?{duration:Number(c)}:{}),l?{correlationId:l}:{}),{url:s})),t.apis.push(o)}}}}),function(){t._apiTracker.undoInstrument()}},e.prototype.resetLogger=function(){var t,n;this._emergencyUpload(),this._apiBuffer={},this.dataStartTime=(new Date).getTime(),this.dataState=_.Incomplete,this.isW3cTimingCollected=!1,this.isW3cResourceTimingCollected=!1,this.controls=[],this.apis=[],this.tempData={},this._rumoneData={},this._settings={},this._keyMetrics=D.slice(0),this.clearPerfDataTimer(),this.setPerfDataTimer(),this.euplBreakDown={},this.ttiBreakDown={},this.serverMetrics={},this.clearResourceTimings(),t=this._getOwnMakers().map((function(e){return e.name})),n=[],t&&(n=t.map(f)),d?l.getEntriesByType("mark").filter((function(e){return n.length>0?n.indexOf(e.name)>=0:0===e.name.lastIndexOf("EUPL.",0)})).forEach((function(e){l.clearMarks(e.name)})):p=[],e._markers[this._name]=[],this._unhookUnloadEvent(),this._hookUnloadEvent(),this._ttiPromise=void 0,this._fciPromise=void 0,this.logMessageInConsole("Reset performance Logger Done")},e.prototype.setSettings=function(e){this._settings=Object(a.__assign)(Object(a.__assign)({},this._settings),e)},e.prototype.excludePageForPerfData=function(){this.setSettings({excludePageData:!0})},e.prototype.getPerformanceDataPropertyValue=function(e){return e&&this._rumoneData[e]},e.prototype.setPerformanceDataPropertyValue=function(e,t){return e&&E.test(e)?(this._rumoneData[e]=t,!0):(console.error("key "+e+" does not confrim to the Regex "+E),!1)},e.prototype.addExpectedControl=function(e){var t=this._normalizeControl(e);this.expectingControl(e)?this.controls.filter((function(e){return e.controlId===t.controlId}))[0].ignoreForEUPL=t.ignoreForEUPL:this.controls.push(t)},e.prototype.expectingControl=function(e){var t=this._normalizeControl(e);return this.controls.filter((function(e){return e.controlId===t.controlId})).length>0},e.prototype.writeServerCorrelationId=function(e){this._rumoneData.ServerCorrelationId=this._rumoneData.ServerCorrelationId||e},e.prototype.writeServerUrl=function(e){var t=new S.default(e||"");this._rumoneData.ServerUrl=t.authority+"/{ length: "+t.path.length+", segments: "+t.segments.length+" }"},e.prototype.writeServerSideLatency=function(e,t){this.isCollected("ServerRequestDuration")||(this._rumoneData.ServerRequestDuration=e,this._rumoneData.IISLatency=t)},e.prototype.writeControlPerformanceData=function(e){if(e){var t=this.controls.filter((function(t){return t.controlId===e.controlId}))[0];if(t)t.data||(t.data=e);else{var n={controlId:e.controlId,data:e,ignoreForEUPL:e.ignoreForEUPL};this.controls.push(n)}}},e.prototype.writeAPICallPerformanceData=function(e){e&&this.apis.push(e)},e.prototype.readAPICallPerformanceData=function(){return this.apis},e.prototype.writeAppCache=function(e){this.isCollected("AppCache")||(this._rumoneData.AppCache=e)},e.prototype.writePageTransitionType=function(e,t){this.isCollected("PageTransitionType")&&!t||e!==o.fullPageLoad&&e!==o.none&&e!==o.onePageAppNavigation||(this._rumoneData.PageTransitionType=e)},e.prototype.writeScenarioId=function(e,t){this.isCollected("ScenarioId")&&!t||(this._rumoneData.ScenarioId=e)},e.prototype.collectW3CPerfTimings=function(){if(!this.isW3cTimingCollected){var e=["navigationStart","unloadEventStart","unloadEventEnd","fetchStart","redirectStart","redirectEnd","domainLookupStart","domainLookupEnd","connectStart","secureConnectionStart","connectEnd","requestStart","responseStart","responseEnd","domLoading","domComplete","loadEventStart","loadEventEnd"],t=performance&&performance.timing;if(t){for(var n=0;n<e.length;n++){var r=t[e[n]];r&&this._logRUMOneData(this.getW3cTimingName(e[n]),Number(r))}this.isW3cTimingCollected=!0}}},e.prototype.collectW3cResourceTimings=function(){if(window.document&&!this.isW3cResourceTimingCollected&&performance&&performance.getEntriesByType){for(var e=performance.getEntriesByType("resource"),t=document.getElementsByTagName("iframe"),n=0;n<t.length;n++){var r=null;try{r=t[n].contentWindow.performance}catch(e){}r&&r.getEntriesByType&&e.concat(r.getEntriesByType("resource"))}var i={SharePoint:function(e){return h.Killswitch.isActivated("7FED230C-E6D5-45CE-95AA-52F21A8C16C9","11/21/2019")?/\.sharepoint\.com|\.spoppe\.com/i.test(e.name):0===e.name.search(window.location.protocol+"//"+window.location.host)},CDN:function(e){if(h.Killswitch.isActivated("7FED230C-E6D5-45CE-95AA-52F21A8C16C9","11/21/2019"))return/(cdn(ppe)?|static(ppe)?)\.sharepointonline\.com|\.akamaihd\.net/i.test(e.name);var t=window._spPageContextInfo,n=e.name;return!(!t||!t.cdnPrefix||0!==n.search(window.location.protocol+"//"+t.cdnPrefix))||(!(!t||!t.cdnBaseUrl||0!==n.search(t.cdnBaseUrl))||/(cdn(ppe)?|static(ppe)?)\.sharepointonline\.com|\.akamaihd\.net/i.test(n))},ThirdParty:function(e){return!i.SharePoint(e)&&!i.CDN(e)}},o={ASPX:function(e){return/\.aspx/i.test(e.name)},JS:function(e){return/script/i.test(e.initiatorType)},CSS:function(e){return/link|css/i.test(e.initiatorType)},IMG:function(e){return/img/i.test(e.initiatorType)}},s=Object.keys(i);for(n=0;n<s.length;n++){var c=s[n],l=this.categorizeResourceRequests(e,{from:i[c],requestType:null});this._logRUMOneData(c+"RequestCountTotal",l.length);for(var d=Object.keys(o),u=0;u<d.length;u++){var p=d[u];this._logRUMOneData(c+"RequestCount"+p,this.categorizeResourceRequests(l,{from:null,requestType:o[p]}).length)}if(l.length>0){this._logRUMOneData(c+"RequestDownloadTime",Math.round(l.reduce((function(e,t){return e+t.duration}),0)/l.length));var m=JSON.stringify(l.map((function(e){return Object(a.__assign)(Object(a.__assign)({name:e.name.split("/").map((function(e){return e.split("?")[0]})).filter((function(e){return e&&e.length>0})).slice(-1)[0].replace(/\(.*?\)/g,"()"),startTime:Math.round(e.startTime),duration:Math.round(e.duration),transferSize:e.transferSize||0},"workerStart"in e?{workerStart:Math.round(e.workerStart)}:{}),{fetchStart:Math.round(e.fetchStart),requestStart:Math.round(e.requestStart)})})));this._logRUMOneData(c+"RequestNames",m)}}this.isW3cResourceTimingCollected=!0}},e.prototype.saveTempData=function(e,t){this.tempData[e]=t},e.prototype.readTempData=function(e){return this.tempData[e]},e.prototype.writeRenderTime=function(e,t){this.isCollected("RenderTime")&&!t||(this._rumoneData.RenderTime=e)},e.prototype.writePreRenderTime=function(e){this.isCollected("PreRender")||(this._rumoneData.PreRender=e)},e.prototype.writePostRenderTime=function(e){this.isCollected("PostRender")||(this._rumoneData.PostRender=e)},e.prototype.writeDataFetchTime=function(e,t){this.isCollected("DataFetch")&&!t||(this._rumoneData.DataFetch=e)},e.prototype.writeAppInfo=function(e,t){this.isCollected("AppInfo")&&!t||(this._rumoneData.AppInfo=e)},e.prototype.isRunning=function(){return!(this.dataState===_.Uploaded||this.dataState===_.TimeOut||this.dataState===_.Skipped)},e.prototype.writeEUPLBreakdown=function(e,t){return this._writeBreakdown(this.euplBreakDown,e,t)},e.prototype.addEUPLBreakdown=function(e,t,n){return this._addBreakdown(this.euplBreakDown,e,t,n)},e.prototype.readEUPLBreakdown=function(e){return this._readBreakdown(this.euplBreakDown,e)},e.prototype.writeTTIBreakdown=function(e,t){return this._writeBreakdown(this.ttiBreakDown,e,t)},e.prototype.addTTIBreakdown=function(e,t,n){return this._addBreakdown(this.ttiBreakDown,e,t,n)},e.prototype.readTTIBreakdown=function(e){return this._readBreakdown(this.ttiBreakDown,e)},e.prototype.addFlights=function(e){if(e&&e.length>0){for(var t=JSON.parse(this.getPerformanceDataPropertyValue("Flights")||"[]"),n=0;n<e.length;n++){var r=e[n];r&&-1===t.indexOf(r)&&t.push(r)}this._rumoneData.Flights=JSON.stringify(t)}},e.prototype.collectSPClientFlights=function(e){for(var t="",n=0,r=e.ExpFeatures;n<r.length;n++){var a=r[n];t+=this._numberToBinString(a).split("").reverse().join("")}this._rumoneData.Flights=t},e.prototype.addServerMetrics=function(e,t){if(e)for(var n in e)n&&!k(e[n])&&(k(this.serverMetrics[n])||t)&&(this.serverMetrics[n]=e[n])},e.prototype.writeServerVersion=function(e){this._rumoneData.SharePointServerVersion=e},e.prototype.readControlPerformanceData=function(){return this.controls.filter((function(e){return!!e.data})).map((function(e){return e.data}))},e.prototype.mark=function(t){(e._markers[this._name]=e._markers[this._name]||[]).push(t),function(e,t){var n=f(e);(null==t||u<t)&&(d?l.mark(n):p.push({name:n,startTime:Date.now()}),u++)}(t)},e.prototype.now=function(){return performance&&performance.now?Math.round(performance.now()):NaN},e.prototype.registerEUPLComputedHandler=function(e){this._EUPLComputedHandler=e},e.prototype.registerErrorHandler=function(e){},e.prototype.getMarkerTime=function(e){return m(e)},e.prototype.addExpectedKeyMetric=function(e){this._keyMetrics&&-1===this._keyMetrics.indexOf(e)&&this._keyMetrics.push(e)},Object.defineProperty(e.prototype,"waitOnAddingExpectedControl",{set:function(e){this.setSettings({waitOnAddingExpectedControl:e})},enumerable:!0,configurable:!0}),e.prototype._measureTTI=function(){var e=this;this._rumoneData.TTISupported="PerformanceLongTaskTiming"in window,this._TTIPolyfillEnabled()&&!this._ttiPromise&&(this._ttiPromise=function(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){var t;return Object(a.__generator)(this,(function(r){switch(r.label){case 0:return t=Object(a.__assign)({minValue:g(),useMutationObserver:!1,trackNetworkRequests:!1,requiredMainThreadQuietnessDurationInMilliseconds:1e3,requiredNetworkQuietnessDurationInMilliseconds:1e3},e),[4,n.e(33).then(n.t.bind(null,1477,7))];case 1:return[2,r.sent().getFirstConsistentlyInteractive(t)]}}))}))}(this._settings.TTISettings.TTIPolyfillSettings.options),this._ttiPromise.then((function(t){var n=t;if(k(n))n=NaN;else{var r=e._settings.TTISettings.TTIPolyfillSettings.calculateTTI;r&&(n=r(Math.round(t),e._rumoneData))}e._rumoneData.TTI=n}))),this._TTIPolyfillEnabled()&&!this._fciPromise&&(this._fciPromise=function(){return Object(a.__awaiter)(this,void 0,void 0,(function(){var e;return Object(a.__generator)(this,(function(t){switch(t.label){case 0:return e={measurementStartTime:g(),requiredMainThreadCPUIdleDurationInMilliseconds:1e3},[4,n.e(30).then(n.t.bind(null,1478,7))];case 1:return[2,t.sent().getFirstCPUIdle(e)]}}))}))}(),this._fciPromise.then((function(t){var n=t;if(k(n))n=NaN;else{var r=e._settings.TTISettings.TTIPolyfillSettings.calculateTTI;r&&(n=r(Math.round(t),e._rumoneData))}e._rumoneData.FCI=n})))},e.prototype._numberToBinString=function(e){var t=(e>>>0).toString(2);return""+Array(32-t.length+1).join("0")+t},e.prototype._logRUMOneData=function(e,t){e&&(this._rumoneData[e]=t)},e.prototype.clearResourceTimings=function(){performance&&performance.clearResourceTimings&&performance.clearResourceTimings()},e.prototype._isBreakdownValue=function(e){return void 0!==e.needFlatten},e.prototype.collectMarks=function(){var e=this,t={},n=0;this._getOwnMakers().forEach((function(r){if(n<e._config.max_markers){var a=r.name.substr("EUPL.".length)+".mark"+n++;t[a]=Math.round(r.startTime)}})),this.writeEUPLBreakdown(JSON.stringify(t))},e.prototype._getOwnMakers=function(){var t=this,n=e._markers,r=[].concat.apply([],Object.keys(n).filter((function(e){return n.hasOwnProperty(e)&&e!==t._name})).map((function(e){return n[e]})));return(d?l.getEntriesByType("mark").filter((function(e){return 0===e.name.lastIndexOf("EUPL.",0)})):p).filter((function(e){return-1===r.indexOf(e.name)}))},e.prototype.logMessageInConsole=function(e){this.isRUMOneDebuggingEnabled&&console.log(e)},Object.defineProperty(e.prototype,"isRUMOneDebuggingEnabled",{get:function(){try{if("sessionStorage"in window&&window.sessionStorage){var e=window.sessionStorage.enableRUMOneDebugging;return e&&"true"===e.toLowerCase()&&"undefined"!=typeof console&&!!console}}catch(e){}return!1},enumerable:!0,configurable:!0}),e.prototype.logObjectForDebugging=function(e,t){if(this.isRUMOneDebuggingEnabled){var n=this._name+" "+e+" : "+JSON.stringify(t);console.log(n)}},e.prototype.isCollected=function(e){return!k(this.getPerformanceDataPropertyValue(e))},e.prototype._normalizeControl=function(e){return"string"==typeof e?{controlId:e,ignoreForEUPL:!1}:e},e.prototype.setPerfDataTimer=function(){this.perfDataTimer=this.async.setTimeout(this.loopForDataCompleteness,this._config.checkInterval)},e.prototype.clearPerfDataTimer=function(){k(this.perfDataTimer)||(this.async.clearTimeout(this.perfDataTimer),this.perfDataTimer=null)},e.prototype._hookUnloadEvent=function(){window.addEventListener&&window.addEventListener("beforeunload",this._emergencyUpdateFunc)},e.prototype._unhookUnloadEvent=function(){window.removeEventListener&&window.removeEventListener("beforeunload",this._emergencyUpdateFunc)},e.prototype.categorizeResourceRequests=function(e,t){for(var n=[],r=0;r<e.length;r++){var a=e[r];t.from&&!t.from(a)||t.requestType&&!t.requestType(a)||n.push(a)}return n},e.prototype._setFCP=function(){var e=NaN,t=performance&&performance.getEntriesByType&&performance.getEntriesByType("paint");if(t&&t.length>0){var n=t.filter((function(e){return"first-contentful-paint"===e.name}));if(n&&1===n.length)e=n[0].startTime;else{var r=t.filter((function(e){return"first-paint"===e.name}));r&&1===r.length&&(e=r[0].startTime)}}isNaN(e)||(this._rumoneData.FCP=e)},e.prototype.collectSupplementaryData=function(){this._setFCP(),this.setAPIDataToRUMOne(),this.collectMarks(),this.writeServerUrl(null),this.setBrowseInfo(),this.setReferrer(),this._collectMemoryData(),this._collectPageServerData(),this._setAppInfo(),this._setTestName(),this._collectExperiments(),this._rumoneData.ServerMetrics=JSON.stringify(this.serverMetrics),this._rumoneData.EUPLBreakdown=JSON.stringify(this.euplBreakDown),this._rumoneData.TTIBreakdown=JSON.stringify(this.ttiBreakDown)},e.prototype._collectExperiments=function(){var e=window.ODSP_EXPERIMENTS||{},t={};for(var n in e)if(e.hasOwnProperty(n)){var r=e[n];r&&r._serverTime&&Date.now()-new Date(r._serverTime).getTime()<1296e6&&(t[n]=e[n])}this._rumoneData.SPExperiments=JSON.stringify(t)},e.prototype._setTestName=function(){var e=new w.default(location.href).getQueryParameter("perftest");e&&!this._rumoneData.TestName&&(this._rumoneData.TestName=e)},e.prototype.loopForDataCompleteness=function(){if(this.clearPerfDataTimer(),!this._settings.waitOnAddingExpectedControl){if(this.isRUMOneDebuggingEnabled&&(this.logMessageInConsole("===================================================================="),this.logObjectForDebugging("RUMONE: ",this._rumoneData),this.logObjectForDebugging("RUMOne DataState: ",String(this.getReadableDataState(this.dataState))),this.logObjectForDebugging("Controls: ",this.controls),this.logObjectForDebugging("API Performance Data: ",this.apis),this.logObjectForDebugging("Temp Data: ",this.tempData),this.logObjectForDebugging("EUPLBreakdown: ",this.euplBreakDown),this.logObjectForDebugging("TTIBreakdown: ",this.ttiBreakDown),this.logObjectForDebugging("ServerMetrics: ",this.serverMetrics),this.logMessageInConsole("====================================================================\n\n")),!this.isRunning())return;this._updateState()}this._checkTimeout(),this.isRunning()&&this.setPerfDataTimer()},e.prototype._updateState=function(){switch(this.dataState){case _.Incomplete:this.processControlRenderTime(),this.readyToComputeEUPL()&&this.setEUPL();var e=this._getMissedControls();this._TTIMeasurementEnabled()&&this.isCollected("EUPL")&&0===e.length&&this._measureTTI(),0===this._getMissedKeyMetrics().length&&0===e.length&&(this.dataState=_.ReadyToUpload);break;case _.ReadyToUpload:this._uploadPerfData({emergency:!1})}},e.prototype._checkTimeout=function(){if(this.isRunning()&&this.dataState!==_.ReadyToUpload){var e=Date.now();if(!(this.dataState===_.Incomplete&&e-this.dataStartTime<=this._config.error_timeout)){var t={reason:"TimeOut",details:{MissingMetrics:this._getMissedKeyMetrics(),MissingControls:this._getMissedControls()}};this._rumoneData.RUMOneError=JSON.stringify(t),this.dataState=_.TimeOut,this._uploadPerfData({emergency:!1})}}},e.prototype._getMissedKeyMetrics=function(){for(var e=[],t=0;t<this.KeyMetrics.length;t++){k(this.getPerformanceDataPropertyValue(this.KeyMetrics[t]))&&e.push(this.KeyMetrics[t])}return e},e.prototype._getMissedControls=function(){return this.controls.filter((function(e){return!e.data||!e.data.renderTime}))},e.prototype._emergencyUpload=function(){this.isRunning()&&this._uploadPerfData({emergency:!0})},e.prototype._uploadPerfData=function(e){this.writeControlDataToRUMOne(),this.collectSupplementaryData();var t,n=e.emergency;this._rumoneData.EmergencyUploaded=!!n;try{if(this._settings.excludePageData)this.dataState=_.Skipped,this.logMessageInConsole("Uploading perf data skipped as requested by the consumer");else if(n||this.dataState===_.ReadyToUpload||this.dataState===_.TimeOut)if(this._loggingFunctions&&this._loggingFunctions.length>0)if(this._rumoneData){var r=this.getPerformanceData();this._loggingFunctions.forEach((function(e){e("RUMOne",r)})),this.dataState=_.Uploaded,this.isRUMOneDebuggingEnabled&&(this.logMessageInConsole("Final Data uploaded"),this.logObjectForDebugging("RUMONE: ",r),this.logObjectForDebugging("RUMOne DataState: ",this.getReadableDataState(this.dataState)))}else console.error("Error: Uploading perf data called but perf data is not available");else console.error("Uploading perf data skipped as loggingFunc is not defined");else console.error("Error: Uploading perf data called with wrong data state "+this.dataState)}catch(e){t="PerformanceLogger error writing RUMOne data: "+e,"undefined"!=typeof console&&Boolean(console)&&console.error(t)}finally{this.isRunning()||(this._unhookUnloadEvent(),this._apiTracker.undoInstrument())}},e.prototype._TTIPolyfillEnabled=function(){return!!(this._settings.TTISettings&&this._settings.TTISettings.TTIPolyfillSettings&&this._settings.TTISettings.TTIPolyfillSettings.enabled)},e.prototype._TTIMeasurementEnabled=function(){return this._TTIPolyfillEnabled()},e.prototype.getReadableDataState=function(e){for(var t in _)if(e===Number(_[t]))return t;return"NaN"},e.prototype.writeControlDataToRUMOne=function(){if(this.controls&&this.controls.length){var e=this.controls.slice(0).filter((function(e){return!!e.data&&!!e.data.renderTime&&!e.ignoreForEUPL}));e.sort((function(e,t){return t.data.renderTime-e.data.renderTime}));for(var t=0;t<10&&t<e.length;t++)this._logRUMOneData("Control"+(t+1)+"Id",e[t].controlId),this._logRUMOneData("Control"+(t+1)+"RenderTime",e[t].data.renderTime);var n={};this.controls.slice(0).filter((function(e){return!!e.data&&!!e.data.renderTime&&!!e.ignoreForEUPL})).forEach((function(e){n[e.controlId]={data:e.data.renderTime,needFlatten:e.data.needFlatten}})),Object.keys(n).length>0&&this.writeEUPLBreakdown(JSON.stringify(n),!0)}},e.prototype.processControlRenderTime=function(){for(var e=0,t=this.controls;e<t.length;e++){var n=t[e];n.data&&!n.data.renderTime&&n.data.renderTimeRequiredDataChecker(this,n.data)&&(n.data.renderTime=n.data.renderTimeCalculator(this,n.data))}},e.prototype.readyToComputeEUPL=function(){for(var e=this.controls.filter((function(e){return!e.ignoreForEUPL})),t=e.length>0,n=0,r=e;n<r.length;n++){var a=r[n];if(!a.data||!a.data.renderTime){t=!1;break}}return t},e.prototype.setEUPL=function(){if(!this.isCollected("EUPL")){for(var e=0,t=0,n=this.controls;t<n.length;t++){var r=n[t];!r.ignoreForEUPL&&r.data&&r.data.renderTime&&e<r.data.renderTime&&(e=r.data.renderTime)}this._rumoneData.EUPL=e,"function"==typeof this._EUPLComputedHandler&&this._EUPLComputedHandler(e)}},e.prototype.setBrowseInfo=function(){this._rumoneData.Browser=this._platformDetection.browserName+this._platformDetection.browserMajor,this._rumoneData.BrowserIsMobile=this._platformDetection.isMobile},e.prototype._collectMemoryData=function(){this.isCollected("UsedJSHeapSize")||"undefined"==typeof performance||void 0===performance.memory||(this._rumoneData.UsedJSHeapSize=performance.memory.usedJSHeapSize,this._rumoneData.TotalJSHeapSize=performance.memory.totalJSHeapSize)},e.prototype._collectPageServerData=function(){this.addServerMetrics({cpuDuration:window.g_cpuDuration,duration:window.g_duration,iisLatency:window.g_iisLatency,queryCount:window.g_queryCount,queryDuration:window.g_queryDuration,spPageContextDuration:window.g_pageContextDuration,deferred_cpuDuration:window.g_deferred_cpuDuration,deferred_duration:window.g_deferred_duration,deferred_iisLatency:window.g_deferred_iisLatency,deferred_queryCount:window.g_deferred_queryCount,deferred_queryDuration:window.g_deferred_queryDuration})},e.prototype.setAPIDataToRUMOne=function(){for(var e=0,t=0,n=0;n<this.apis.length;n++){var r=this.apis[n];r&&(e++,t+=r.duration,r.origin||(r.origin=new w.default(r.url).getHost()),r.hostType=new w.default(window.location.href).getHost()===r.origin?C.own:C.cors)}this._rumoneData.APICallCount=e,this._rumoneData.APICallDurationSum=t,this._rumoneData.APICalls=JSON.stringify(this.apis)},e.prototype.setReferrer=function(){this._rumoneData.Referrer=""},e.prototype._setAppInfo=function(){if(!this._rumoneData.AppInfo){var e=window._spModuleLink;if(e){var t=e.buildNumber,n=e.manifestName,r=e.scenarioName,a=JSON.stringify({buildNumber:t,manifestName:n,scenarioName:r});this._rumoneData.AppInfo=a}}},e.prototype.getW3cTimingName=function(e){return"secureConnectionStart"!==e?"W3c"+e.charAt(0).toUpperCase()+e.slice(1):"W3cSecureConnectStart"},e.prototype._writeBreakdown=function(e,t,n){if(t)try{var r=JSON.parse(t);for(var a in r)r.hasOwnProperty(a)&&this._addBreakdown(e,a,r[a],n)}catch(e){this.logMessageInConsole("Failed to write EUPL breakdown data:"+e.toString())}},e.prototype._addBreakdown=function(e,t,n,r){if(t&&!k(n)){if(k(e[t])||r){var a=this._isBreakdownValue(n)?n.data:n;e[t]=a}this._isBreakdownValue(n)&&n.needFlatten&&(!this.isCollected(t)||r)&&this._logRUMOneData(t,n.data)}},e.prototype._readBreakdown=function(e,t){return t?e[t]:e},e.rumOneLogger=void 0,e.Loggers={},e._markers={},e}();t.default=I},1065:function(e,t,n){"use strict";n.r(t),n.d(t,"followCommand",(function(){return d}));var r=n(0),a=n(1),i=n(546),o=n(78),s=n(3),c=Object(s.getNextId)("follow"),l=function(e){return e?o.default.RemoveFromSaved:o.default.SaveForLater},d={key:c,automationId:"followCommand",action:a.createElement(i.e,null),name:o.default.SaveForLater,postProcess:function(e){return Object(r.__assign)(Object(r.__assign)({},e),{name:e.iconOnly?void 0:l(e.actionState.isToggled)})},commandBarButtonAs:function(e){var t=e.defaultRender,n=e.actionState&&e.actionState.isToggled,i="boolean"==typeof n&&l(n)||void 0;return t?a.createElement(t,Object(r.__assign)({},e,{iconProps:{iconName:n?"SingleBookmarkSolid":"SingleBookmark"},name:e.iconOnly?void 0:i,text:e.iconOnly?void 0:i,title:i,ariaLabel:i})):null}}},1113:function(e,t,n){"use strict";n.d(t,"t",(function(){return a})),n.d(t,"n",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"i",(function(){return s})),n.d(t,"r",(function(){return c})),n.d(t,"e",(function(){return l}));var r=n(16);Object(r.e)([{rawString:".commandLink_3eae80fd{height:32px;line-height:32px}html[dir='ltr'] .commandLink_3eae80fd{margin-right:15px}html[dir='rtl'] .commandLink_3eae80fd{margin-left:15px}.commandLink_3eae80fd i{color:"},{theme:"primaryText",defaultValue:"#333333"},{rawString:"}label.link_3eae80fd,button.link_3eae80fd{display:inline;line-height:32px;height:32px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}html[dir='ltr'] label.link_3eae80fd,html[dir='ltr'] button.link_3eae80fd{margin-left:-7px}html[dir='rtl'] label.link_3eae80fd,html[dir='rtl'] button.link_3eae80fd{margin-right:-7px}html[dir='ltr'] label.link_3eae80fd,html[dir='ltr'] button.link_3eae80fd{margin-right:15px}html[dir='rtl'] label.link_3eae80fd,html[dir='rtl'] button.link_3eae80fd{margin-left:15px}.pageUsageChartContainer_3eae80fd>.ms-AnalyticsChart{margin-top:0}.root_3eae80fd{font-size:"},{theme:"mediumFontSize",defaultValue:"14px"},{rawString:";font-weight:400;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:12px}.socialBarList_3eae80fd{width:288px}.socialBarPanel_3eae80fd{top:50px}.socialBarPanelContent_3eae80fd{overflow-x:hidden;overflow-y:auto}.spSocialPanelPivotContent_3eae80fd{padding-top:15px}.socialBarPanelHeader_3eae80fd{-ms-flex-negative:0;flex-shrink:0;padding:0 25px}.socialBarPanelHeader_3eae80fd .socialBarPanelHeaderText_3eae80fd{font-size:"},{theme:"xLargeFontSize",defaultValue:"20px"},{rawString:";font-weight:300;line-height:48px;margin:0}.socialBarPanelPersona_3eae80fd{font-size:14px;padding:4px 0}.socialBarPanelPersonaDescription_3eae80fd{font-size:14px;padding:8px 0}.viewsIcon_3eae80fd{cursor:default;font-size:16px;height:32px;line-height:28px;text-align:center;width:32px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;vertical-align:middle}html[dir='ltr'] .viewsIcon_3eae80fd{margin-right:8px}html[dir='rtl'] .viewsIcon_3eae80fd{margin-left:8px}.analyticsStatsLink_3eae80fd{min-width:50px;font-size:14px;padding:0 8px 0 0}.analyticsStatsLink_3eae80fd .ms-Link{font-size:"},{theme:"smallFontSize",defaultValue:"12px"},{rawString:";font-weight:400;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.analyticsStatsLink_3eae80fd .ms-ActivityItem-activityTypeIcon{margin-top:0}html[dir='ltr'] .analyticsStatsLink_3eae80fd .ms-ActivityItem-activityTypeIcon{padding-right:5px}html[dir='rtl'] .analyticsStatsLink_3eae80fd .ms-ActivityItem-activityTypeIcon{padding-left:5px}.analyticsStatsLink_3eae80fd .ms-ActivityItem-activityContent{-ms-flex-preferred-size:auto;flex-basis:auto;font-weight:400}html[dir='ltr'] .analyticsStatsLink_3eae80fd .ms-ActivityItem-activityContent{padding-left:0}html[dir='rtl'] .analyticsStatsLink_3eae80fd .ms-ActivityItem-activityContent{padding-right:0}.analyticsStatsLink_3eae80fd :hover{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}\n"}]);var a="socialBarList_3eae80fd",i="socialBarPanel_3eae80fd",o="socialBarPanelContent_3eae80fd",s="socialBarPanelPersona_3eae80fd",c="socialBarPanelPersonaDescription_3eae80fd",l="analyticsStatsLink_3eae80fd"},1114:function(e,t,n){e.exports=n(428)},1115:function(e,t,n){e.exports=n(285)},1287:function(e,t,n){e.exports=n(1014)},1369:function(e,t,n){e.exports=n(369)},1371:function(e,t,n){e.exports=n(1434)},1372:function(e,t,n){!function(){function t(e,t){var n,r,a,i,o,s,c,l;for(n=3&e.length,r=e.length-n,a=t,o=3432918353,s=461845907,l=0;l<r;)c=255&e.charCodeAt(l)|(255&e.charCodeAt(++l))<<8|(255&e.charCodeAt(++l))<<16|(255&e.charCodeAt(++l))<<24,++l,a=27492+(65535&(i=5*(65535&(a=(a^=c=(65535&(c=(c=(65535&c)*o+(((c>>>16)*o&65535)<<16)&4294967295)<<15|c>>>17))*s+(((c>>>16)*s&65535)<<16)&4294967295)<<13|a>>>19))+((5*(a>>>16)&65535)<<16)&4294967295))+((58964+(i>>>16)&65535)<<16);switch(c=0,n){case 3:c^=(255&e.charCodeAt(l+2))<<16;case 2:c^=(255&e.charCodeAt(l+1))<<8;case 1:a^=c=(65535&(c=(c=(65535&(c^=255&e.charCodeAt(l)))*o+(((c>>>16)*o&65535)<<16)&4294967295)<<15|c>>>17))*s+(((c>>>16)*s&65535)<<16)&4294967295}return a^=e.length,a=2246822507*(65535&(a^=a>>>16))+((2246822507*(a>>>16)&65535)<<16)&4294967295,a=3266489909*(65535&(a^=a>>>13))+((3266489909*(a>>>16)&65535)<<16)&4294967295,(a^=a>>>16)>>>0}var n=t;n.v2=function(e,t){for(var n,r=e.length,a=t^r,i=0;r>=4;)n=1540483477*(65535&(n=255&e.charCodeAt(i)|(255&e.charCodeAt(++i))<<8|(255&e.charCodeAt(++i))<<16|(255&e.charCodeAt(++i))<<24))+((1540483477*(n>>>16)&65535)<<16),a=1540483477*(65535&a)+((1540483477*(a>>>16)&65535)<<16)^(n=1540483477*(65535&(n^=n>>>24))+((1540483477*(n>>>16)&65535)<<16)),r-=4,++i;switch(r){case 3:a^=(255&e.charCodeAt(i+2))<<16;case 2:a^=(255&e.charCodeAt(i+1))<<8;case 1:a=1540483477*(65535&(a^=255&e.charCodeAt(i)))+((1540483477*(a>>>16)&65535)<<16)}return a=1540483477*(65535&(a^=a>>>13))+((1540483477*(a>>>16)&65535)<<16),(a^=a>>>15)>>>0},n.v3=t,e.exports=n}()},1373:function(e,t,n){e.exports=n(595)},1374:function(e,t,n){e.exports=n(1375)},1375:function(e,t,n){"use strict";n.r(t),n.d(t,"isCommentLinkEnabled",(function(){return s})),n.d(t,"isLikePanelEnabled",(function(){return c}));var r=n(165),a=n.n(r),i={ODB:1305},o={ODB:1306};function s(){return a.a.isFeatureEnabled(i)}function c(){return a.a.isFeatureEnabled(o)}},1376:function(e,t,n){e.exports=n(1446)},1377:function(e,t,n){e.exports=n(1428)},1378:function(e,t,n){e.exports=n(929)},1379:function(e,t,n){e.exports=n(976)},1380:function(e,t,n){e.exports=n(1424)},1381:function(e,t,n){e.exports=n(1382)},1382:function(e,t,n){"use strict";n.r(t),n.d(t,"CryptoErrors",(function(){return r}));var r={secretError:"wrong secret or signature.",unsupportedError:"Crypto operations not supported.",deserializationError:"Data serialization/deserialization error."}},1383:function(e,t,n){e.exports=n(671)},1384:function(e,t,n){e.exports=n(1065)},1385:function(e,t,n){e.exports=n(1386)},1386:function(e,t,n){"use strict";n.r(t),n.d(t,"ActionCommandBar",(function(){return p}));var r=n(0),a=n(1),i=n(1490),o=n(511),s=n(677),c=n(936),l=n(78),d=n(421),u=[];var p=Object(o.connectToCommandSets)((function(e){return{main:e.commands,overflow:e.overflowCommands,far:e.farCommands,shortcut:e.shortcutCommands}}),(function(e,t){var n=t.items,r=void 0===n?u:n,a=t.overflowItems,i=void 0===a?u:a,o=t.farItems,c=void 0===o?u:o,d=t.shortcutItems,p=void 0===d?u:d;return{items:Object(s.concat)(r,e.main),overflowItems:Object(s.concat)(i,e.overflow),farItems:Object(s.concat)(c,e.far),shortcutItems:Object(s.concat)(p,e.shortcut),ariaLabel:l.default.CommandBarAriaLabel}}))((function(e){var t=e.items,n=void 0===t?u:t,o=e.farItems,s=void 0===o?u:o,p=e.overflowItems,m=void 0===p?u:p,f=e.shortcutItems,h=void 0===f?u:f,g=e.commandBarAs,y=e.overflowButtonProps,v=void 0===y?{}:y,_=g?Object(d.e)(g,i.e):i.e,C=function(e){return e.filter((function(e){return e&&(!!e.shortcutProps||!!e.keytipProps)}))}(Object(r.__spreadArrays)(n,s,m,h));return a.createElement(a.Fragment,null,a.createElement(_,Object(r.__assign)({overflowButtonProps:Object(r.__assign)({ariaLabel:l.default.OverflowCommandTooltip,title:l.default.OverflowCommandTooltip},v)},e)),C&&C.length>0&&C.map((function(e){var t=e.shortcutProps||e.keytipProps;return t&&t.keySequences.length>0&&e.onClick?a.createElement(c.KeyboardShortcut,{key:e.key,keySequences:t.keySequences,description:t.content,onExecute:e.onClick}):null})))}));p.displayName="ActionCommandBar"},1387:function(e,t,n){e.exports=n(80)},1424:function(e,t,n){"use strict";n.r(t),n.d(t,"CacheUpdateTaskManager",(function(){return s})),n.d(t,"PersistentCache",(function(){return b})),n.d(t,"PersistentCacheType",(function(){return v}));var r,a=n(0),i="undefined"==typeof window?self:window,o=0,s=function(){function e(){this._queue={}}return e.prototype.enqueue=function(e,t){var n=this._queue[e]=this._queue[e]||[],r=!0,a=[];n.length>0&&(n[0].schedule?(a=n.slice(1),this._queue[e]=[n[0]],r=!1):(a=this._queue[e],this._queue[e]=[]));var i=this._createUpateTask(e,t);return a.length>0&&(i.signal=a[0].signal),this._queue[e].push(i),r&&this._scheduleTask(e),i},e.prototype._createUpateTask=function(e,t){var n=this,r={};r.promise=new Promise((function(e,t){r.resolve=e,r.reject=t}));var i={execute:function(){return Object(a.__awaiter)(n,void 0,void 0,(function(){var e;return Object(a.__generator)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,3,4]),[4,t()];case 1:return n.sent(),[3,4];case 2:return e=n.sent(),i.error=e,[3,4];case 3:return this._completeTask(i),[7];case 4:return[2]}}))}))},schedule:0,id:o++,key:e,signal:r};return i},e.prototype._scheduleTask=function(e){var t=this._queue[e];if(t&&t.length>0){var n=t[0];n.schedule=i.setTimeout(n.execute,5)}},e.prototype._completeTask=function(e){var t=e.id,n=e.key,r=this._queue[n],a=r[0],i=r.slice(1);if(a.id!==t)throw new Error("this should not happen, currently running task must be the top of the queue");this._queue[n]=i,this._scheduleTask(n),e.error?e.signal.reject(e.error):e.signal.resolve()},e}(),c=n(500),l=n(309),d=n(34);!function(e){e.success="success",e.error="error"}(r||(r={}));var u=(new c.PlatformDetection).isFirefox,p="indexedDB is not supported",m=function(){function e(e){if(!("indexedDB"in i)||!i.indexedDB)throw new Error(p);this._logger=e,this._openIndexedDB()}return e.prototype.freeSpace=function(e,t){return Object(a.__awaiter)(this,void 0,void 0,(function(){var n,r=this;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return this._db?[3,2]:(n=this,[4,this._openIndexedDB()]);case 1:n._db=a.sent(),a.label=2;case 2:return[2,new Promise((function(n,a){var i=r._db.transaction(["ODSP_DB_TABLE"],"readwrite").objectStore("ODSP_DB_TABLE").index("app_lastRead").openCursor();i.onsuccess=function(r){var a=i.result;a?(a.value.app===e&&t>0&&(t-=a.value.size,a.delete()),t>0?a.continue():n()):n()},i.onerror=function(e){r._errorHandling(e,a)}}))]}}))}))},e.prototype.read=function(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){return Object(a.__generator)(this,(function(t){return[2,this._readInternal("ODSP_DB_TABLE",(function(t){return t.get(e)}))]}))}))},e.prototype.rangeQuery=function(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){var t,n,r=this;return Object(a.__generator)(this,(function(a){return t={},n=Promise.resolve(),this._db||(n=this._openIndexedDB().then((function(e){r._db=e}))),n.then((function(){var n=r._db.transaction(["ODSP_DB_TABLE"],"readonly").objectStore("ODSP_DB_TABLE"),a=[],i=e.index,o=e.range,s=e.direction,c=e.count,l=n.index(i).openKeyCursor(o,s);l.onerror=function(e){r._errorHandling(e,t.reject)},l.onsuccess=function(e){var n=e.target.result;n?(a.push(n.primaryKey),a.length>=c?t.resolve(a):n.continue()):t.resolve(a)}})),[2,new Promise((function(e,n){t.resolve=e,t.reject=n}))]}))}))},e.prototype.write=function(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){var t;return Object(a.__generator)(this,(function(n){return t=e.key,void 0!==e.data?[2,this._writeInternal({tableName:"ODSP_DB_TABLE",key:t,row:Object(a.__assign)(Object(a.__assign)({},e),{lastModified:Date.now()})})]:void 0!==e.parentKey?[2,this._deleteDataRows(e.parentKey)]:[2,this._writeInternal({tableName:"ODSP_DB_TABLE",key:t,row:void 0})]}))}))},e.prototype.statistics=function(){return Object(a.__awaiter)(this,void 0,void 0,(function(){var e,t;return Object(a.__generator)(this,(function(n){switch(n.label){case 0:return this._dbMetaData?[3,2]:[4,this._readAndSetMetadataDB()];case 1:e=n.sent(),this._dbMetaData=e,n.label=2;case 2:return[4,this._iterate("ODSP_DB_TABLE",(function(e){return e.size}))];case 3:return t=n.sent(),[2,{metaData:this._dbMetaData,count:t.length,totalBytes:t.reduce((function(e,t){return e+t}),0)}]}}))}))},e.prototype._openIndexedDB=function(){return Object(a.__awaiter)(this,void 0,void 0,(function(){var e=this;return Object(a.__generator)(this,(function(t){return[2,new Promise((function(t,n){e._db&&t(e._db);var r=u?indexedDB.open("ODSP_DB",{version:4,storage:"temporary"}):indexedDB.open("ODSP_DB",4);r.onerror=function(t){e._errorHandling(t,n)},r.onsuccess=function(n){e._db=r.result,t(e._db)},r.onupgradeneeded=function(t){var a=t.target.result;a.onerror=function(t){e._errorHandling(t,n)};var i=t.oldVersion;e._handleDBUpgrade(r,a,i)}}))]}))}))},e.prototype._handleDBUpgrade=function(e,t,n){var r;n<1&&((r=t.createObjectStore("ODSP_DB_TABLE",{keyPath:"key"})).createIndex("lastModified","lastModified",{unique:!1}),r.createIndex("reads","reads",{unique:!1}),t.createObjectStore("ODSP_DB_METADATA_TABLE",{keyPath:"key"})),n<2&&((r=r||e.transaction.objectStore("ODSP_DB_TABLE")).createIndex("app","app",{unique:!1}),r.createIndex("lastRead","lastRead",{unique:!1}),r.createIndex("app_lastRead",["app","lastRead"],{unique:!1})),n<3&&((r=r||e.transaction.objectStore("ODSP_DB_TABLE")).createIndex("app_lastModified",["app","lastModified"],{unique:!1}),r.createIndex("app_reads",["app","reads"],{unique:!1})),n<4&&((r=r||e.transaction.objectStore("ODSP_DB_TABLE")).createIndex("parentKey","parentKey",{unique:!1}),r.createIndex("parentKey_app",["parentKey","app"],{unique:!1}),r.createIndex("parentKey_app_lastModified",["parentKey","app","lastModified"],{unique:!1}),r.createIndex("parentKey_app_lastRead",["parentKey","app","lastRead"],{unique:!1}),r.createIndex("parentKey_app_reads",["parentKey","app","reads"],{unique:!1}))},e.prototype._readAndSetMetadataDB=function(){var e=this;return this._readInternal("ODSP_DB_METADATA_TABLE",(function(e){return e.get("database_metadata")})).then((function(t){if(t)return t.data;var n={id:l.generate(),created:Date.now(),cacheType:1};return e._writeInternal({tableName:"ODSP_DB_METADATA_TABLE",key:"database_metadata",row:{key:"database_metadata",data:n}}).then((function(){return n}))}))},e.prototype._readInternal=function(e,t){return Object(a.__awaiter)(this,void 0,void 0,(function(){var n,r=this;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return this._db?[3,2]:(n=this,[4,this._openIndexedDB()]);case 1:n._db=a.sent(),a.label=2;case 2:return[2,new Promise((function(n,a){var i=r._logger({name:"PersistentCacheIDB.readInternal"}),o=Date.now(),s=r._db.transaction([e],"readonly").objectStore(e),c=t(s);c.onsuccess=function(e){i({resultType:d.ResultTypeEnum.Success,extraData:{io:Math.round(Date.now()-o)}}),n(c.result)},c.onerror=function(e){i({resultType:d.ResultTypeEnum.Failure,extraData:{io:Math.round(Date.now()-o)}}),r._errorHandling(e,a)}}))]}}))}))},e.prototype._iterate=function(e,t){return Object(a.__awaiter)(this,void 0,void 0,(function(){var n,r,i=this;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return this._db?[3,2]:(n=this,[4,this._openIndexedDB()]);case 1:n._db=a.sent(),a.label=2;case 2:return r=[],[2,new Promise((function(n,a){var o=i._db.transaction([e],"readonly").objectStore(e).openCursor();o.onsuccess=function(e){var a=o.result;a?(r.push(t(a.value)),a.continue()):n(r)},o.onerror=function(e){i._errorHandling(e,a)}}))]}}))}))},e.prototype._writeInternal=function(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){var t,n,r,i,o=this;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return t=e.tableName,n=e.key,r=e.row,this._db?[3,2]:(i=this,[4,this._openIndexedDB()]);case 1:i._db=a.sent(),a.label=2;case 2:return[2,new Promise((function(e,a){try{var i=o._db.transaction([t],"readwrite"),s=i.objectStore(t);i.oncomplete=function(){},i.onerror=function(e){o._errorHandling(e,a)};var c=r?s.put(r):s.delete(n);c.onsuccess=function(t){e()},c.onerror=function(e){o._errorHandling(e,a)}}catch(e){throw e}}))]}}))}))},e.prototype._deleteDataRows=function(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){var t,n=this;return Object(a.__generator)(this,(function(r){return t=e.slice(0,e.length-1)+String.fromCharCode(e.charCodeAt(e.length-1)+1),[2,this.rangeQuery({index:"parentKey",range:IDBKeyRange.bound(e,t,!1,!0),direction:"next"}).then((function(e){return Promise.all(e.map((function(e){return n._writeInternal({tableName:"ODSP_DB_TABLE",key:e,row:void 0})})))})).then((function(){}))]}))}))},e.prototype._errorHandling=function(e,t){if(e.type===r.error){var n=e.target.error;t({name:n.name,message:n.message,code:n.code})}},e}(),f="localStorage is not supported",h=function(){function e(){try{if("localStorage"in i&&i.localStorage&&(this._localStorage=i.localStorage,!this._localStorage.getItem("PersistentCache_metadata"))){var e={id:l.generate(),created:Date.now(),cacheType:0};this._localStorage.setItem("PersistentCache_metadata",JSON.stringify(e))}}catch(e){}if(!this._localStorage)throw new Error(f)}return e.prototype.freeSpace=function(e,t){throw new Error("Method not implemented.")},e.prototype.read=function(e){return JSON.parse(this._localStorage.getItem(this._cacheKey(e)))},e.prototype.write=function(e){var t=e.key;if(void 0!==e.data){var n=Object(a.__assign)(Object(a.__assign)({},e),{lastModified:Date.now()});this._localStorage.setItem(this._cacheKey(t),JSON.stringify(n))}else this._localStorage.removeItem(t)},e.prototype.statistics=function(){var e=[];for(var t in this._localStorage)if(0===t.indexOf("PersistentCache")){var n=this._localStorage.getItem(t);e.push(n?n.length:0)}return{metaData:JSON.parse(this._localStorage.getItem("PersistentCache_metadata")),count:e.length,totalBytes:e.reduce((function(e,t){return e+t}),0)}},e.prototype.rangeQuery=function(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){return Object(a.__generator)(this,(function(e){return[2,void 0]}))}))},e.prototype._cacheKey=function(e){return"PersistentCache_"+e},e}(),g=n(1381);function y(){return i.performance&&performance.now?Math.round(performance.now()):Date.now()}var v,_=n(316),C=1,b=function(){function e(e){if(this._config=e,this._config.cacheType=this._config.cacheType||C,this._cacheSecret=this._config.secret,this._dataIsEncrypted=!!this._cacheSecret,this._crypto=this._config.crypto,this._dataIsEncrypted&&!this._crypto)throw new Error("When data needs encryption, crypto implementing ICrypto has to be provided when initiating PersistentCache.");this._cacheType=this._config.cacheType,this._app=e.app,this._cacheUpdateTaskManager=new s,this._qos=this._config.telemetry&&this._config.telemetry.qos,this._engagement=this._config.telemetry&&this._config.telemetry.engagement,this._initLocalStorage(this._cacheType)}return Object.defineProperty(e.prototype,"configuration",{get:function(){return this._config},enumerable:!0,configurable:!0}),e.prototype.read=function(t){return Object(a.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o,s,c,l,d,u,p,m,f,h,v,C,b,w,S,x,D;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:n=this._logQos({name:"PersistentCache.read"}),s=y(),c=Date.now(),a.label=1;case 1:return a.trys.push([1,12,,13]),d=this._getCacheKey(t),u=!1,p={lastModified:NaN,lastRead:c,reads:1},m=void 0,d?(f=y(),[4,this._storage.read(d)]):[3,11];case 2:return l=a.sent(),o=Math.round(y()-f),l?(h=l.data,p={lastModified:l.lastModified,lastRead:c,reads:l.reads+1},(r=e._buffer[d])&&r.cacheStats.lastModified===l.lastModified?(r.app=l.app||this._app,r.key={original:t,encoded:l.key||d},r.cacheStats.lastRead=c,r.cacheStats.reads++,r.performance={total:Math.round(y()-s)},[3,11]):[3,3]):[3,11];case 3:if(r=void 0,void 0===h)return[3,11];if(!this._dataIsEncrypted)return[3,10];v=h,C=this._cacheSecret,b=C.CurrentKey.Key,w=C.PreviousKey.Key,S=y(),a.label=4;case 4:return a.trys.push([4,6,,9]),[4,this._crypto.decrypt({encryptedData:v,encryptionSecret:b})];case 5:return m=a.sent(),[3,9];case 6:return(x=a.sent())&&x.message&&x.message.indexOf(g.CryptoErrors.secretError)>=0?[4,this._crypto.decrypt({encryptedData:v,encryptionSecret:w})]:[3,8];case 7:m=a.sent(),u=void 0!==m,n({resultType:_.ResultTypeEnum.ExpectedFailure,error:x.message,extraData:{cacheResult:"hit"}}),a.label=8;case 8:return[3,9];case 9:return i=Math.round(y()-S),[3,11];case 10:m=h,a.label=11;case 11:return r=r||{key:{original:t,encoded:l&&l.key||d},app:l&&l.app||this._app,data:m,cacheStats:p,cacheType:this._cacheType,performance:{crypto:i,io:o,total:Math.round(y()-s)}},e._buffer[d]=r,u&&this.update(t,m),this._logEngagement({name:"PersistentCache."+(void 0!==r.data?"hit":"miss"),isIntentional:!0}),[3,13];case 12:throw D=a.sent(),n({resultType:_.ResultTypeEnum.Failure,error:D.message?D.message:D.toString(),extraData:{cacheResult:"miss"}}),D;case 13:return n({resultType:_.ResultTypeEnum.Success,extraData:{cacheResult:void 0!==r.data?"hit":"miss"}}),[2,Promise.resolve(r)]}}))}))},e.prototype.rangeQuery=function(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){var t,n,r,i,o,s,c,l=this;return Object(a.__generator)(this,(function(a){if(1!==this._cacheType)throw new Error("Only indexedDB supports range query, your storage does not support!");t=this._logQos({name:"PersistentCache.rangeQuery"}),n=0,r=y(),i=Date.now(),s={lastModified:NaN,lastRead:i,reads:1};try{c=y(),o=this._storage.rangeQuery(e).then((function(e){return n=Math.round(y()-c),{key:void 0,app:void 0,data:e.map((function(e){return{original:l._getOriginalKeyFromCacheKey(e),encoded:e}})),cacheStats:s,cacheType:l._cacheType,performance:{io:n,total:Math.round(y()-r)}}}))}catch(e){throw t({resultType:_.ResultTypeEnum.Failure,error:e.message?e.message:e.toString()}),e}return t({resultType:_.ResultTypeEnum.Success}),[2,o||Promise.resolve({key:void 0,app:void 0,data:[],cacheStats:s,cacheType:this._cacheType,performance:{io:n,total:Math.round(y()-r)}})]}))}))},e.prototype.update=function(e,t){return Object(a.__awaiter)(this,void 0,void 0,(function(){var n,r=this;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return n=this._getCacheKey(e),[4,this._cacheUpdateTaskManager.enqueue(n,(function(){return r._doCacheUpdate(e,t)})).signal.promise];case 1:return a.sent(),this._logCacheStats(),[2]}}))}))},e.prototype.remove=function(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){return Object(a.__generator)(this,(function(t){return[2,this.update(e,void 0)]}))}))},e.prototype.freeSpace=function(e,t){return Object(a.__awaiter)(this,void 0,void 0,(function(){return Object(a.__generator)(this,(function(n){return[2,this._storage.freeSpace(e,t)]}))}))},e.prototype.readAndUpdate=function(e,t){return Object(a.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o,s,c,l=this;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:n=y(),r=Date.now(),i=this._logQos({name:"PersistentCache.readAndUpdate"}),o=t().then((function(t){var a={app:l._app,key:{original:e,encoded:l._getCacheKey(e)},data:t,cacheType:2,cacheStats:{lastModified:void 0,lastRead:r,reads:1},performance:{total:Math.round(y()-n)}};return l.update(e,t),a})),a.label=1;case 1:a.trys.push([1,8,,9]),a.label=2;case 2:return a.trys.push([2,4,,5]),[4,Promise.race([this.read(e),o])];case 3:return s=a.sent(),[3,5];case 4:return a.sent(),[3,5];case 5:return!s||2!==s.cacheType&&void 0===s.data?[4,o]:[3,7];case 6:s=a.sent(),a.label=7;case 7:return[3,9];case 8:throw c=a.sent(),i({resultType:_.ResultTypeEnum.Failure,error:c.message?c.message:c.toString()}),c;case 9:return i({resultType:_.ResultTypeEnum.Success}),[2,s]}}))}))},e.prototype._initLocalStorage=function(e){switch(e){case 0:this._storage=new h;break;case 1:default:try{this._storage=new m(this._logQos.bind(this))}catch(e){e.message===p&&(this._storage=new h,this._cacheType=0)}}},e.prototype._getCacheKey=function(e){var t=encodeURIComponent(e.key+(e.user?"_____"+e.user:""));return"_odspcache_"+(this._dataIsEncrypted?btoa(t):t)},e.prototype._getOriginalKeyFromCacheKey=function(e){var t=e.replace("_odspcache_",""),n=this._dataIsEncrypted?atob(t):t,r=decodeURIComponent(n);if(r.indexOf("_____")>=0){var a=r.split("_____");return{key:a[0],user:a[1]}}return{key:r}},e.prototype._doCacheUpdate=function(t,n){return Object(a.__awaiter)(this,void 0,void 0,(function(){var r,i,o,s,c,l,d;return Object(a.__generator)(this,(function(u){switch(u.label){case 0:r=this._logQos({name:"PersistentCache.update"}),u.label=1;case 1:return u.trys.push([1,9,,10]),i=this._getCacheKey(t),void 0===n?[3,6]:((o=e._buffer[i]=Object(a.__assign)(Object(a.__assign)({},e._buffer[i]),{data:n,cacheType:this._cacheType})).cacheStats||(o.cacheStats={lastModified:NaN,lastRead:y(),reads:1}),s=n,c=NaN,this._dataIsEncrypted?(l=this._cacheSecret.CurrentKey.Key,[4,this._crypto.encrypt({encryptionSecret:l,data:n,doSerialize:0===this._cacheType})]):[3,3]);case 2:return s=u.sent(),c=s.cipherText?s.cipherText.byteLength:0,[3,4];case 3:try{c="string"==typeof n?n.length:JSON.stringify(n).length}catch(e){}u.label=4;case 4:return[4,this._storage.write({app:this._app,key:i,data:s,lastRead:o.cacheStats.lastRead,parentKey:t.parentKey,reads:o.cacheStats.reads,size:c})];case 5:return u.sent(),[3,8];case 6:return delete e._buffer[i],[4,this._storage.write({key:i,app:void 0,data:void 0,lastRead:void 0,parentKey:t.parentKey,reads:void 0,size:void 0})];case 7:u.sent(),u.label=8;case 8:return[3,10];case 9:throw d=u.sent(),r({resultType:_.ResultTypeEnum.Failure,error:d.message?d.message:d.toString()}),d;case 10:return r({resultType:_.ResultTypeEnum.Success}),[2]}}))}))},e.prototype._logCacheStats=function(){return Object(a.__awaiter)(this,void 0,void 0,(function(){var e=this;return Object(a.__generator)(this,(function(t){return this._logStatsTimer||(this._logStatsTimer=setTimeout((function(){return Object(a.__awaiter)(e,void 0,void 0,(function(){var e;return Object(a.__generator)(this,(function(t){switch(t.label){case 0:return[4,this._storage.statistics()];case 1:return e=t.sent(),this._logEngagement({name:"PersistentCache.Statistics",isIntentional:!0,extraData:Object(a.__assign)({},e)}),[2]}}))}))}),3e4)),[2]}))}))},e.prototype._logEngagement=function(e){this._engagement&&this._engagement.logData(e)},e.prototype._logQos=function(e){if(this._qos){var t=this._app;e.extraData||(e.extraData={}),e.extraData.alias=e.extraData.alias||t;var n=new this._qos(e);return function(e){e.extraData||(e.extraData={}),e.extraData.alias=e.extraData.alias||t,n.end(e)}}return function(e){}},e._buffer={},e}();!function(e){e[e.localStorage=0]="localStorage",e[e.indexedDB=1]="indexedDB",e[e.none=2]="none"}(v||(v={}))},1428:function(e,t,n){"use strict";n.r(t),n.d(t,"PersonaInitialsColor",(function(){return f})),n.d(t,"COLOR_SERVICE_POSSIBLE_COLORS",(function(){return S})),n.d(t,"AcronymAndColorDataSource",(function(){return x}));var r,a=n(0),i=n(1001),o=n(1010),s=n(106),c=n.n(s),l=n(231),d=n(1380),u=n(183);!function(e){e[e.useCacheAndUpdateInTheBackground=0]="useCacheAndUpdateInTheBackground",e[e.useCacheIfNotExpired=1]="useCacheIfNotExpired",e[e.onlyCache=2]="onlyCache",e[e.bypassCache=3]="bypassCache"}(r||(r={}));var p=function(){function e(e,t){this._getDataPromises={};var n=e.id,r=e.dataSourceName,i=(t.pageContext||{}).aadUserId;this._id=n,this._userId=i;var o=r||n,s=u.Qos.withData((function(e){return e.name&&o&&!e.name.startsWith(o)?Object(a.__assign)(Object(a.__assign)({},e),{name:o+"."+e.name}):e}));this._cache=new d.PersistentCache({cacheType:1,telemetry:{qos:s}})}return e.prototype.getDataUtilizingCache=function(e){var t=this,n=e.cacheRequestKey,r=e.cachingStrategy,a=void 0===r?0:r,i=e.cacheTimeoutTime,o=void 0===i?864e5:i,s=e.getData,l=e.returnStatistics,d=void 0!==l&&l,u={key:n,user:this._userId},p=function(){return m()||t._getDataPromises[n]||(t._getDataPromises[n]=s().then((function(e){return delete t._getDataPromises[n],e}))),(m()?s():t._getDataPromises[n]).then((function(e){return t._cache.update(u,e),d?{data:e,cacheStats:{lastModified:NaN,lastRead:Date.now(),reads:1}}:e}))};return c.a.resolve(this._cache.read(u)).then((function(e){var n=e.data,r=e.cacheStats;if(null==n)return p();var i=d?{data:n,cacheStats:r}:n,s=t._isCacheExpired(r.lastModified,o);switch(a){case 2:return i;case 0:return s&&p(),i;case 1:return s?p():i;case 3:default:return p()}})).catch((function(){return p()}))},e.prototype.getRequestKey=function(e,t,n){var r=[];return r.push(e),r.push(t),n&&r.push(n.toString()),r.join(",")},Object.defineProperty(e.prototype,"cacheId",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cacheVersionId",{get:function(){return this._id+"-version"},enumerable:!0,configurable:!0}),e.prototype.flushCache=function(e){var t={key:e,user:this._userId};delete this._cache[e],this._cache.remove(t)},e.prototype._isCacheExpired=function(e,t){return e<=(new Date).valueOf()-t},e}();function m(){return l.Killswitch.isActivated("0b1fbce0-bb51-41da-a09b-8d1686398bb7")}var f,h=n(1379),g=n.n(h),y=n(1378),v=n.n(y),_=function(){function e(e,t){var n=e.id,r=e.cacheType,a=void 0===r?v.a.session:r,i=t.cacheIdPrefix,o=void 0===i?"odsp-ds-":i,s=t.pageContext;this._id=n,this._version=s?s.siteClientTag+"_"+s.userDisplayName:"",this._store=new g.a(o,a),this._storeDefaultCacheType=a,this._initCache()}return e.prototype.getDataUtilizingCache=function(e){var t=this,n=e.cacheRequestKey,r=e.useStale,a=void 0!==r&&r,i=e.bypassCache,o=void 0!==i&&i,s=e.onlyCache,l=void 0!==s&&s,d=e.checkForInvalidation,u=e.setInvalidated,p=e.getData,m=e.cacheTimeoutTime,f=void 0===m?3e5:m,h=e.returnStatistics,g=void 0!==h&&h,y=this._cache,_=y[n],C=function(){return g?{data:_._value,cacheStats:{lastModified:NaN,lastRead:_._fetched,reads:NaN}}:_._value};if(l)return _?c.a.resolve(C()):c.a.resolve(void 0);d=d&&!o&&this._storeDefaultCacheType!==v.a.local;var b=_&&this._isCacheExpired(_,n,d,f);return o||!_||b&&!a?p().then((function(e){var r=(new Date).valueOf();return y[n]={_fetched:r,_value:e},u&&t._store.setValue(n,r-1,v.a.local),t._updateCache(),g?{data:e,cacheStats:{lastModified:NaN,lastRead:r,reads:NaN}}:e})):c.a.resolve(C())},e.prototype.getRequestKey=function(e,t,n){var r=[];return r.push(e),r.push(t),n&&r.push(n.toString()),r.join(",")},e.prototype.isCachedDataInvalidated=function(e){var t=this._cache[e];return this._isCachedDataInvalidated(t,e)},Object.defineProperty(e.prototype,"cacheId",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cacheVersionId",{get:function(){return this._id+"-version"},enumerable:!0,configurable:!0}),e.prototype.flushCache=function(e){e?(delete this._cache[e],this._updateCache()):this._clearCache()},e.prototype._initCache=function(){this._version!==this._store.getValue(this.cacheVersionId,void 0,!1)?(this._clearCache(),this._store.setValue(this.cacheVersionId,this._version,void 0,!1)):this._cache=this._store.getValue(this.cacheId,void 0,!1)||{}},e.prototype._updateCache=function(){this._store.setValue(this.cacheId,this._cache,void 0,!1)},e.prototype._clearCache=function(){this._cache={},this._updateCache()},e.prototype._isCacheExpired=function(e,t,n,r){if(n&&this._isCachedDataInvalidated(e,t))return!0;var a=(new Date).valueOf()-r;return e._fetched<=a},e.prototype._isCachedDataInvalidated=function(e,t){var n=Number(this._store.getValue(t,v.a.local));return!!(e&&n&&e._fetched<n)},e}(),C=function(e){function t(t,n){var r=e.call(this,t,n)||this,a=n.pageContext;return r._legacyRequestCache=new _(t,{pageContext:a}),r._persistentRequestCache=new p(t,{pageContext:a}),r}return Object(a.__extends)(t,e),t.prototype.getDataUtilizingLegacyCache=function(e){var t=this,n=e,r=n.getUrl,i=n.getAdditionalPostData,o=n.cacheRequestKey,s=n.cacheTimeoutTime,c=Object(a.__rest)(n,["getUrl","getAdditionalPostData","cacheRequestKey","cacheTimeoutTime"]);(c=Object(a.__assign)({url:r&&r(),additionalPostData:i&&i(),method:"POST"},c)).url=c.url||r&&r(),"needsRequestDigest"in c||(c.needsRequestDigest=this.needsRequestDigest(c.url)),c.additionalPostData=c.additionalPostData||i&&i(),o=o||this.getRequestKey(c.url,c.method,c.additionalPostData);var l=e.useStale,d=void 0!==l&&l,u=e.bypassCache,p=void 0!==u&&u,m=e.onlyCache,f=void 0!==m&&m,h=e.checkForInvalidation,g=void 0!==h&&h,y=e.setInvalidated,v=void 0!==y&&y;return this._legacyRequestCache.getDataUtilizingCache({cacheRequestKey:o,useStale:d,bypassCache:p,onlyCache:f,checkForInvalidation:g,setInvalidated:v,cacheTimeoutTime:s,getData:function(){return t.dataRequestor.getData(c)}})},t.prototype.getDataUtilizingPersistentCache=function(e){var t=this,n=e,r=n.getUrl,i=n.getAdditionalPostData,o=n.cacheRequestKey,s=n.cacheTimeoutTime,c=n.returnStatistics,l=Object(a.__rest)(n,["getUrl","getAdditionalPostData","cacheRequestKey","cacheTimeoutTime","returnStatistics"]);(l=Object(a.__assign)({url:r&&r(),additionalPostData:i&&i(),method:"POST"},l)).url=l.url||r&&r(),"needsRequestDigest"in l||(l.needsRequestDigest=this.needsRequestDigest(l.url)),l.additionalPostData=l.additionalPostData||i&&i(),o=o||this.getRequestKey(l.url,l.method,l.additionalPostData);var d=e.cachingStrategy;return this._persistentRequestCache.getDataUtilizingCache({cachingStrategy:d,cacheRequestKey:o,cacheTimeoutTime:s,getData:function(){return t.dataRequestor.getData(l)},returnStatistics:c})},t.prototype.isCachedDataInvalidated=function(e){return this._legacyRequestCache.isCachedDataInvalidated&&this._legacyRequestCache.isCachedDataInvalidated(e)},t.prototype.getRequestKey=function(e,t,n){return this._legacyRequestCache.getRequestKey(e,t,n)},Object.defineProperty(t.prototype,"cacheId",{get:function(){return this._legacyRequestCache.cacheId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cacheVersionId",{get:function(){return this._legacyRequestCache.cacheVersionId},enumerable:!0,configurable:!0}),t.prototype.flushCache=function(e){this._legacyRequestCache.flushCache(e),this._persistentRequestCache.flushCache(e)},t}(o.e),b=n(433),w=n.n(b);!function(e){e[e.lightBlue=0]="lightBlue",e[e.blue=1]="blue",e[e.darkBlue=2]="darkBlue",e[e.teal=3]="teal",e[e.lightGreen=4]="lightGreen",e[e.green=5]="green",e[e.darkGreen=6]="darkGreen",e[e.lightPink=7]="lightPink",e[e.pink=8]="pink",e[e.magenta=9]="magenta",e[e.purple=10]="purple",e[e.black=11]="black",e[e.orange=12]="orange",e[e.red=13]="red",e[e.darkRed=14]="darkRed"}(f||(f={}));var S=["#0078d7","#088272","#107c10","#881798","#b4009e","#e81123","#da3b01","#006f94","#005e50","#004e8c","#a80000","#4e257f"],x=function(e){function t(t){return e.call(this,{dataSourceName:"SiteHeaderLogoAcronym",id:"acronymAndColors"},{pageContext:t})||this}return Object(a.__extends)(t,e),t.decodeAcronymColor=function(e){return S.indexOf(e)+1},t.prototype.getAcronymData=function(e){return this.getAcronyms([e]).then((function(e){return e[0]}),(function(){return{acronym:void 0,color:void 0,text:void 0}}))},t.prototype.getAcronyms=function(e,t){var n=this;if(void 0===t&&(t={}),this._pageContext.webServerRelativeUrl){var r=t.qosName,a=void 0===r?"GetSiteHeaderLogoAcronym":r;return this.getDataUtilizingPersistentCache({getUrl:function(){var t=e.map((function(e){return"{Text: "+w.a.encodeURIComponent('"'+e+'"')+"}"})).join(",");return Object(i.e)(n._pageContext)+"/_api/sphome/GetAcronymsAndColors?labels=["+t+"]"},parseResponse:function(e){return JSON.parse(e).d.GetAcronymsAndColors.results.map((function(e){return{acronym:e.Acronym,color:e.Color,text:e.Text}}))},method:"GET",qosName:a})}return c.a.reject(new Error("No web URL specified for request."))},t}(C)},1434:function(e,t,n){"use strict";n.r(t),n.d(t,"TargetType",(function(){return s})),n.d(t,"ABExpHash",(function(){return c})),n.d(t,"EXPERIMENTS_WITH_V1_HASHING",(function(){return h})),n.d(t,"ABExperiment",(function(){return g}));var r,a=n(0),i=n(125),o=n(1473);!function(e){e[e.Unknown=0]="Unknown",e[e.User=1]="User",e[e.Site=2]="Site"}(r||(r={}));var s,c,l=Object(o.createSingleEvent)({eventName:"Experiment,",shortEventName:"Experiment"},{name:{isPrefixingDisabled:!0,type:1},isInRamp:{isPrefixingDisabled:!0,type:3},experiment:{isPrefixingDisabled:!0,type:1},variant:{isPrefixingDisabled:!0,type:1},assignmentType:{isPrefixingDisabled:!0,type:6,typeRef:r},assignmentId:{isPrefixingDisabled:!0,type:1}}),d=n(263),u=n(683),p=n(145),m=n(975),f=n(1372);!function(e){e[e.user=1]="user",e[e.tenant=2]="tenant",e[e.farm=3]="farm",e[e.site=4]="site"}(s||(s={})),function(e){e[e.v1=1]="v1",e[e.v2=2]="v2"}(c||(c={}));var h=["ChangeFlowToAutomate2","DocLibServiceWorkerExperimentV2","FileHoverCardAssign","flowOdbCommandBarCoachmarkExperiment","flowOdbCommandBarCoachmarkExperiment2","flowRemindMeCoachmarkExperiment","flowRemindMeCoachmarkExperiment2","flowRequestSignOffCoachmarkExperiment2","FluentLightBoxExperiment","NewCreateSiteEntryPointExperiment"],g=function(){function e(t,n){var r=t.name,o=n&&!m.default.isFeatureEnabled(n);d.Killswitch.isActivated("ecfe2fe1-07c6-4117-98d8-27582d0384f7","10/25/2018")||this._isValidName(t.name)||p.default.log("Experiment name '"+t.name+"' is invalid.");var l=h.indexOf(t.name)>-1?c.v1:c.v2;if(this._experimentData=t=Object(a.__assign)({segmentPopulation:.5,targetType:s.user,version:l},t),o&&(t.name+="AA"),this._isOn=!1,e._pageContext)switch(this._experimentData.targetType){case s.user:this._isOn=this._isUserExperimentOn();break;case s.tenant:this._isOn=this._isTenantExperimentOn();break;case s.farm:this._isOn=this._isFarmExperimentOn();break;case s.site:this._isOn=this._isSiteExperimentOn()}else i.Engagement.logData({name:this._experimentData.name+".Experiment.HostSettingsMissing"});o&&(this._isOn=!1);var f=Object(u.deserializeQuery)((window.location.search||"").substr(1)),g=(f.enableExp||"").split(","),y=(f.disableExp||"").split(",");-1!==g.indexOf(r)?this._isOn=!0:-1!==y.indexOf(r)&&(this._isOn=!1)}return e.init=function(t){e._pageContext=Object(a.__assign)(Object(a.__assign)({},t),{userLoginName:t.userLoginName||"missing_user",siteSubscriptionId:t.siteSubscriptionId||"missing_tenant",farmLabel:t.farmLabel||"missing_farm",siteId:t.siteId||"missing_site"})},e.Init=function(t){e.init(t)},e.prototype.getExperimentData=function(){return this._experimentData},e.prototype.isOn=function(){return this._isOn},e.prototype.IsExperimentOn=function(){return this._isOn},e.prototype._isUserExperimentOn=function(){var t=e._pageContext;if(!t)return!1;var n="",r=this._experimentData,a=r.name,i=r.version;return i===c.v1?n=a+"_"+t.userLoginName+"_"+t.siteSubscriptionId+"_"+t.farmLabel:i===c.v2&&(n=a+t.userLoginName),this._isExperimentOn(n)},e.prototype._isTenantExperimentOn=function(){var t=e._pageContext;if(!t)return!1;var n="",r=this._experimentData,a=r.name,i=r.version;return i===c.v1?n=a+"_"+t.siteSubscriptionId+"_"+t.farmLabel:i===c.v2&&(n=a+t.siteSubscriptionId),this._isExperimentOn(n)},e.prototype._isFarmExperimentOn=function(){var t=e._pageContext;if(!t)return!1;var n="",r=this._experimentData,a=r.name,i=r.version;return i===c.v1?n=a+"_"+this._getSiteId()+"_"+t.siteSubscriptionId+"_"+t.farmLabel:i===c.v2&&(n=a+this._getSiteId()),this._isExperimentOn(n)},e.prototype._isSiteExperimentOn=function(){var t=e._pageContext;if(!t)return!1;var n=this._experimentData.name+"_"+this._getSiteId()+"_"+t.siteSubscriptionId+"_"+t.farmLabel;return this._isExperimentOn(n)},e.prototype._isValidName=function(e){return!/[^A-Za-z0-9]/.test(e)},e.prototype._getSiteId=function(){var t=e._pageContext;return this._experimentData.siteId?this._experimentData.siteId:t.siteId},e.prototype._isExperimentOn=function(e){if(!e)return!1;var t=0;this._experimentData.version===c.v1?t=this._getHashNumber(e):this._experimentData.version===c.v2&&(t=this._getHashNumberMurmur(e));var n=t<=this._experimentData.segmentPopulation;return this._logData(n),n},e.prototype._getHashNumber=function(e){if(0===e.length)return 1;for(var t=5381,n=0;n<e.length;++n)t=(t<<5)+t+e.charCodeAt(n),t&=t;return(t&=65535)/65535},e.prototype._getHashNumberMurmur=function(e){return f.v3(e,1)/4294967295},e.prototype._getExperimentType=function(){return this._experimentData.targetType===s.user?r.User:this._experimentData.targetType===s.site?r.Site:r.Unknown},e.prototype._logData=function(e){l.logData({name:"",isInRamp:e,experiment:this._experimentData.name,variant:e.toString(),assignmentType:this._getExperimentType(),assignmentId:this._experimentData.targetType===s.site?this._getSiteId():""})},e}()},1446:function(e,t,n){"use strict";n.r(t),n.d(t,"SocialBarLikeLink",(function(){return g}));var r=n(0),a=n(1),i=n(880),o=n(1126),s=n(21),c=n(25),l=n(49),d=n(181),u=n(77),p=n(8),m=Object(d.asAsync)((function(){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(2),n.e(37)]).then(n.bind(null,1505))];case 1:return[2,e.sent().default]}}))}))})),f=Object(p.createItemCacheComponent)((function(e,t){var n=t.itemKey,i=Object(s.renderComponentOnExecute)((function(e){return a.createElement(m,Object(r.__assign)({},e,{itemKey:n}))}),{scope:"global"});return a.createElement(l.Action,Object(r.__assign)({onExecute:i},Object(u.getItemActionEngagement)(e,{itemKey:n,engagement:{name:"SocialBar",isIntentional:!0}})))})),h=(Object(c.withOnlyCurrentItem)()(f),n(1113)),g=function(e){function t(t){return e.call(this,t)||this}return Object(r.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.likeLabel,n=e.itemKey,r=a.createElement(o.e,{activityDescription:t,isCompact:!0});return a.createElement(s.WithAction,{action:a.createElement(f,{itemKey:n})},(function(e){var t=e.isAvailable,n=e.execute,o=t?function(){n().catch((function(){}))}:void 0;return a.createElement(i.e,{disabled:!1,className:h.e,onClick:o},r)}))},t}(a.Component)},1473:function(e,t,n){e.exports=n(167)},1483:function(e,t,n){"use strict";n.r(t),n.d(t,"FileHoverCard",(function(){return tt})),n.d(t,"CurrentFileHoverCard",(function(){return nt}));var r=n(0),a=n(1),i=n(1487),o=n(45),s=n(938),c=n(51),l=n(5),d=n(86),u=n(27),p=n(16);Object(p.e)([{rawString:".fileHoverCardCompactCard_7d060422{padding:14px 12px 0}.isFluent .fileHoverCardCompactCardTitleRegion_7d060422{margin-bottom:2px;display:-webkit-box;display:-ms-flexbox;display:flex;min-height:40px;-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin-left:2px}[dir='ltr'] .isFluent .fileHoverCardCompactCardFileIcon_7d060422{margin-right:14px}[dir='rtl'] .isFluent .fileHoverCardCompactCardFileIcon_7d060422{margin-left:14px}.fileHoverCardCompactCardTitle_7d060422{font-size:17px;font-weight:300;font-weight:400;line-height:20px;overflow:hidden;text-overflow:ellipsis;word-break:break-word;max-width:200px}.fileHoverCardCompactCardTitle_7d060422.titleNotExpanded_7d060422{display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical}.isFluent .fileHoverCardCompactCardTitle_7d060422{font-size:14px;font-weight:600;padding:0;white-space:normal}.fileHoverCardCompactCardActivity_7d060422{padding:8px 0}.fileHoverCardExpandedCard_7d060422{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;text-overflow:ellipsis;word-break:break-word;max-height:526px;min-height:1px}[dir='ltr'] .fileHoverCardExpandedCard_7d060422{padding-left:12px}[dir='rtl'] .fileHoverCardExpandedCard_7d060422{padding-right:12px}@media screen and (max-height: 660px){.fileHoverCardExpandedCard_7d060422{max-height:50vh}}.fileHoverCardExpandedCardScrollableSection_7d060422{overflow-y:auto;overflow-x:hidden;padding-left:12px;margin-left:-12px}.fileHoverCardExpandedCardLoadError_7d060422{padding:120px 45px;font-size:14px;font-weight:400;text-align:center;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.fileHoverCardExpandedCardLoadError_7d060422 .fileHoverCardExpandedCardSuggestion_7d060422{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.fileHoverCardExpandedCardHostScroll_7d060422{overflow-y:hidden;height:calc(100% - 1px)}.fileHoverCardActivitiesSection_7d060422{padding:16px 0px 10px 4px;border-top:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}[dir='ltr'] .fileHoverCardActivitiesSection_7d060422{margin-right:12px}[dir='rtl'] .fileHoverCardActivitiesSection_7d060422{margin-left:12px}.fileCardExpandSectionContainer_7d060422{border-top:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";margin-right:12px}.fileCardExpandSectionButton_7d060422{width:100%;border:0;border-radius:0;text-align:left;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";margin-left:-12px;width:320px;padding-left:12px;padding-right:25px;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.collapsedFileCardTooltip_7d060422{text-align:right;height:18px;margin-right:12px;padding-top:2px;padding-right:15px;border-top:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}\n"}]);var m,f=n(1115),h=n(342),g=n(335),y=n(1114),v=n(1009),_=n(66),C=n(61),b=n(1469),w=n(879),S=n(179),x=n(1126),D=n(937),E=n(113),T=n(880);!function(e){e[e.succeed=0]="succeed",e[e.unsupport=1]="unsupport",e[e.failed=2]="failed"}(m||(m={}));var k=n(887),O=new Proxy({},{get:(e,t)=>localizationLoader.getLocalizedString("aiVbAk39C5ckAVqwuAx1Mg",t)}),I=n(874),R=n(1374);Object(p.e)([{rawString:".analyticsStatsContainer_123f61c9{display:-webkit-box;display:-ms-flexbox;display:flex;max-width:250px}.analyticsStats_123f61c9,.analyticsStatsNoLink_123f61c9,.analyticsStatsLink_123f61c9{padding:8px 8px 4px 0}.isFluent .analyticsStats_123f61c9,.isFluent .analyticsStatsNoLink_123f61c9,.isFluent .analyticsStatsLink_123f61c9{padding:0 8px 0 0}.analyticsStats_123f61c9 .ms-Link,.analyticsStatsNoLink_123f61c9 .ms-Link,.analyticsStatsLink_123f61c9 .ms-Link{font-size:12px;font-weight:400;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}html[dir='ltr'] .analyticsStats_123f61c9 .ms-ActivityItem-activityTypeIcon,html[dir='ltr'] .analyticsStatsNoLink_123f61c9 .ms-ActivityItem-activityTypeIcon,html[dir='ltr'] .analyticsStatsLink_123f61c9 .ms-ActivityItem-activityTypeIcon{padding-right:5px}html[dir='rtl'] .analyticsStats_123f61c9 .ms-ActivityItem-activityTypeIcon,html[dir='rtl'] .analyticsStatsNoLink_123f61c9 .ms-ActivityItem-activityTypeIcon,html[dir='rtl'] .analyticsStatsLink_123f61c9 .ms-ActivityItem-activityTypeIcon{padding-left:5px}.isFluent .analyticsStats_123f61c9 .ms-ActivityItem-activityTypeIcon,.isFluent .analyticsStatsNoLink_123f61c9 .ms-ActivityItem-activityTypeIcon,.isFluent .analyticsStatsLink_123f61c9 .ms-ActivityItem-activityTypeIcon{margin-top:0}.analyticsStats_123f61c9 .ms-ActivityItem-activityContent,.analyticsStatsNoLink_123f61c9 .ms-ActivityItem-activityContent,.analyticsStatsLink_123f61c9 .ms-ActivityItem-activityContent{-ms-flex-preferred-size:auto;flex-basis:auto;font-weight:600}html[dir='ltr'] .analyticsStats_123f61c9 .ms-ActivityItem-activityContent,html[dir='ltr'] .analyticsStatsNoLink_123f61c9 .ms-ActivityItem-activityContent,html[dir='ltr'] .analyticsStatsLink_123f61c9 .ms-ActivityItem-activityContent{padding-left:0}html[dir='rtl'] .analyticsStats_123f61c9 .ms-ActivityItem-activityContent,html[dir='rtl'] .analyticsStatsNoLink_123f61c9 .ms-ActivityItem-activityContent,html[dir='rtl'] .analyticsStatsLink_123f61c9 .ms-ActivityItem-activityContent{padding-right:0}.isFluent .analyticsStats_123f61c9 .ms-ActivityItem-activityContent,.isFluent .analyticsStatsNoLink_123f61c9 .ms-ActivityItem-activityContent,.isFluent .analyticsStatsLink_123f61c9 .ms-ActivityItem-activityContent{font-weight:400}.analyticsStatsLink_123f61c9 :hover{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.analyticsStatsNoLink_123f61c9{-ms-flex-item-align:center;align-self:center}.analyticsStatsViewsNoLink_123f61c9{padding:8px 0 4px;font-weight:400;font-size:12px}.isFluent .analyticsStatsViewsNoLink_123f61c9{padding:0}.analyticsStatsViews_123f61c9{padding-bottom:8px}.isFluent .analyticsStatsViews_123f61c9{font-size:14px;font-weight:600}.analyticsStatsViewsDivider_123f61c9:before{content:' \\B7  '}.analyticsStatsViewsDividerNoDot_123f61c9:before{content:'   ';padding:0px 4px}.analyticsStatsErrorMessage_123f61c9{font-size:12px;font-weight:400;line-height:28px}.fileHoverCardErrorIcon_123f61c9{vertical-align:bottom}.analyticsStatsTeachingMessage_123f61c9,.analyticsStatsInfo_123f61c9{vertical-align:sub;padding:0px 8px}.isFluent .analyticsStatsInfo_123f61c9{font-size:12px;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.analyticsStatsLabel_123f61c9{display:-webkit-box;display:-ms-flexbox;display:flex}html[dir='ltr'] .analyticsStatsCount_123f61c9:not(:last-child){padding-right:8px}html[dir='rtl'] .analyticsStatsCount_123f61c9:not(:last-child){padding-left:8px}\n"}]);var A=n(1376),P=new Date("0001-01-01T00:00:00-08:00"),F=function(e){var t,n,r,i,s=e.itemAnalytics,c=e.onClick,l=e.onLikeClick,d=e.pageUrl,p=e.isLink,f=e.status,h=e.isCompact,g=e.disableViewerCount,y=void 0===g||g,v=e.ODBOptOutViewerList,_=void 0!==v&&v,C=e.itemKey,b=B();if(f===m.failed){var w=Object(u.w)();t=b.apiError&&(n="ErrorBadge",r=b.apiError,i={color:w.palette.redDark},a.createElement(a.Fragment,null,a.createElement(k.e,{iconName:n,className:"fileHoverCardErrorIcon_123f61c9",styles:{root:Object(u.M)([{paddingRight:"8px",position:"relative"},i])}}),r))}if(t)return null;if(!s||!s.viewCount||!s.viewerCount)return a.createElement(x.e,{className:"analyticsStats_123f61c9",isCompact:!0});var S=s.viewCount,D=s.viewerCount,F=s.activities,L=s.commentCount,j=s.likeCount,H=s.incompleteData&&s.incompleteData.missingDataBeforeDateTime&&new Date(s.incompleteData.missingDataBeforeDateTime).getTime()!==P.getTime(),U=s.incompleteData&&s.incompleteData.wasThrottled,M=H?O.inCompleteMessage:U?O.throttledStateMessage:"",q=y?_?O.odbTeachingMessage:"":O.spoTeachingMessage,K=M||q,V=S>1?b.views:b.view,z=D>1?b.viewers:b.viewer,W=L&&L>1?b.comments:b.comment,J=j&&j>1?b.likes:b.like,X=L?""+E.format(W,L):"",Q=j?""+E.format(J,j):"",G=Object(R.isLikePanelEnabled)()?l:void 0,Z=Object(R.isCommentLinkEnabled)()?d:void 0,Y=Q&&N(Q,G),$=X&&N(X,void 0,Z);return h?p?a.createElement("div",{className:"analyticsStatsContainer_123f61c9"},a.createElement(T.e,{className:"analyticsStatsLink_123f61c9",onClick:c},a.createElement(x.e,{activityPersonas:F&&0!==F.length?F.slice(0,3).map((function(e){return{imageUrl:e&&e.actor&&e.actor.user&&e.actor.user.image}})).reverse():void 0,activityDescription:a.createElement("div",{className:"analyticsStatsLabel_123f61c9"},S&&a.createElement("div",{className:"analyticsStatsCount_123f61c9"},S+" "+V)),isCompact:!0})),Q&&C?a.createElement(A.SocialBarLikeLink,{likeLabel:Q,itemKey:C}):Y,$):a.createElement("div",{className:"analyticsStatsContainer_123f61c9"},N(S+" "+V,void 0),N(D+" "+z,void 0),K&&a.createElement(I.e,{content:K,directionalHint:o.e.bottomCenter},a.createElement(k.e,{className:"analyticsStatsTeachingMessage_123f61c9",iconName:"Info","aria-describedby":K})),Y,$):a.createElement("div",{className:"analyticsStatsViews_123f61c9"},D+" "+z,a.createElement("span",{className:"analyticsStatsViewsDivider_123f61c9"}),S+" "+V,M&&a.createElement(I.e,{content:M,directionalHint:o.e.bottomCenter},a.createElement(k.e,{className:"analyticsStatsInfo_123f61c9",iconName:"Info","aria-describedby":M})))};function N(e,t,n){var r=a.createElement(x.e,{activityDescription:a.createElement("div",{className:Object(C.e)("analyticsStatsLabel_123f61c9","analyticsStatsCount_123f61c9")},e),isCompact:!0});return t||n?a.createElement(T.e,{className:"analyticsStatsLink_123f61c9",href:n+"#comments",target:"_blank",onClick:t},r):a.createElement("div",{className:"analyticsStatsNoLink_123f61c9"},r)}function B(){return{details:O.seeDetails,viewer:O.viewer,viewers:O.viewers,view:O.view,views:O.views,comment:O.pageComment,comments:O.pageComments,like:O.pageLike,likes:O.pageLikes,apiError:O.apiError,suggestion:O.suggestion,unsupportMessage:O.unsupportMessage,accessActivity:O.accessActivity,modifiedActivity:O.modifiedActivity,activityTemplate:O.activityTemplate,inCompleteDataMessage:O.inCompleteDataMessage,throttledMessage:O.throttledMessage,trendingItem:O.trendingItem,loginUserYou:O.you}}function L(e,t,n){var r=e&&e.toLowerCase(),a=t&&t.toLowerCase(),i=n&&n.toLowerCase();return!(r!==a&&r!==i)}F.defaultProps={isLink:!1},Object(p.e)([{rawString:".analyticsActivity_fbe4fcc5{width:240px;height:16px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.analyticsActivity_fbe4fcc5 .analyticsActivityUserAction_fbe4fcc5,.analyticsActivity_fbe4fcc5 .analyticsActivityUserName_fbe4fcc5{display:inline-block;content:attr(data-analytics-activity-start)}.analyticsActivity_fbe4fcc5 .analyticsActivityUserName_fbe4fcc5{content:attr(data-analytics-activity-start);color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";font-weight:600}.analyticsActivity_fbe4fcc5 .analyticsActivityUserAction_fbe4fcc5{content:attr(data-analytics-activity-end);color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.ms-ActivityItem-timeStamp{height:16px}\n"}]);var j=function(e){var t=e.activity,n=e.loginUserEmail,r=e.userEmail,i=B(),o="";"Access"===t.activityType?o=i.accessActivity:"Modified"===t.activityType&&(o=i.modifiedActivity);var s=t&&t.actor&&t.actor.user,c=L(s&&s.email,n,r)?i.loginUserYou:s&&s.displayName||s&&s.email||O.guest,l=a.createElement("div",{className:"analyticsActivityUserName_fbe4fcc5"},c),d=a.createElement("div",{className:"analyticsActivityUserAction_fbe4fcc5"},o),u=i.activityTemplate&&E.formatToArray(i.activityTemplate,l,d),p=D.n.size24;return a.createElement(x.e,{activityPersonas:[{imageUrl:s.image,imageAlt:c,imageInitials:e.imageInitials,initialsColor:e.initialsColor,size:p}],activityDescription:a.createElement("div",{dir:"auto",className:"analyticsActivity_fbe4fcc5"},u),timeStamp:t.activityDateTime,styles:{root:{alignItems:"center"},activityContent:{padding:"0 12px"},personaContainer:{width:"24px",height:"24px"}}})};Object(p.e)([{rawString:".analyticsActivityListActivity_1fa22094{padding:8px 0}\n"}]);var H=n(183),U=n.n(H),M=!1,q=!1;function K(){q||(q=!0,function(){if(M||!q)return;M=!0;new U.a({name:"ItemAnalytics.PageFinishedLoading",startTimeOverride:window._itemAnalyticsStartTime}).end({resultType:H.ResultTypeEnum.Success});try{window.external.PageFinishedLoading()}catch(e){window.parent.postMessage(JSON.stringify({name:"item_analytics_ready"}),"*")}}())}var V=n(1377),z=n(959),W=n.n(z),J=function(e){function t(t){return e.call(this,t)||this}return Object(r.__extends)(t,e),t.prototype.componentDidMount=function(){this.props.onLoaded&&this.props.onLoaded()},t.prototype.render=function(){return a.createElement(w.e,{size:S.e.large})},t}(a.Component),X=function(e){function t(t){var n=e.call(this,t)||this;return n._onRenderCell=function(e,t){return e&&e.activity&&a.createElement("div",{className:"analyticsActivityListActivity_1fa22094"},a.createElement(j,{activity:e.activity,loginUserEmail:n.props.loginUserEmail,userEmail:n.props.userEmail,imageInitials:e.imageInitials,initialsColor:e.initialsColor}),n.props.moreActivities&&t===n.state.items.length-1?a.createElement(J,{onLoaded:n.props.onLoadMoreActivities}):void 0)},n.state={items:t.itemAnalytics&&t.itemAnalytics.activities.map((function(e){return{activity:e}})),itemAnalyticsData:t.itemAnalytics},n}return Object(r.__extends)(t,e),t.prototype.UNSAFE_componentWillReceiveProps=function(e){e.itemAnalytics&&(this._updateActivities(e.itemAnalytics),this.props.pageContext&&this._updateAcronyms(e.itemAnalytics))},t.prototype.render=function(){var e,t=this,n=this.props.showAnalyticsStats,r=void 0===n||n,i=this.state.itemAnalyticsData,o=B();return i&&i.incompleteData&&i.incompleteData.wasThrottled&&(e=o.throttledMessage),i?(K(),a.createElement("div",null,r&&a.createElement(F,{itemAnalytics:i,inComplete:!!e}),this.state.items&&a.createElement(b.e,{items:this.state.items,onRenderCell:this._onRenderCell,onShouldVirtualize:function(){return t.state.items.length>30}}))):a.createElement(J,null)},t.prototype._updateActivities=function(e){this.setState((function(){return{itemAnalyticsData:e,items:e.activities.map((function(e){return{activity:e}}))}}))},t.prototype._updateAcronyms=function(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,a,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),this.props.pageContext?(t=e.activities.map((function(e){return e.actor.user.displayName})),[4,new V.AcronymAndColorDataSource(this.props.pageContext).getAcronyms(t,{qosName:"ItemAnalyticsListAcronyms"})]):[3,2];case 1:n=r.sent(),a=n.reduce((function(e,t){return t.text&&(e[t.text]=t),e}),{}),this.setState((function(e){return{items:e.items.map((function(e){var t=a[e.activity.actor.user.displayName];return{activity:e.activity,imageInitials:t&&t.acronym,initialsColor:t&&t.color}}))}})),r.label=2;case 2:return[3,4];case 3:return i=r.sent(),W.a.logError(i),function(e){try{window.external.PageError(e,e.message)}catch(n){var t={name:"item_analytics_error",error:e,errorMessage:e.message};window.parent.postMessage(JSON.stringify(t),"*")}}(i),[3,4];case 4:return[2]}}))}))},t}(a.Component),Q=n(664),G=n(878),Z=n(548),Y=n(872),$=n(125),ee=function(){function e(e){this._engagementData={},this._engagement=e||$.Engagement}return Object.defineProperty(e.prototype,"engagementData",{set:function(e){this._engagementData=e},enumerable:!0,configurable:!0}),e.prototype.logData=function(e,t){this._engagement.logData(Object(r.__assign)(Object(r.__assign)({name:e},this._engagementData),{extraData:Object(r.__assign)(Object(r.__assign)({},this._engagementData.extraData),t)}))},e}(),te=a.createContext(new ee);Object(p.e)([{rawString:".fileHoverCardInsideLook_450f4e32{padding:16px 0 14px 4px;border-top:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}[dir='ltr'] .fileHoverCardInsideLook_450f4e32{margin-right:12px}[dir='rtl'] .fileHoverCardInsideLook_450f4e32{margin-left:12px}.fileHoverCardInsideLook_450f4e32 .fileHoverCardInsideLookTitle_450f4e32{font-size:14px;font-weight:600;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.fileHoverCardInsideLook_450f4e32 .ms-TooltipHost{padding:0 8px;font-size:12px;vertical-align:middle;color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}.fileHoverCardInsideLook_450f4e32 .ms-Button--icon{height:14px}.fileHoverCardReadTimeContainer_450f4e32{padding-top:6px;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";display:-webkit-box;display:-ms-flexbox;display:flex}.fileHoverCardReadTimeContainer_450f4e32 .fileHoverCardReadTime_450f4e32{display:inline-block;vertical-align:middle;font-size:12px}.fileHoverCardReadTimeContainer_450f4e32 .fileHoverCardReadTimeIcon_450f4e32{font-size:14px;vertical-align:text-top;margin-right:8px;margin-top:1px}.fileHoverCardKeyPointsButton_450f4e32{padding-top:5px;padding-bottom:5px;margin:7px -24px 0px -16px;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";font-size:12px;border:none;border-radius:0;height:100%;text-align:left;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.fileHoverCardKeyPointsNonButton_450f4e32{padding-top:5px;padding-bottom:5px;margin-top:7px;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";font-size:12px}.fileHoverCardKeyPointsContent_450f4e32{padding-top:8px}.fileHoverCardKeyPointsAction_450f4e32{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";font-size:12px;width:100%}.fileHoverCardKeyPointsCell_450f4e32{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;width:100%;padding-bottom:2px}.fileHoverCardKeyPointsText_450f4e32{overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical}.fileHoverCardKeyPointsBullet_450f4e32:before{content:' \\B7  '}.fileHoverCardKeyPointsBullet_450f4e32{display:inline-block}[dir='ltr'] .fileHoverCardKeyPointsBullet_450f4e32{padding-right:8px}[dir='rtl'] .fileHoverCardKeyPointsBullet_450f4e32{padding-left:8px}\n"}]);var ne=n(673),re=function(e){function t(t){var n=e.call(this,t)||this;return n._onClick=function(e){n.context.logData("FileHoverCard.KeyPoints.Click"),n.props.onKeyPointsClick&&n.props.onKeyPointsClick(e)},n._onClickMoreIcon=function(e){n._moreIconElement=e.currentTarget,n.setState({showCallout:!0}),n.context.logData("FileHoverCard.KeyPoints.ClickMoreIcon")},n.state={showCallout:!1},n}return Object(r.__extends)(t,e),t.prototype.render=function(){var e=this,t=O.insideLookTooltipMessage,n=this.props.keyPointsData;return a.createElement("div",{className:"fileHoverCardInsideLook_450f4e32",style:Object(ne.isCollapsedSectionsEnabled)()?{borderTop:0,paddingTop:0}:{}},!Object(ne.isCollapsedSectionsEnabled)()&&a.createElement("div",{className:"fileHoverCardInsideLookTitle_450f4e32"},a.createElement("div",null,!Object(ne.isCollapsedSectionsEnabled)()&&O.insideLook,a.createElement(I.e,{content:t,directionalHint:o.e.bottomCenter},a.createElement(k.e,{iconName:"Info",ariaLabel:t,role:"tooltip",tabIndex:0}))),this._ellipses()),this.state.showCallout&&a.createElement(Y.e,{gapSpace:0,isBeakVisible:!0,shouldFocusOnMount:!0,target:this._moreIconElement,onDismiss:function(){return e.setState({showCallout:!1})},directionalHint:Object(Q.e)()?o.e.bottomLeftEdge:o.e.bottomRightEdge,items:[{key:"sendFeedback",name:O.SendUsFeedback,onClick:this.props.onSendFeedbackClick},{key:"editKeyPoints",name:O.EditKeyPoints,onClick:this.props.onKeyPointsClick}]}),!(!n||!n.readTime||void 0===n.readTime.minutes)&&a.createElement("div",{className:"fileHoverCardReadTimeContainer_450f4e32",style:Object(ne.isCollapsedSectionsEnabled)()?{justifyContent:"space-between"}:{}},a.createElement("div",{className:"fileHoverCardReadTime_450f4e32"},a.createElement(k.e,{className:"fileHoverCardReadTimeIcon_450f4e32",iconName:"Clock","aria-describedby":t}),this._timeToReadMessage(n.readTime.minutes)),Object(ne.isCollapsedSectionsEnabled)()&&this._ellipses()),n&&n.keyPoints&&n.keyPoints.length>0&&(this.props.onKeyPointsClick?a.createElement(G.e,{className:"fileHoverCardKeyPointsButton_450f4e32",onClick:this._onClick,styles:{flexContainer:{flexWrap:"wrap"}}},this._keyPointsContent(n)):a.createElement("div",{className:"fileHoverCardKeyPointsNonButton_450f4e32"},this._keyPointsContent(n))))},t.prototype._keyPointsContent=function(e){return a.createElement(a.Fragment,null,a.createElement("div",{className:"fileHoverCardKeyPointsAction_450f4e32"},O.keyPointsTitle),a.createElement(b.e,{renderCount:3,items:e.keyPoints,onRenderCell:this._onRenderCell,className:"fileHoverCardKeyPointsContent_450f4e32"}))},t.prototype._onRenderCell=function(e){return e&&a.createElement("div",{className:"fileHoverCardKeyPointsCell_450f4e32"},a.createElement("div",{className:"fileHoverCardKeyPointsBullet_450f4e32"}),a.createElement("div",{dir:"auto",className:"fileHoverCardKeyPointsText_450f4e32"},e.text))},t.prototype._ellipses=function(){return this.props.onSendFeedbackClick&&a.createElement(Z.e,{iconProps:{iconName:"More"},onClick:this._onClickMoreIcon,ariaLabel:O.MoreOptions,style:{marginTop:"2px"}})},t.prototype._timeToReadMessage=function(e){if(0===e)return O.timeToReadInZero;if(e>60){var t=E.getLocalizedCountValue(O.timeToReadInHours,O.timeToReadInHoursIntervals,Math.floor(e/60));return t&&E.format(t,Math.floor(e/60))}return E.format(O.timeToReadInMinutes,e)},t}(a.Component);re.contextType=te,Object(p.e)([{rawString:".fileHoverCardLifeCycle_a88ba103{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:baseline;-ms-flex-align:baseline;align-items:baseline;border-top:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";padding:8px 0px 10px 5px;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}[dir='ltr'] .fileHoverCardLifeCycle_a88ba103{margin-right:12px}[dir='rtl'] .fileHoverCardLifeCycle_a88ba103{margin-left:12px}.fileHoverCardLifeCycleMessage_a88ba103{font-size:12px}.fileHoverCardLifeCycleMessage_a88ba103 .fileHoverCardLifeCycleTitle_a88ba103{white-space:pre-line;font-weight:400}.fileHoverCardLifeCycleAction_a88ba103{padding-top:4px;font-weight:600}.fileHoverCardLifeCycleNewSignal_a88ba103{display:-webkit-box;display:-ms-flexbox;display:flex}[dir='ltr'] .fileHoverCardLifeCycleNewSignal_a88ba103{padding-left:15px}[dir='rtl'] .fileHoverCardLifeCycleNewSignal_a88ba103{padding-right:15px}\n"}]);var ae=n(544),ie=n(185),oe=n(1383);function se(e){var t,n,r,a,i,o,s=e.lifeCycleSignalData,c=e.loginUserEmail,l=e.userEmail,d=e.createdBy,u=e.createdDateTime,p=e.onRenderLifeCycleSignal,m=s.signal;switch(s.key){case ae.malwareSignalKey:t=O.malwareDetected,n="https://go.microsoft.com/fwlink/?linkid=862871",i=O.learnMore;break;case ae.youCheckedOutSignalKey:t=O.youHaveThisCheckedOut,r=e.onCheckIn,a=e.onDiscardCheckOut,i=e.onCheckIn?O.checkIn:void 0,o=e.onDiscardCheckOut?O.discardCheckOut:void 0;break;case ae.someoneCheckedOutSignalKey:t=s.title;break;case ae.dlpBlockedSignalKey:t=O.DLPBlocked,r=e.onViewPolicyTip,i=O.viewPolicyTip;break;case ae.missingMetadataSignalKey:t=O.missingMetaData,r=e.onAddMetadataNow,i=O.addMetaData;break;case ae.dlpWarningSignalKey:t=O.DLPWarning,r=e.onViewPolicyTip,i=O.viewPolicyTip;break;case ae.trendingSignalKey:t=s.title;break;case ae.newSignalKey:var f=u&&Object(ie.getFriendlyDateTimeStringPast)(new Date(u));t=d&&d.email&&L(d.email,c,l)?E.format(O.youCreated,f):E.format(O.otherCreated,f,d&&d.displayName);break;default:m=null}return(p?Object(oe.composeRenderFunctions)(p,ce):ce)({signal:m,content:t,action:r,actionName:i,secondaryAction:a,secondaryActionName:o,link:n})}function ce(e){return e&&e.signal?a.createElement("div",{className:"fileHoverCardLifeCycle_a88ba103"},e.signal,a.createElement("div",{className:"fileHoverCardLifeCycleMessage_a88ba103"},e.content&&a.createElement("div",{className:"fileHoverCardLifeCycleTitle_a88ba103"},e.content),(e.action||e.link)&&a.createElement(T.e,{className:"fileHoverCardLifeCycleAction_a88ba103",href:e.link,target:e.link&&"_blank",onClick:e.action},e.actionName),e.secondaryAction&&" "+O.Or+" ",e.secondaryAction&&a.createElement(T.e,{className:"fileHoverCardLifeCycleAction_a88ba103",onClick:e.secondaryAction},e.secondaryActionName))):null}var le=n(186),de=n.n(le);Object(p.e)([{rawString:".fileHoverCardRecommendedSection_ef3fc21d{padding:16px 0px 2px 4px;font-size:14px;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";border-top:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}[dir='ltr'] .fileHoverCardRecommendedSection_ef3fc21d{margin-right:12px}[dir='rtl'] .fileHoverCardRecommendedSection_ef3fc21d{margin-left:12px}.fileHoverCardRecommendedTitle_ef3fc21d{font-weight:600;padding-bottom:16px;display:inline-block}.fileHoverCardRecommendedMessage_ef3fc21d{margin-bottom:2px}.fileHoverCardShareWith_ef3fc21d{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";display:inline-block;content:attr(data-analytics-activity-end);font-size:12px}.fileHoverCardShareWithLink_ef3fc21d{padding:2px 0 16px 0;font-size:12px}.fileHoverCardChevronIcon_ef3fc21d{font-size:12px;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";vertical-align:middle;padding-left:5px}[dir='ltr'] .fileHoverCardChevronIcon_ef3fc21d{padding-left:5px}[dir='rtl'] .fileHoverCardChevronIcon_ef3fc21d{padding-right:5px}.fileHoverCardRecommendedAction_ef3fc21d{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;margin-bottom:-3px}.fileHoverCardRecommendedAction_ef3fc21d:hover .fileHoverCardCancelIcon_ef3fc21d{opacity:1}.fileHoverCardRecommendedIcon_ef3fc21d{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";margin-right:4px}.fileHoverCardCancelIcon_ef3fc21d{opacity:0}.fileHoverCardCancelIcon_ef3fc21d .ms-Button-icon{font-size:8px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.fileHoverCardCancelIcon_ef3fc21d .ms-Button-flexContainer{-webkit-box-align:baseline;-ms-flex-align:baseline;align-items:baseline}.fileHoverCardRecommendedLink_ef3fc21d{display:block;padding-bottom:14px;font-size:12px;font-weight:600}[dir='ltr'] .fileHoverCardRecommendedLink_ef3fc21d{padding-left:28px}[dir='rtl'] .fileHoverCardRecommendedLink_ef3fc21d{padding-right:28px}.fileHoverCardActivity_ef3fc21d{height:16px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";content:attr(data-analytics-activity-end);display:inline-block}.fileHoverCardUserName_ef3fc21d{content:attr(data-analytics-activity-start);font-weight:600;display:inline-block;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}\n"}]);var ue=n(913);function pe(e,t,n){t?ue.Engagement.logData({name:e,isIntentional:!0,extraData:Object(r.__assign)({itemId:t.itemId,driveId:t.graph&&t.graph.driveId,fileExtension:t.extension,fileType:t.appMap},n)}):ue.Engagement.logData(Object(r.__assign)({name:e},n))}var me=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._handleClickShare=function(e){var n=t.props.shareWith&&t.props.shareWith.slice(0,2).map((function(e){return e.email}));t.props.onShareWith(e,n),pe("FileHoverCard.RecommendedActions.ShareWith",t.props.item)},t}return Object(r.__extends)(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.editActivities,r=t.shareWith,i=this.props.shareWith&&this.props.shareWith.slice(0,2).map((function(e){return e.email}));return r&&r.length>=2&&a.createElement(a.Fragment,null,a.createElement("div",{className:"fileHoverCardShareWith_ef3fc21d"},E.formatToArray(O.ShareWithMessage,this._userNameJSX(r[0].displayName),this._userNameJSX(r[1].displayName))),this.props.onRenderShareWithPeople?a.createElement("div",{className:"fileHoverCardShareWithLink_ef3fc21d"},this.props.onRenderShareWithPeople(i)):a.createElement(T.e,{className:"fileHoverCardShareWithLink_ef3fc21d",onClick:this._handleClickShare},O.ShareWithThem),n&&n.map((function(t,n){return n<2&&a.createElement(x.e,{key:n,activityIcon:a.createElement(k.e,{iconName:"Edit",className:"fileHoverCardRecommendedIcon_ef3fc21d"}),onRenderActivityDescription:function(){return e._onRenderActivityDescription(t)},timeStamp:t.activityDateTime})})))},t.prototype._onRenderActivityDescription=function(e){var t=e&&e.actor&&e.actor.user,n=L(t&&t.email,this.props.loginUserEmail,this.props.userEmail)?O.you:e.actor.user.displayName;return a.createElement("div",{className:"fileHoverCardActivity_ef3fc21d"},E.formatToArray(O.LowActivities,this._userNameJSX(n)))},t.prototype._userNameJSX=function(e){return a.createElement("div",{key:e,className:"fileHoverCardUserName_ef3fc21d"},e)},t}(a.Component),fe=function(e){function t(t){var n=e.call(this,t)||this;return n._recommendedAction=function(e,t){var r=Object(ie.getFriendlyDateTimeStringPast)(Object(ie.iso8601DateTimeToJsDate)(e.activityTimestamp)),i="",s="",c="";switch(e.recommendationEventType){case"Mentioned":i="Accounts",c=E.formatToArray(O.MentionMessage,n._userNameJSX(e.actorDisplayName)),s=O.Reply;break;case"Edited":i="Edit",c=O.EditMessage,s=O.OpenToRead;var l=e.importantActorsAndActivities[0],d=l&&l.activityTimestamp;r=d&&Object(ie.getFriendlyDateTimeStringPast)(Object(ie.iso8601DateTimeToJsDate)(d));var u=e.importantActorsAndActivities.map((function(e){return e.actorDisplayName}));c=1===u.length?E.formatToArray(O.OnePersonEditMessage,n._userNameJSX(u[0])):2===u.length?E.formatToArray(O.TwoPersonEditMessage,n._userNameJSX(u[0]),n._userNameJSX(u[1])):E.formatToArray(O.EditMessage,n._userNameJSX(u[0]),n._userNameJSX(u[1]),e.recentEditorCount-2);break;case"Commented":i="Chat",c=E.formatToArray(O.CommentMessage,n._userNameJSX(e.actorDisplayName)),s=O.View}return a.createElement("div",{key:t},a.createElement("div",{className:"fileHoverCardRecommendedAction_ef3fc21d"},a.createElement(x.e,{activityIcon:a.createElement(k.e,{iconName:i,className:"fileHoverCardRecommendedIcon_ef3fc21d"}),activityDescription:a.createElement("div",{className:"fileHoverCardRecommendedMessage_ef3fc21d"},c),timeStamp:r}),a.createElement(I.e,{content:O.Dismiss,directionalHint:o.e.topCenter},a.createElement(Z.e,{className:"fileHoverCardCancelIcon_ef3fc21d",iconProps:{iconName:"Cancel"},onClick:function(){return n._handleClickDismiss(t)}}))),a.createElement(T.e,{className:"fileHoverCardRecommendedLink_ef3fc21d",href:n._getNavLink(e.navigationId),target:"_blank",onClick:function(){n.context.logData("FileHoverCard.RecommendedActions."+e.recommendationEventType,{})}},s))},n._getNavLink=function(e){if(n.props.pageUrl&&e){var t=new de.a(n.props.pageUrl);return t.setQueryParameter("nav",e),t.setQueryParameter("commentId",e),t.toString()}return n.props.pageUrl},n._recommendedActionRef=function(e){var t=n.state.recommendedActions;n.context.logData("FileHoverCard.RecommendedActions.Render",{activityType:t&&t.length>0?"HighActivities":"LowActivities"})},n.state={recommendedActions:n.props.actions.recommendedActions},n}return Object(r.__extends)(t,e),t.prototype.render=function(){var e=this.state.recommendedActions,t=Object(ne.isLowActivityTidbitEnabled)()&&this.props.actions.shareWith&&this.props.actions.shareWith.length>=2;return(e&&e.length>0||t)&&a.createElement("div",{ref:this._recommendedActionRef,className:"fileHoverCardRecommendedSection_ef3fc21d",style:Object(ne.isCollapsedSectionsEnabled)()?{borderTop:0}:{}},!Object(ne.isCollapsedSectionsEnabled)()&&a.createElement("div",{className:"fileHoverCardRecommendedTitle_ef3fc21d"},O.RecommendedActionTitle),e&&e.length>0?e.slice(0,3).map(this._recommendedAction):a.createElement(me,{item:this.props.item,shareWith:this.props.actions.shareWith,editActivities:this.props.actions.editActivities,loginUserEmail:this.props.loginUserEmail,userEmail:this.props.userEmail,onShareWith:this.props.onShareWith,onRenderShareWithPeople:this.props.onRenderShareWithPeople}))},t.prototype._userNameJSX=function(e){return a.createElement("span",{className:"fileHoverCardUserName_ef3fc21d"},e)},t.prototype._handleClickDismiss=function(e){this.context.logData("FileHoverCard.RecommendedActions.Dismiss",{recommendedActionId:this.state.recommendedActions[e].recommendationId}),this.props.onDismiss(this.state.recommendedActions[e].recommendationId,e),this.state.recommendedActions.splice(e,1),this.setState({recommendedActions:this.state.recommendedActions})},t}(a.Component);fe.contextType=te;var he=n(166),ge=new he.ControlFacet("hoverCardCommandsControl"),ye=new he.ControlFacet("hoverCardLifeCycleStatusControl"),ve=n(339),_e=n(573);Object(p.e)([{rawString:".fileHoverCardConversationsSection_8c83cf33{display:block;position:relative;padding-bottom:8px;margin-right:12px;font-size:14px;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";border-top:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.fileHoverCardConversationsTitle_8c83cf33{font-weight:600;padding:16px 0px 9px 4px;display:inline-block}.fileHoverCardConversation_8c83cf33{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;padding:7px 0px 8px 14px;margin:0 -24px 4px -12px;cursor:pointer}.fileHoverCardConversation_8c83cf33:hover{background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}.fileHoverCardConversationIcon_8c83cf33{margin-right:4px;width:17px;height:17px}.fileHoverCardConversationParticipants_8c83cf33{width:254px;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";white-space:nowrap;overflow:hidden;text-overflow:ellipsis;margin-bottom:1px}.fileHoverCardConversationContext_8c83cf33{width:254px;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";font-weight:600;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;margin-bottom:2px}.fileHoverCardMeetingConversationContext_8c83cf33{width:234px;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";font-weight:600;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:inline-block}.fileHoverCardConversationReferencePreview_8c83cf33{width:254px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";margin-bottom:4px}.fileHoverCardConversationSharedByUser_8c83cf33{font-weight:600}.fileHoverCardConversationsMeetingIcon_8c83cf33{display:inline-block;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";vertical-align:top;padding-top:2.5px;margin-right:8px}\n"}]);var Ce=n(1373),be=n(165),we=n.n(be),Se=n(1371),xe={ODB:1153,OneDrive:!0};var De=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._conversation=function(e,n){var r=t._context(e),i=e.deepLink,o=t._getIconName(e.conversationType),s=t._participants(e),c=e.referencePreview,l=Object(ie.getFriendlyDateTimeStringPast)(new Date(e.activityTimestamp));return a.createElement("div",{key:n},a.createElement("div",{className:"fileHoverCardConversation_8c83cf33",onClick:function(){var e=window.open(i,"_blank");e&&e.focus(),t.context.logData("FileHoverCard.Conversations.ClickDeepLink",{})}},a.createElement(x.e,{activityIcon:a.createElement(k.e,{iconName:o,className:"fileHoverCardConversationIcon_8c83cf33"}),activityDescription:s,comments:a.createElement(a.Fragment,null,r,a.createElement("div",{className:"fileHoverCardConversationReferencePreview_8c83cf33"},c)),timeStamp:l})))},t}return Object(r.__extends)(t,e),t.prototype.render=function(){var e=this.props.conversations;return(!we.a.isFeatureEnabled(xe)||new Se.ABExperiment({name:"ConversationsExperiment",startDate:"11/8/2019"}).IsExperimentOn())&&a.createElement("div",{className:"fileHoverCardConversationsSection_8c83cf33",style:Object(ne.isCollapsedSectionsEnabled)()?{borderTop:0}:{}},!Object(ne.isCollapsedSectionsEnabled)()&&a.createElement("div",{className:"fileHoverCardConversationsTitle_8c83cf33"},O.ConversationsTitle),e.slice(0,3).map(this._conversation))},t.prototype._context=function(e){var t=e.context,n=a.createElement(a.Fragment,null),r="fileHoverCardConversationContext_8c83cf33";e.conversationType===_e.ConversationType.CalendarEvent&&(t=E.format(O.MeetingsConversationsSubject,e.context),n=a.createElement(k.e,{iconName:"Event",className:"fileHoverCardConversationsMeetingIcon_8c83cf33"}),r="fileHoverCardMeetingConversationContext_8c83cf33");var i=0===t.length?a.createElement(a.Fragment,null):a.createElement("div",{className:r},t);return a.createElement(a.Fragment,null,n,i)},t.prototype._participants=function(e){var t,n=this;t=e.participants.filter((function(t){return t.identity.displayName&&!n._isSharedByUser(t.identity.email,e.sharedByUserEmail,t.identity.displayName,e.sharedByUserDisplayName)})).map((function(e){return L(e.identity.email,n.props.loginUserEmail,n.props.userEmail)?O.you:e.identity.displayName})).join(", ");var r=e.isSharedByMe?O.you:e.sharedByUserDisplayName;return a.createElement("div",{className:"fileHoverCardConversationParticipants_8c83cf33"},a.createElement("span",{className:"fileHoverCardConversationSharedByUser_8c83cf33"},0===t.length?r:r+", "),t)},t.prototype._isSharedByUser=function(e,t,n,r){return e.toLowerCase()===t.toLowerCase()||n.toLowerCase()===r.toLowerCase()},t.prototype._getIconName=function(e){var t=e===_e.ConversationType.CalendarEvent||e===_e.ConversationType.Mail?Object(Ce.getBrandTypeIconProps)({extension:"",brand:"outlook"}):Object(Ce.getBrandTypeIconProps)({extension:"",brand:"teams"});if(t)return t.iconName},t}(a.PureComponent);De.contextType=te;var Ee=n(172),Te=n(415),ke=n(914),Oe=n(164),Ie=n(7);Object(p.e)([{rawString:".fileHoverCardRelatedFilesSection_f4449314{display:block;position:relative;padding-bottom:8px;margin-right:12px;font-size:14px;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";border-top:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.fileHoverCardRelatedFilesTitle_f4449314{font-weight:600;padding:16px 0px 9px 4px;display:inline-block}.fileHoverCardRelatedFile_f4449314{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;padding:7px 0px 8px 14px;margin:0 -24px 0px -12px;cursor:pointer}.fileHoverCardRelatedFile_f4449314:hover{background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}.fileHoverCardRelatedFilesName_f4449314{width:254px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fileHoverCardRelatedFileIcon_f4449314{margin-right:8px;width:17px;height:17px}\n"}]);var Re=n(833),Ae=n(55),Pe=n(1369);function Fe(e){return a.createElement("div",{className:"fileHoverCardRelatedFilesSection_f4449314",style:Object(ne.isCollapsedSectionsEnabled)()?{borderTop:0}:{}},!Object(ne.isCollapsedSectionsEnabled)()&&a.createElement("div",{className:"fileHoverCardRelatedFilesTitle_f4449314"},O.RelatedFilesTitle),e.relatedFilesKeys.slice(0,3).map((function(e,t){return function(e,t){return a.createElement(s.WithItemCache,{key:t},(function(n){var r,i=n.itemCache,o=i.demandItemFacet(l.displayNameFacet,e),s=function(e){if(!e)return;var t=Object(Re.e)({extension:e,size:16});return t?t.iconName:void 0}(null===(r=o)||void 0===r?void 0:r.split(".")[1]),c=Object(Ae.evaluateItemCacheComponent)(i,a.createElement(Pe.ItemOpenUrlAction,{itemKey:e,engagement:{name:"FileHoverCard.RelatedFiles.ClickDeepLink"}}));return a.createElement(g.WithAction,{action:c},(function(e){var n=e.execute;return a.createElement("div",{key:"relatedFile_"+t},a.createElement("div",{className:"fileHoverCardRelatedFile_f4449314",onClick:function(){n()}},a.createElement(x.e,{activityIcon:a.createElement(k.e,{iconName:s,className:"fileHoverCardRelatedFileIcon_f4449314"}),activityDescription:a.createElement(a.Fragment,null,a.createElement("div",{className:"fileHoverCardRelatedFilesName_f4449314"},o)),isCompact:!0})))}))}))}(e,t)})))}function Ne(e){var t=e.itemKey,n=a.useContext(te),i=a.useRef(null),o=Object(a.useState)(!1),c=o[0],u=o[1],p=Object(a.useState)(!0),m=p[0],f=p[1],v=Object(a.useState)(!1),b=v[0],w=v[1],S=Object(a.useState)(!0),x=S[0],D=S[1],E=Object(a.useState)(!1),T=E[0],R=E[1],A=Object(a.useState)(!0),P=A[0],F=A[1],N=Object(a.useState)(!1),B=N[0],L=N[1],j=Object(a.useState)(!0),H=j[0],U=j[1],M=Object(a.useState)(!1),q=M[0],K=M[1],V=Object(a.useState)(!0),z=V[0],W=V[1];function J(e,t,r,a,i,o){a(!r),i&&(n.logData(e,t),o(!1))}return a.useEffect((function(){i.current&&e.onCardExpand(i.current.clientHeight)})),a.createElement(s.WithItemCache,null,(function(n){var o=n.itemCache,s=function(e,t){var n,r=e.demandItemFacet(l.analyticsItemFacet,t),a=r&&r.itemKey,i=e.demandItemFacet(d.viewCountFacet,a),o=e.demandItemFacet(d.viewerCountFacet,a),s=e.demandItemFacet(d.isTrendingFacet,a),c=e.demandItemFacet(d.activitiesFacet,a),u=e.demandItemFacet(d.incompleteDataFacet,a),p=e.demandItemFacet(d.keyPointsFacet,a),m=e.demandItemFacet(_.loginUserFacet,_.configurationItemKey),f=e.demandItemFacet(l.fileNameFacet,t),h=c&&c.filter((function(e){return void 0!==e.access})),g=e.demandItemFacet(d.recommendedActionsFacet,a),y=e.demandItemFacet(d.conversationsFacet,a);if(Object(ne.isRelatedFilesApiCallEnabled)()){var v=e.demandItemFacet(l.relatedFilesItemSetFacet,t),C=e.demandItemFacet(Ie.childItemsFacet,v&&v.itemKey);n=C&&C.itemKeys}return{analyticsKey:r,itemAnalyticsKey:a,viewCount:i,viewerCount:o,isTrending:s,activities:c,incompleteData:u,keyPointsData:p,loginUser:m,itemName:f,viewActivities:h,actions:g,conversations:y,relatedItemKeys:n}}(o,t),p=s.itemAnalyticsKey,v=s.viewCount,S=s.viewerCount,E=s.isTrending,A=s.incompleteData,N=s.keyPointsData,j=s.loginUser,M=s.itemName,V=s.viewActivities,Q=s.actions,G=s.conversations,Z=s.relatedItemKeys,Y=Object(ae.getLifeCycleSignals)(o,t,2,!0),ee=o.isItemFacetResolved(d.keyPointsFacet,p)&&o.isItemFacetResolved(d.recommendedActionsFacet,p)&&o.isItemFacetResolved(d.conversationsFacet,p)&&(!Object(ne.isRelatedFilesApiCallEnabled)()||o.isItemFacetResolved(l.relatedFilesItemSetFacet,t)),te=o.isItemFacetResolved(ve.errorFacet,p),re=Be(N),ie=M&&t&&Le(M.extension,Q),oe=je(G),ce=He(V),le=Ue(Z),de={keyPoints:re,recommendedActions:!!ie,conversations:oe,viewers:!!ce,relatedFiles:le};if(ee||te)return a.createElement("div",{ref:i,className:Object(C.e)("fileHoverCardExpandedCard_7d060422",{isFluent:!0})},!!(j&&t&&p)&&Y.map((function(e){return function(e,t,n,i,o){var s,c=Object(r.__assign)({},y.selectedItemsControl.pack((function(){return{itemKeys:[n]}}))),u=o.demandItemFacet(ge,n),p=ge.evaluate(u)(o,{itemKey:n}),m=p.checkInAction,f=p.undoCheckOutAction,v=p.policyTipAction,_=p.addMetadataAction,C={checkIn:m,undoCheckOut:f,viewPolicyTip:v,addMetadata:_},b=o.demandItemFacet(d.createdByPersonFacet,i),w=o.demandItemFacet(d.createdDateTimeFacet,i);if(b){var S=o.demandItem({displayName:l.displayNameFacet,email:Ee.emailFacet,image:Ee.pictureFacet,id:Ee.sipFacet},b.itemKey);s={email:S.email||"",displayName:S.displayName||"",image:S.image||"",id:S.id||""}}var x=o.demandItemFacet(ye,n),D=ye.evaluate(x)(o,{itemKey:n,signalData:e}).onRenderLifeCycleSignal,E=Object(ke.getTelemetry)(o).telemetry,T=Object(Oe.getItemEngagement)(o,{itemKey:n,engagement:{isIntentional:!0}});return a.createElement(h.ControlHandlerProvider,{controlHandlers:c},a.createElement(g.WithActionSet,{actions:C},(function(n){var i=n.actions,o=i.checkIn,c=i.undoCheckOut,l=i.viewPolicyTip,d=i.addMetadata;return a.createElement(se,{lifeCycleSignalData:e,createdBy:s,createdDateTime:w,loginUserEmail:t.userLoginName,userEmail:t.userEmail,onViewPolicyTip:function(){E($.Engagement).logData(Object(r.__assign)({name:"FileHoverCard.LifeCycle.ViewPolicyTip"},T)),l&&l.execute()},onAddMetadataNow:function(){E($.Engagement).logData(Object(r.__assign)({name:"FileHoverCard.LifeCycle.AddMetadata"},T)),d&&d.execute()},onCheckIn:o&&o.isAvailable?function(){E($.Engagement).logData(Object(r.__assign)({name:"FileHoverCard.LifeCycle.FileCheckIn"},T)),o&&o.execute()}:void 0,onDiscardCheckOut:c&&c.isAvailable?function(){E($.Engagement).logData(Object(r.__assign)({name:"FileHoverCard.LifeCycle.DiscardCheckOut"},T)),c&&c.execute()}:void 0,onRenderLifeCycleSignal:D})})))}(e,j,t,p,o)})),a.createElement("div",{className:"fileHoverCardExpandedCardScrollableSection_7d060422"},Object(ne.isCollapsedSectionsEnabled)()&&a.createElement("div",{className:"collapsedFileCardTooltip_7d060422"},a.createElement(I.e,{content:O.CollapsedFileCardTooltip},a.createElement(k.e,{iconName:"info"}))),!!(re&&N&&t)&&(Object(ne.isCollapsedSectionsEnabled)()?a.createElement("div",{className:"fileCardExpandSectionContainer_7d060422",style:{border:0}},a.createElement(Te.e,{className:"fileCardExpandSectionButton_7d060422",text:O.insideLook,menuIconProps:{iconName:c?"ChevronUp":"ChevronDown"},onClick:function(){return J("FileHoverCard.KeyPointsExpanded",de,c,u,m,f)}}),c&&Me(o,{keyPointsData:N,itemKey:t})):Me(o,{keyPointsData:N,itemKey:t})),ie&&p&&(Object(ne.isCollapsedSectionsEnabled)()?a.createElement("div",{className:"fileCardExpandSectionContainer_7d060422",style:re?{}:{border:0}},a.createElement(Te.e,{className:"fileCardExpandSectionButton_7d060422",text:O.RecommendedActionTitle,menuIconProps:{iconName:b?"ChevronUp":"ChevronDown"},onClick:function(){return J("FileHoverCard.RecommendedActionsExpanded",de,b,w,x,D)}}),b&&qe(o,{target:e.target,itemKey:t,itemAnalyticsKey:p})):qe(o,{target:e.target,itemKey:t,itemAnalyticsKey:p})),Object(ne.isRelatedFilesSectionEnabled)()&&Z&&le&&(Object(ne.isCollapsedSectionsEnabled)()?a.createElement("div",{className:"fileCardExpandSectionContainer_7d060422",style:re||le?{}:{border:0}},a.createElement(Te.e,{className:"fileCardExpandSectionButton_7d060422",text:O.RelatedFilesTitle,menuIconProps:{iconName:q?"ChevronUp":"ChevronDown"},onClick:function(){return J("FileHoverCard.RelatedFilesExpanded",de,q,K,z,W)}}),q&&a.createElement(Fe,{relatedFilesKeys:Z,itemKey:t})):a.createElement(Fe,{relatedFilesKeys:Z,itemKey:t})),G&&j&&oe&&(Object(ne.isCollapsedSectionsEnabled)()?a.createElement("div",{className:"fileCardExpandSectionContainer_7d060422",style:re||ie?{}:{border:0}},a.createElement(Te.e,{className:"fileCardExpandSectionButton_7d060422",text:O.ConversationsTitle,menuIconProps:{iconName:T?"ChevronUp":"ChevronDown"},onClick:function(){return J("FileHoverCard.ConversationsExpanded",de,T,R,P,F)}}),T&&a.createElement(De,{conversations:G,loginUserEmail:j.userLoginName,userEmail:j.userEmail})):a.createElement(De,{conversations:G,loginUserEmail:j.userLoginName,userEmail:j.userEmail})),!(!ce||!j)&&(Object(ne.isCollapsedSectionsEnabled)()?a.createElement("div",{className:"fileCardExpandSectionContainer_7d060422",style:re||ie||oe?{}:{border:0}},a.createElement(Te.e,{className:"fileCardExpandSectionButton_7d060422",text:O.viewers,menuIconProps:{iconName:B?"ChevronUp":"ChevronDown"},onClick:function(){return J("FileHoverCard.ViewersExpanded",de,B,L,H,U)}}),B&&a.createElement("div",{className:"fileHoverCardActivitiesSection_7d060422",style:{borderTop:0}},a.createElement(X,{itemAnalytics:{activities:V||[],viewCount:v,viewerCount:S,isTrending:E,incompleteData:A},loginUserEmail:j.userLoginName,userEmail:j.userEmail}))):a.createElement("div",{className:"fileHoverCardActivitiesSection_7d060422"},a.createElement(X,{itemAnalytics:{activities:V||[],viewCount:v,viewerCount:S,isTrending:E,incompleteData:A},loginUserEmail:j.userLoginName,userEmail:j.userEmail})))))}))}function Be(e){var t=e&&e.readTime&&e.readTime.minutes;return!!(e&&e.keyPoints&&e.keyPoints.length>0)||!!t}function Le(e,t){return Boolean(t&&t.length>0)&&Object(ne.isRecommendedActionsSupported)(void 0,e)}function je(e){return Boolean(e&&e.length>0)}function He(e){return Boolean(e&&e.length>=1)}function Ue(e){return Boolean(e&&e.length>0)}function Me(e,t){var n=t.keyPointsData,r=t.itemKey,i=e.demandItemFacet(ge,r),o=ge.evaluate(i)(e,{itemKey:r}),s={showKeyPoints:o.showKeyPointsPane,showFeedback:o.showFeedbackPane};return a.createElement(g.WithActionSet,{actions:s},(function(e){var t=e.actions,r=t.showKeyPoints,i=t.showFeedback,o=r&&r.isAvailable?r.execute:void 0,s=i&&i.isAvailable?i.execute:void 0;return a.createElement(re,{keyPointsData:n,onKeyPointsClick:o,onSendFeedbackClick:s})}))}function qe(e,t){var n=t.target,r=t.itemKey,i=t.itemAnalyticsKey,o=e.demandItemFacet(d.recommendedActionsFacet,i),s=Object(ne.isLowActivityTidbitEnabled)()&&e.demandItemFacet(d.recommendedPeopleFacet,i)||[],c=e.demandItemFacet(l.openUrlFacet,r),u=e.demandItemFacet(d.activitiesFacet,i),p=e.demandItemFacet(_.loginUserFacet,_.configurationItemKey),m=u&&u.filter((function(e){return void 0!==e.edit})),y=e.demandItemFacet(ge,r),C=ge.evaluate(y)(e,{itemKey:r}).onDismiss;return a.createElement(h.ControlHandlerProvider,{controlHandlers:v.shareActionControl.pack((function(){return{defaultRecipients:s?s.map((function(e){return e.email})):[]}}))},a.createElement(g.WithAction,{action:a.createElement(f.ItemShareAction,{itemKey:r})},(function(e){var t=e.execute;return o&&C&&a.createElement(fe,{actions:{recommendedActions:o,shareWith:s,editActivities:m},loginUserEmail:p&&p.userLoginName,userEmail:p&&p.userEmail,pageUrl:c,onDismiss:C,onShareWith:function(e,r){e.target=n,e.persist(),t({event:e})}})})))}var Ke=n(1384),Ve=n(534),ze=n(1490),We=n(1437),Je=n(1022);Object(p.e)([{rawString:".analyticsActionBarStats_bfed0b89{min-height:28px}.isFluent .analyticsActionBarStats_bfed0b89{height:40px;padding:12px 4px;-webkit-box-sizing:border-box;box-sizing:border-box}.analyticsActionBar_bfed0b89{background-color:transparent;padding-left:0;padding-right:0}.isFluent .analyticsActionBar_bfed0b89{-webkit-box-sizing:border-box;box-sizing:border-box;border-top:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";height:35px}.isFluent .analyticsActionBar_bfed0b89 .ms-CommandBar-secondaryCommand .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link:hover{background-color:transparent}[dir='ltr'] .isFluent .analyticsActionBar_bfed0b89 .ms-CommandBar-secondaryCommand .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link .ms-Button-label{margin-right:0}[dir='rtl'] .isFluent .analyticsActionBar_bfed0b89 .ms-CommandBar-secondaryCommand .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link .ms-Button-label{margin-left:0}.isFluent .analyticsActionBar_bfed0b89 .ms-FocusZone.ms-CommandBar{height:34px}.analyticsActionBar_bfed0b89 .ms-FocusZone.ms-CommandBar{background-color:transparent;padding:0;height:36px}.analyticsActionBar_bfed0b89 .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link{background-color:transparent;min-width:0}[dir='ltr'] .analyticsActionBar_bfed0b89 .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link{padding-left:0}[dir='rtl'] .analyticsActionBar_bfed0b89 .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link{padding-right:0}.isFluent .analyticsActionBar_bfed0b89 .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link{min-width:0;height:32px;margin-top:1px;border-radius:2px;padding:0}.isFluent .analyticsActionBar_bfed0b89 .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link:hover{background-color:transparent}[dir='ltr'] .isFluent .analyticsActionBar_bfed0b89 .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link .ms-Button-icon{margin-left:4px}[dir='rtl'] .isFluent .analyticsActionBar_bfed0b89 .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link .ms-Button-icon{margin-right:4px}[dir='ltr'] .isFluent .analyticsActionBar_bfed0b89 .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link .ms-Button-icon{margin-right:20px}[dir='rtl'] .isFluent .analyticsActionBar_bfed0b89 .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link .ms-Button-icon{margin-left:20px}.analyticsActionBar_bfed0b89 .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link .ms-Button-textContainer{font-size:12px;font-weight:400}.analyticsActionBar_bfed0b89 .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link .ms-Button-icon,.analyticsActionBar_bfed0b89 .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link .ms-Button-textContainer{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.analyticsActionBar_bfed0b89 .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link:hover{background-color:transparent}.analyticsActionBar_bfed0b89 .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link:hover .ms-Button-textContainer{color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:"}[dir='ltr'] .analyticsActionBar_bfed0b89 .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link .ms-Button-icon{margin-left:0}[dir='rtl'] .analyticsActionBar_bfed0b89 .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link .ms-Button-icon{margin-right:0}\n"}]);var Xe=n(1385),Qe=function(e){var t=e.items,n=e.farItems,i=e.analyticsStats,o=e.isLink,s=e.showActionBar,c=void 0===s||s,l=!(!i||!i.itemAnalytics&&!i.isNotSupported&&i.status!==m.unsupport&&i.status!==m.failed),d=e.itemKey?a.createElement(Xe.ActionCommandBar,{className:"analyticsActionBar_bfed0b89",commands:t,farCommands:n}):a.createElement(ze.e,{className:"analyticsActionBar_bfed0b89",items:t,farItems:n});return a.createElement("div",null,a.createElement("div",{className:"analyticsActionBarStats_bfed0b89"},a.createElement(We.e,{width:"35%",isDataLoaded:l,shimmerElements:[{type:Je.e.line,height:8}]},a.createElement(F,Object(r.__assign)({isLink:o,isCompact:!0},i)))),c&&(n.length>0||t.length>0)&&d)};function Ge(e){var t=e.itemKey,n=a.useRef(null);return a.useEffect((function(){n.current&&e.updateCardHeight(n.current.clientHeight)})),a.createElement(s.WithItemCache,null,(function(i){var o,s=i.itemCache,c=s.demandItemFacet(l.fileNameFacet,t),u=c&&c.name,p=c&&c.extension,m=s.demandItemFacet(l.analyticsItemFacet,t),v=m&&m.itemKey,_=a.createElement("div",{className:Object(C.e)("fileHoverCardCompactCardTitle_7d060422",(o={},o.titleNotExpanded_7d060422=!n.current,o)),id:"ms-FileHoverCard-title","aria-label":E.format(O.hoverCardTitle,u)},u),b=a.createElement("div",{className:"fileHoverCardCompactCardTitleRegion_7d060422"},a.createElement(Ve.FileTypeIcon,{className:"fileHoverCardCompactCardFileIcon_7d060422",extension:p,size:32}),_);return a.createElement("div",{ref:n,className:Object(C.e)("fileHoverCardCompactCard_7d060422",{isFluent:!0})},b,!(!t||!v)&&function(e,t,n,i){var o=e.demandItemFacet(d.viewCountFacet,n),s=e.demandItemFacet(d.viewerCountFacet,n),c=e.demandItemFacet(d.likeCountFacet,n),u=e.demandItemFacet(d.commentCountFacet,n),p=e.demandItemFacet(l.openUrlFacet,t),m=e.demandItemFacet(d.activitiesFacet,n),v=m&&m.filter((function(e){return void 0!==e.access})),_=Object(ke.getTelemetry)(e).telemetry,C=Object(Oe.getItemEngagement)(e,{itemKey:t,engagement:{isIntentional:!0}}),b=e.isItemFacetResolved(d.viewCountFacet,n)||e.isItemFacetResolved(ve.errorFacet,n)?{activities:v||[],viewCount:o,viewerCount:s,likeCount:c,commentCount:u}:void 0,w=e.demandItemFacet(ge,t),S=ge.evaluate(w)(e,{itemKey:t}),x=S.showDetailsPane,D=S.showFileAnalytics,E={showDetails:x,showItemAnalytics:D,shareAction:a.createElement(f.ItemShareAction,{itemKey:t})},T=Object(r.__assign)({},y.selectedItemsControl.pack((function(){return{itemKeys:[t]}})));return a.createElement(h.ControlHandlerProvider,{controlHandlers:T},a.createElement(g.WithActionSet,{actions:E},(function(e){var n=e.actions,o=n.showDetails,s=n.showItemAnalytics,c=n.shareAction,l=o&&o.execute?function(){_($.Engagement).logData(Object(r.__assign)({name:"FileHoverCard.SeeDetailsClick"},C)),o.execute().catch((function(){}))}:void 0,d=s&&s.execute?function(){_($.Engagement).logData(Object(r.__assign)({name:"FileHoverCard.ViewCountClick"},C)),s.execute().catch((function(){}))}:void 0,u=c&&c.isAvailable?function(e){e&&i&&(e.target=i,e.persist(),c.execute({event:e}),_($.Engagement).logData(Object(r.__assign)({name:"FileHoverCard.CommandBar.ShareClick"},C)))}:void 0,m=Object(r.__spreadArrays)(o&&o.isAvailable?[{key:"details",title:O.seeDetails,name:O.seeDetails,ariaLabel:O.seeDetails,onClick:l}]:[]),f={key:"share",iconProps:{iconName:"share"},title:O.Share,onClick:u},h={itemAnalytics:b,isCompact:!0,isLink:s&&s.isAvailable,pageUrl:p,onClick:d,itemKey:t},g=[];return u&&g.push(f),Object(ne.isSaveForLaterOn)()&&Ke.followCommand.action&&Ke.followCommand.onClick&&g.unshift(Object(r.__assign)(Object(r.__assign)({},Ke.followCommand),{iconOnly:!0,name:void 0})),a.createElement(Qe,{itemKey:t,analyticsStats:h,items:g,withFacePile:!0,farItems:m})})))}(s,t,v,e.target))}))}var Ze=n(236),Ye=n(1387),$e=n(231),et=function(e){function t(t){var n=e.call(this,t)||this;return n._dynamicCompactCardHeight=function(e){n.state.compactCardHeight!==e&&n.setState({compactCardHeight:e})},n._dynamicExpandedCardHeight=function(e){var t=n.state.expandedCardHeight;e&&t!==e&&n.setState({expandedCardHeight:e})},n.state={visible:!1,expandedCardHeight:1,compactCardHeight:131},n._isFirstTimeOpenCard=!0,n}return Object(r.__extends)(t,e),t.prototype.componentDidCatch=function(e,t){this._hoverCardRenderQos&&this._hoverCardRenderQos.end({error:e.name+"_"+e.message,extraData:{stack:e.stack,errorInfo:JSON.stringify(t)},resultCode:e.name,resultType:H.ResultTypeEnum.Failure})},t.prototype.render=function(){var e=this,t=this.props,n=t.itemKey,c=t.cardDismissDelay,l=void 0===c?300:c,p=t.directionalHint,m=void 0===p?o.e.rightTopEdge:p,f=t.gapSpace,h=void 0===f?8:f,g=t.target;if(!n||!g)return null;var y,v,_,C,b,w={expandedCardScroll:"fileHoverCardExpandedCardHostScroll_7d060422"},S=Object(r.__assign)({root:{boxShadow:Object(u.w)().effects.elevation16,borderRadius:"2px",width:"320px",selectors:{".ms-Callout-main":{borderRadius:"2px"}}},expandedCard:[{selectors:{":before":{display:"none"}}}]},w),x=new ee(this.props.telemetry($.Engagement));return a.createElement(s.WithItemCache,null,(function(t){var r=t.itemCache;if(e.state.visible){var o=e._demandFacets(r),s=o.itemAnalyticsKey,c=o.keyPointsData,u=o.itemName,p=o.recommendedActions,f=o.conversations,w=o.viewActivities,D=o.relatedItemKeys,E=r.isItemFacetResolved(d.viewCountFacet,s),T=r.isItemFacetResolved(ve.errorFacet,s),k=T?r.demandItemFacet(ve.errorFacet,s):void 0;if(e._errorMessage=k&&k.message,e._isViewCountDataError=T&&!E,y=Be(c),v=!!u&&Le(u.extension,p),_=je(f),C=He(w),b=Ue(D),r.demandItemFacet(ve.errorFacet,n,{suppressGetItems:!0}))return null}var O=Object(Oe.getItemEngagement)(r,{itemKey:n,engagement:{isIntentional:!0}});x.engagementData=O;var I={onRenderCompactCard:function(){return a.createElement(Ge,{itemKey:n,target:g,updateCardHeight:e._dynamicCompactCardHeight})},onRenderExpandedCard:function(){return a.createElement(Ne,{itemKey:n,target:g,onCardExpand:function(t){return e._onCardExpand(t,O)}})},compactCardHeight:e.state.compactCardHeight,expandedCardHeight:e.state.expandedCardHeight,directionalHint:m,directionalHintFixed:!1,gapSpace:h,styles:S};return a.createElement(ke.TelemetryProvider,{withContext:{component:"FileHoverCard"}},a.createElement(te.Provider,{value:x},a.createElement(i.e,{expandingCardProps:I,cardDismissDelay:l,expandedCardOpenDelay:500,target:e.props.target,onCardVisible:function(){return e._onCardOpen(O)},onCardHide:function(){return e._onCardHide(O,y,v,_,C,b)},trapFocus:!0})))}))},t.prototype._demandFacets=function(e){var t,n=e.demandItemFacet(l.analyticsItemFacet,this.props.itemKey),r=n&&n.itemKey,a=e.demandItemFacet(d.keyPointsFacet,r),i=e.demandItemFacet(l.fileNameFacet,this.props.itemKey),o=e.demandItemFacet(d.recommendedActionsFacet,r),s=e.demandItemFacet(d.conversationsFacet,r),c=e.demandItemFacet(d.activitiesFacet,r),u=c&&c.filter((function(e){return void 0!==e.access}));if(Object(ne.isRelatedFilesApiCallEnabled)()){var p=e.demandItemFacet(l.relatedFilesItemSetFacet,this.props.itemKey),m=e.demandItemFacet(Ie.childItemsFacet,p&&p.itemKey);t=m&&m.itemKeys}return{analyticsKey:n,itemAnalyticsKey:r,keyPointsData:a,itemName:i,recommendedActions:o,conversations:s,activities:c,viewActivities:u,relatedItemKeys:t}},t.prototype._onCardOpen=function(e){var t=this;if(!$e.Killswitch.isActivated("b0d3df87-b7df-4431-a2ed-e94568d478c9","12/17/2019","Pre-fetch file card API calls")){var n=this.props.itemCacheDispatch;n(Object(Ze.demandItems)((function(e){return t._demandFacets(e)}),{flushOperationQueue:!0})),n(Object(Ye.forceStoreUpdate)())}this.props.telemetry($.Engagement).logData(Object(r.__assign)({name:"FileHoverCard.CompactCardOpen"},e)),this._cardOpenTimeStamp=Date.now(),this.setState({visible:!0}),this._isFirstTimeOpenCard&&(this._hoverCardRenderQos=new(this.props.telemetry(H.Qos))({name:"ItemScope_FileHoverCardRender"}))},t.prototype._onCardHide=function(e,t,n,a,i,o){var s=Date.now()-this._cardOpenTimeStamp,c=this.state.expandedCardHeight>1,l=c&&s>2500?"FileHoverCard.DwellTimeLong":"FileHoverCard.DwellTime";this.props.telemetry($.Engagement).logData(Object(r.__assign)(Object(r.__assign)({name:l},e),{extraData:Object(r.__assign)(Object(r.__assign)({},e.extraData),{time:s,compactCardOpen:1===this.state.expandedCardHeight,expandedCardOpen:c,keyPoints:t,recommendedActions:n,conversations:a,viewers:i,relatedFiles:o})})),this._isFirstTimeOpenCard&&(this._hoverCardRenderQos.end({resultType:H.ResultTypeEnum.Success}),this._isFirstTimeOpenCard=!1),this.setState({visible:!1})},t.prototype._onCardExpand=function(e,t){this._dynamicExpandedCardHeight(e),!this._isCardExpanded&&e>1&&(this.props.telemetry($.Engagement).logData(Object(r.__assign)({name:"FileHoverCard.ExpandedCardOpen"},t)),this._isCardExpanded=!0),this._isFirstTimeOpenCard&&(this._isViewCountDataError?this._hoverCardRenderQos.end({resultType:H.ResultTypeEnum.Failure,resultCode:"NoViewCount",error:this._errorMessage}):this._hoverCardRenderQos.end({resultType:H.ResultTypeEnum.Success}),this._isFirstTimeOpenCard=!1)},t.defaultProps={itemKey:""},t}(a.Component);var tt=Object(Ae.connectToItemCache)()(Object(ke.withTelemetry)()(et)),nt=Object(c.withCurrentItem)()(tt)},671:function(e,t,n){"use strict";n.r(t);var r=n(825);n.d(t,"composeRenderFunctions",(function(){return r.e}))},892:function(e,t,n){"use strict";n.r(t),n.d(t,"WithItemCache",(function(){return o}));var r=n(1),a=n(8),i=n(134),o=Object(a.connectToItemCache)((function(e,t){var n=t.children,r=e.dispatch;return{children:Object(i.renderChildrenWithProps)(n,{itemCache:e,dispatch:r})}}),(function(){return{}}))(r.Fragment);o.displayName="WithItemCache"},904:function(e,t,n){e.exports=n(912)},912:function(e,t,n){"use strict";n.r(t);var r=n(346),a=function(){function e(e){this._promise=new r.SignalPromise(e)}return e.prototype.getPromise=function(){return this._promise},e.prototype.cancel=function(){this._promise.cancel()},e.prototype.complete=function(e){this._promise._completed(e)},e.prototype.error=function(e){this._promise._error(e)},e}();t.default=a},913:function(e,t,n){e.exports=n(930)},914:function(e,t,n){e.exports=n(256)},924:function(e,t,n){"use strict";n.d(t,"t",(function(){return d})),n.d(t,"e",(function(){return p}));var r=n(0),a=n(1),i=n(142),o={INPUT:!0,TEXTAREA:!0};function s(e){var t;return t=function(e){var t;if(e>=65&&e<=91)t=String.fromCharCode(e);else switch(e){case 8:t="Backspace";break;case 9:t="Tab";break;case 13:t="Enter";break;case 27:t="Esc";break;case 32:t="Space";break;case 37:t="Left";break;case 38:t="Up";break;case 39:t="Right";break;case 40:t="Down";break;case 46:t="Delete";break;case 113:t="F2";break;case 191:t="/";break;case 121:t="F10";break;default:t=""}return t}(e.keyCode),e.metaKey&&(t="Meta"+t),e.ctrlKey&&(t="Ctrl"+t),e.altKey&&(t="Alt"+t),e.shiftKey&&(t="Shift"+t),t}var c=n(207),l={},d=function(){function e(e){var t=this;this._shortcuts={},this.registerKeyboardShortcut=function(e){for(var n=e.keySequences,r={description:e.description,onExecute:e.onExecute},a=t._shortcuts,i=0,o=n;i<o.length;i++){var s=o[i];(a[s]||(a[s]=[])).push(r)}return function(){for(var e=0,t=n;e<t.length;e++){var i=t[e],o=a[i];if(o){var s=o.indexOf(r);s>-1&&(o.length>1?o.splice(s,1):delete a[i])}}}},this.registerActiveChild=function(e){var n=t._hasActiveChildren,r=t._parent;e?(t._hasActiveChildren++,n||r&&r.registerActiveChild(!0),i.e.raise(t,"change")):(t._hasActiveChildren--,t._hasActiveChildren||r&&r.registerActiveChild(!1),i.e.raise(t,"change"))},this.hasActiveChildren=function(){return t._hasActiveChildren>0},this.setIsActive=function(e){if(e!==t._isActive){t._isActive=e;var n=t._parent;n&&n.registerActiveChild(e),i.e.raise(t,"change")}},this._onFocusOrBlur=function(e,n){void 0===n&&(n=!0);var r=t._getActiveManager();r!==t._activeManager&&(t._activeManager&&t._activeManager.setIsActive(!1),t._activeManager=r,r.setIsActive(!0)),n&&setTimeout((function(){t._onFocusOrBlur(e,!1)}),0)},this._onProcessKeys=function(e){if((t._isActive||t._isDefault)&&!t._hasActiveChildren){var n=e.target;if(!n||!function(e){var t=e;return t&&(t.tagName in o||t.isContentEditable)}(n)){var a=s(e),i=t._shortcuts[a];if(i)for(var c=0,l=Object(r.__spreadArrays)(i);c<l.length;c++){(0,l[c].onExecute)(),e.preventDefault()}}}};var n=e.isDefault,a=void 0!==n&&n,c=e.id;l[c]=this,this._events=new i.e(this),this._isDefault=a,this._parent=e.parent,this._isActive=!1,this._hasActiveChildren=0,this._id=c,this._shortcuts={},this._events.on(document,"keydown",this._onProcessKeys),this._parent||(this._onFocusOrBlur(),this._events.on(document,"focus",this._onFocusOrBlur,!0),this._events.on(document,"blur",this._onFocusOrBlur,!0))}return e.prototype.dispose=function(){var e=this._parent;e&&this._isActive&&e.registerActiveChild(!1),this._events.dispose(),delete l[this._id]},e.prototype.getIsActive=function(){return this._isActive||this._isDefault},e.prototype._getActiveManager=function(){var e=document.activeElement;if(!document.activeElement)return this;var t=Object(c.e)(e,(function(e){return e.hasAttribute("data-keyboard-zone-id")}));if(t){var n=t.getAttribute("data-keyboard-zone-id");if(n){var r=l[n];if(r)return r}}return this},e}(),u={keyboardManager:new d({isDefault:!0,id:"0"})},p=a.createContext(u)},929:function(e,t,n){"use strict";var r;n.r(t),function(e){e[e.none=0]="none",e[e.session=1]="session",e[e.local=2]="local",e[e.sharedMemory=3]="sharedMemory"}(r||(r={})),t.default=r},930:function(e,t,n){"use strict";n.r(t);var r=n(125);for(var a in r)["default"].indexOf(a)<0&&function(e){n.d(t,e,(function(){return r[e]}))}(a);n.d(t,"default",(function(){return r.Engagement}))},936:function(e,t,n){"use strict";n.r(t),n.d(t,"KeyboardShortcut",(function(){return i}));var r=n(1),a=n(924);function i(e){var t=r.useContext(a.e).keyboardManager,n=e.keySequences,i=e.description,o=e.onExecute;return r.useEffect((function(){return t.registerKeyboardShortcut({keySequences:n,description:i,onExecute:o})}),[n,i,o]),null}},938:function(e,t,n){e.exports=n(892)},944:function(e,t,n){"use strict";n.d(t,"e",(function(){return i}));var r=n(0),a=n(34);function i(e,t){return function(n,i){var o=n.eventData,s=o.extraData,c={performanceEntry:s&&s.performanceEntry,httpStatus:s&&s.HttpStatus,correlationId:s&&s.CorrelationId,succeeded:o&&o.resultType===a.ResultTypeEnum.Success||!1,resultCode:o&&o.resultCode,endpoint:i},l=t&&t(n),d=e.onRequestComplete(c);return s.dataSyncQos=e.getQosInfo(),Object(r.__assign)(Object(r.__assign)({},l||{}),{eventData:Object(r.__assign)(Object(r.__assign)({},l?l.eventData:o),{extraData:Object(r.__assign)(Object(r.__assign)({},l?l.eventData.extraData:o.extraData),e.getQosInfo())}),canRetry:d&&(!l||l.canRetry)})}}},945:function(e,t,n){e.exports=n(946)},946:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(520),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype.attached=function(e){var t=this,n=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return t.attach(e.apply(this,n)||this)};if("undefined"!=typeof DEBUG&&DEBUG){var r=n;n=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return r.apply(Object.create(e.prototype),t)}}return n.prototype=e.prototype,n},t}(a.Scope);t.default=i},959:function(e,t,n){e.exports=n(145)},975:function(e,t,n){"use strict";n.r(t),n.d(t,"ENABLE_PARAM_KEY",(function(){return l})),n.d(t,"DISABLE_PARAM_KEY",(function(){return d}));var r=n(429),a=n(526),i=n(683),o=n(976),s=n(929),c=n(263),l="enableFeatures",d="disableFeatures",u={ODB:587,ODC:"AllowFeatureOverrides",Fallback:!1},p={ODB:357,ODC:null,Fallback:!1},m={ODB:342,ODC:null,Fallback:!1},f={},h=new o.default("FeatureOverrides",s.default.session),g="FeatureOverrides_"+l,y="FeatureOverrides_"+d;function v(e){var t=document.cookie.match("(^|;)\\s*"+e+"\\s*=\\s*([^;]+)");return t?t.pop():""}var _=function(){function e(){}return Object.defineProperty(e,"Overrides",{get:function(){return f},enumerable:!0,configurable:!0}),e.evaluateCanOverride=function(){"undefined"!=typeof DEBUG&&DEBUG?e.CanOverride=!0:e.CanOverride=r.default.isFeatureEnabled(u)||r.default.isFeatureEnabled(p)||r.default.isFeatureEnabled(m)},e.isFeatureEnabled=function(t,n){if(e.CanOverride){if(t.ODB in f)return f[t.ODB];if(t.ODC in f)return f[t.ODC]}return n?Object(a.e)(t,n):r.default.isFeatureEnabled(t)},e.AllowFeatureOverrides=u,e.SPODebugOnlyCookieRedirect=p,e}();t.default=_,_.evaluateCanOverride(),_.CanOverride&&function(){var e=c.Killswitch.isActivated("CA76C674-5DEE-4C8A-9EDF-82C275E0CF01","11/27/2018","Don't save enable/disable features query params to session storage");if(e){var t=h.getValue("Store");f=t||{}}else f=function(){var e={},t=v(g);if(t)for(var n=0,r=t.split(",");n<r.length;n++){e[r[n]]=!0}var a=v(y);if(a)for(var i=0,o=a.split(",");i<o.length;i++){e[o[i]]=!1}return e}();var n=location.search?location.search.substring(1):"",r=i.deserializeQuery(n),a=r[l];if(a)for(var o=0,s=a.split(",");o<s.length;o++){var u=s[o];f[u]=!0}var p=r[d];if(p)for(var m=0,_=p.split(",");m<_.length;m++){u=_[m];f[u]=!1}e?h.setValue("Store",f):function(e){var t=[],n=[];for(var r in e)(e[r]?t:n).push(r);document.cookie=g+"="+t.join(",")+";path=/",document.cookie=y+"="+n.join(",")+";path=/"}(f)}()},976:function(e,t,n){"use strict";n.r(t);var r=n(929),a=function(){function e(t,n){(void 0===n&&(n=r.default.none),e.init(),this.dataStoreKey=t,this.defaultCachingType=n,n===r.default.none)?this.dataStore={}:(void 0===e._dataStore[this.dataStoreKey]&&(e._dataStore[this.dataStoreKey]={}),this.dataStore=e._dataStore[this.dataStoreKey])}return e.hasStorageType=function(t){switch(e.init(),t){case r.default.none:case r.default.sharedMemory:return!0;case r.default.session:return!!e._sessionStorage;case r.default.local:return!!e._localStorage}return!1},e.init=function(){if(!e._initialized){try{"localStorage"in window&&window.localStorage&&e.testStorage(window.localStorage)&&(e._localStorage=window.localStorage)}catch(e){}try{"sessionStorage"in window&&window.sessionStorage&&e.testStorage(window.sessionStorage)&&(e._sessionStorage=window.sessionStorage)}catch(e){}null==e._localStorage&&(e._localStorage=e._sessionStorage),e._initialized=!0}},e.testStorage=function(e){var t="BrowserStorageTest",n=!1;try{e.setItem(t,"1"),"1"===e.getItem(t)&&(n=!0),e.removeItem(t)}catch(e){}return n},e.prototype.setValue=function(e,t,n,r){void 0===r&&(r=!0),e=r?this.normalizeKey(e):e,this.dataStore[e]=t;var a=this.getStorage(n);if(a)try{var i=[],o=JSON.stringify(t,(function(e,t){if("object"==typeof t&&null!==t){if(-1!==i.indexOf(t))return;i.push(t)}return t}));i=null,a.setItem(this.dataStoreKey+e,o)}catch(e){}},e.prototype.getValue=function(e,t,n){void 0===n&&(n=!0),e=n?this.normalizeKey(e):e;var r=this.dataStore[e],a=this.getStorage(t);if(void 0===r&&a){var i=a.getItem(this.dataStoreKey+e);if(i)try{r=JSON.parse(i),this.dataStore[e]=r}catch(e){r=void 0}}return r},e.prototype.remove=function(e,t,n){void 0===n&&(n=!0),e=n?this.normalizeKey(e):e;var r=this.getStorage(t);r&&r.removeItem(this.dataStoreKey+e),delete this.dataStore[e]},e.prototype.getStorage=function(t){switch(t||this.defaultCachingType){case r.default.none:case r.default.sharedMemory:return null;case r.default.session:return e._sessionStorage;case r.default.local:return e._localStorage}return null},e.prototype.normalizeKey=function(e){return e&&e.toLowerCase()||""},e._sessionStorage=null,e._localStorage=null,e._dataStore={},e._initialized=!1,e}();t.default=a},977:function(e,t,n){"use strict";var r;n.r(t),n.d(t,"DataSyncEntityType",(function(){return r})),n.d(t,"NucleusPreviewEnabled",(function(){return a})),n.d(t,"isDataSyncEnabled",(function(){return i})),function(e){e.SharePointList="SharePointList"}(r||(r={}));var a={ODB:1620};function i(e,t){return e(a)&&(window.localStorage&&"true"===window.localStorage.NucleusPreviewEnabled||/[?&]enableNucleusPreview=true/.test(location.search))}},995:function(e,t,n){"use strict";n.r(t),n.d(t,"getSyncTelemetryHandler",(function(){return O.e})),n.d(t,"isQosEndSchemaOverride",(function(){return A})),n.d(t,"DataRequestor",(function(){return P}));var r=n(0),a=n(106),i=n.n(a),o=n(1015),s=n.n(o),c=n(149),l=n.n(c),d=n(913),u=n(183),p=n(1013),m=n(52),f=n(38),h=n(445),g=function(e){function t(n){var a=this,i=n.errorData,o=void 0===i?n.innerError instanceof t&&n.innerError.errorData||{status:0}:i,s=o.message,c=void 0===s?void 0:s,l=o.correlationId,d=void 0===l?void 0:l,u=o.code,p=void 0===u?void 0:u,m=Object(r.__rest)(o,["message","correlationId","code"]),f="object"==typeof c?c?"string"==typeof c.value?c.value:JSON.stringify(c):""+c:c,h=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},"string"==typeof d?{correlationId:d}:{}),"string"==typeof p?{code:p}:{}),"string"==typeof f?{message:f}:{}),n),{extraData:Object(r.__assign)(Object(r.__assign)({},n.extraData||{}),{hasAuthChallenge:!!m.authenticate,status:m.status,infected:m.infected,groupThrottle:m.groupThrottle,statusText:m.statusText})});(a=e.call(this,h)||this).name="GetDataError",a.errorData=o;for(var g=0,y=Object.keys(m);g<y.length;g++){var v=y[g];a[v]=m[v]}return a}return Object(r.__extends)(t,e),t}(m.ApiError),y=n(186),v=n.n(y),_=n(945),C=n.n(_),b=n(513),w=n.n(b),S=n(904),x=n.n(S),D=n(433),E=n.n(D);var T=function(){function e(e,t,n){this._request=e,this._url=t,this._webAbsoluteUrl=n&&n.webAbsoluteUrl,this._isCanaryRequest=n&&n.isCanaryRequest}return e.prototype.getSourceUrl=function(){return this._url},e.prototype.getAllResponseHeaders=function(){return this._request.getAllResponseHeaders()},e.prototype.getCorrelationId=function(){return this.getResponseHeader("SPRequestGuid")},e.prototype.getGroupThrottle=function(){return this.getResponseHeader("SPGroupThrottle")},e.prototype.getAuthErrorType=function(){return this.getResponseHeader("x-ms-diagnostics")},e.prototype.getMSCorrelationVector=function(){return this.getResponseHeader("MS-CV")},e.prototype.getServiceWorkerDataSourceHeader=function(){return this.getResponseHeader("X-SERVICEWORKER-DATA-SOURCE")},e.prototype.getServiceWorkerFetchInfoFromHeader=function(){return this.getResponseHeader("X-ServiceWorkerFetchInfo")},e.prototype.getRetryAfterHeader=function(){var e=this.getResponseHeader("Retry-After"),t=Number(e);return isNaN(t)?void 0:t},e.prototype.getStatus=function(){try{return this._request.status}catch(e){}},e.prototype.getAuthenticationRedirect=function(){return this.getResponseHeader("X-Forms_Based_Auth_Required")},e.prototype.getAuthenticateHeader=function(){return this.getResponseHeader("WWW-Authenticate")},e.prototype.getResponseType=function(){return this._request.responseType},e.prototype.getResponseText=function(){return this._request.responseType&&"text"!==this._request.responseType?this._request.response:this._request.responseText},e.prototype.getErrorResponseText=function(){return"blob"===this._request.responseType?{status:this._request.status,statusText:this._request.statusText,infected:!!this.getResponseHeader("x-virus-infected"),authenticate:this.getResponseHeader("WWW-Authenticate")}:this.getResponseText()},e.prototype.parseError=function(){var e=this,t=new x.a;return this._request.responseType&&"text"!==this._request.responseType?"blob"===this._request.responseType?function(e){var t,n=new x.a,r=function(){if(t.result){var e=void 0;try{e=JSON.parse(t.result),n.complete(e)}catch(e){n.complete({message:"Unable to parse blob result."})}}},a=function(){n.complete({message:"Unable to read blob error response."})};try{(t=new FileReader).addEventListener("load",r),t.addEventListener("error",a),t.readAsText(e)}catch(e){a()}return n.getPromise().then((function(e){return t&&(t.removeEventListener("load",r),t.removeEventListener("error",a)),e}))}(this._request.response).then((function(n){var r={data:n,status:e.getStatus(),statusText:e._request.statusText,infected:!!e.getResponseHeader("x-virus-infected"),authenticate:e.getResponseHeader("WWW-Authenticate")};t.complete(r)})):t.complete(this._request.response):t.complete(this._request.responseText),t.getPromise()},e.prototype.getValue=function(t){var n;switch(t){case e.DataValueKeys.SourceURL:n=this.getSourceUrl();break;case e.DataValueKeys.CorrelationId:n=this.getCorrelationId();break;case e.DataValueKeys.Status:n=this.getStatus();break;case e.DataValueKeys.AuthenticationRedirect:n=this.getAuthenticationRedirect();break;case e.DataValueKeys.ResponseText:n=this.getResponseText();break;case e.DataValueKeys.ErrorResponseText:n=this.getErrorResponseText()}return n},e.prototype.getRedirectUrl=function(){if(this._isCanaryRequest)return 403===this.getStatus()?this.shouldRedirectToErrorCustomPromptLocation()?this.getRedirectToErrorCustomPromptLocation():this.getRedirectLoginPageUrl():this.getAccessDeniedRedirectUrl();if(403===this.getStatus()){if(this.shouldRedirectToErrorCustomPromptLocation())return this.getRedirectToErrorCustomPromptLocation()}else if(401===this.getStatus()&&this.shouldRedirectToErrorCustomPromptLocation())return this.getRedirectToErrorCustomPromptLocation()},e.prototype.getRedirectLoginPageUrl=function(){var e,t=this.getAuthenticationRedirect();if(t){var n=new v.a(t);n.setQueryParameter("ReturnUrl",E.a.encodeURIComponent(window.location.href)),e=n.toString()}return e},e.prototype.getAccessDeniedRedirectUrl=function(){var e;if(this._webAbsoluteUrl){var t=this._webAbsoluteUrl+"/_layouts/15/AccessDenied.aspx";if(t){var n=new v.a(t);n.setQueryParameter("Source",E.a.encodeURIComponent(window.location.href)),n.setQueryParameter("Type","list"),n.setQueryParameter("correlation",E.a.encodeURIComponent(this.getCorrelationId())),e=n.toString()}}return e},e.prototype.getRedirectToErrorCustomPromptLocation=function(){var e=this.getResponseHeader("X-SPO-ErrorCustomPromptLocation"),t=new v.a(e);return t.setQueryParameter("ReturnUrl",window.location.href),t.toString()},e.prototype.shouldRedirectToErrorCustomPromptLocation=function(){var e=this.getResponseHeader("X-SPO-ErrorCode"),t=this.getResponseHeader("sharepointerror");return"9.3"===e||"-2130575129"===t},e.prototype.getResponseHeadersDictionary=function(){var e={},t=this.getAllResponseHeaders();if(t){var n=t.trim().split(/[\r\n]+/);n&&n.length>0&&n.forEach((function(t){var n=t.split(": "),r=n.shift(),a=n.join(": ");e[r]=a}))}return this.getResponseHeadersDictionary=function(){return e},e},e.prototype.getResponseHeader=function(e){var t=this.getResponseHeadersDictionary();return t[e.toLowerCase()]||t[e]},e.DataValueKeys={SourceURL:"SourceUrl",CorrelationId:"CorrelationId",Status:"Status",AuthenticationRedirect:"AuthenticationRedirect",ResponseText:"ResponseText",ErrorResponseText:"ErrorResponseText",GroupThrottle:"GroupThrottle"},e}();var k=function(){function e(e){void 0===e&&(e={}),this._scope=new C.a,this._events=this._scope.attach(new w.a(this));var t=e.webAbsoluteUrl||e.webUrl;this._webServerRelativeUrl=e.webServerRelativeUrl||t&&new v.a(t).getPath(),"/"===this._webServerRelativeUrl&&(this._webServerRelativeUrl=""),t?(this._webAbsoluteUrl=t,this._alwaysGetDigest=!0):this._alwaysGetDigest=!1,this._needsRequestDigest=!1!==e.needsRequestDigest,this._needsRequestDigest&&this._tryLoadDigest(e.formDigest),this._requestCanaryForAuth=!1,this._engagement=e.engagement,this._operationName=e.operationName}return e._isValidFormDigest=function(e){return e&&e.serverTime&&Date.now()-new Date(e.serverTime).getTime()<1e3*(e.formDigestTimeoutSeconds-60)},e.prototype.dispose=function(){this._scope.dispose()},e.prototype.abort=function(){if(this._currentRequest){var e=this._currentRequest;e.isCancelled=!0,e.abort(),this._currentRequest=void 0}},e.prototype.isRequestActive=function(){return!!this._currentRequest},e.prototype.getServerDataFromUrl=function(e){var t=this,n=e.url,r=e.successCallback,a=e.failureCallback,i=e.uploadProgressCallback,o=e.additionalPostData,s=e.isRest,c=void 0===s||s,l=e.method,d=void 0===l?"POST":l,u=e.withCredentials,p=e.additionalHeaders,m=e.contentType,f=e.noRedirect,h=e.responseType,g=e.needsRequestDigest,y=void 0===g?this._needsRequestDigest:g,v=(new Date).toISOString(),_=new XMLHttpRequest;_.open(d,n,!0),"boolean"==typeof u&&(_.withCredentials=u),h&&(_.responseType=h),m?_.setRequestHeader("Content-Type",m):c?_.setRequestHeader("Content-Type","application/json;odata=verbose"):_.setRequestHeader("Content-Type","application/x-www-form-urlencoded");var C=!1;if(p)for(var b in p)b&&(_.setRequestHeader(b,p[b]),"accept"===b.toLowerCase()&&(C=!0));C||_.setRequestHeader("accept","application/json;odata=verbose"),this._currentRequest=_;var w=function(e){y&&e&&_.setRequestHeader("x-requestdigest",e),t._events.on(_,"readystatechange",(function(){t._onReadyStateChange(_,n,r,a,f,v)})),i&&_.upload&&t._events.on(_.upload,"progress",(function(e){i(e)})),_.send(o)};y?this._ensureRequestDigest(w,a):w()},e.prototype.ensureRequestDigest=function(e,t){this._ensureRequestDigest(e,t)},e.prototype._ensureRequestDigest=function(t,n){var r=e._formDigests[this._webServerRelativeUrl];!this._alwaysGetDigest&&e._isValidFormDigest(r)?t(r.formDigestValue):this._ensureRequestDigestWorker(t,n)},e.prototype._ensureRequestDigestWorker=function(t,n){var r=this,a=new Date,o=new e({needsRequestDigest:!1,webServerRelativeUrl:this._webServerRelativeUrl,webUrl:void 0});t||(o._requestCanaryForAuth=!0);var s=this._webAbsoluteUrl||this._webServerRelativeUrl;"string"==typeof s?(e._requestDigestPromise||(e._requestDigestPromise=new i.a((function(i,c){o.getServerDataFromUrl({url:v.a.concatenate(s,"/_api/contextinfo"),successCallback:function(t){var n=t.getResponseText(),o=JSON.parse(n).d.GetContextWebInformation;e._formDigests[r._webServerRelativeUrl]={serverTime:a.toISOString(),formDigestValue:o.FormDigestValue,formDigestTimeoutSeconds:o.FormDigestTimeoutSeconds-60,updateFormDigestPageLoaded:new Date},i(e._formDigests[r._webServerRelativeUrl].formDigestValue),e._requestDigestPromise=void 0},failureCallback:function(r,a){t?t(void 0):n&&n(r,a),c(void 0),e._requestDigestPromise=void 0},method:"POST",noRedirect:!!n})}))),e._requestDigestPromise.then((function(e){return t&&t(e),e}))):n&&n(void 0,new m.ApiError({code:"MissingWebForDigestAuth",isExpected:!1}))},e.prototype._onReadyStateChange=function(t,n,r,a,i,o){var s;if(4===t.readyState)if(this._currentRequest=void 0,this._events.off(t),t.upload&&this._events.off(t.upload),(s=t)&&s.isCancelled)a(void 0,new m.ApiError({code:"RequestAborted",isExpected:!0}));else if(function(e){try{if(4===e.readyState&&(void 0===e.status||0===e.status))return!1}catch(e){return!1}return!0}(t)){var c=new T(t,n,{webAbsoluteUrl:this._webAbsoluteUrl||this._webServerRelativeUrl,isCanaryRequest:this._requestCanaryForAuth}),l=c.getStatus(),d=!i&&c.shouldRedirectToErrorCustomPromptLocation();if(this._requestCanaryForAuth){if(this._requestCanaryForAuth=!1,403===l){var u=c.getRedirectLoginPageUrl();try{d?window.location.href=c.getRedirectToErrorCustomPromptLocation():a(c)}catch(e){}u&&!i&&(window.location.href=u)}else{u=c.getAccessDeniedRedirectUrl();try{a(c)}catch(e){}u&&!i&&(this._engagement&&this._engagement.logData({name:"AccessDeniedRedirect",isIntentional:!1,extraData:{originalOperation:this._operationName||""}}),window.location.href=u)}return}if(200===l||201===l||204===l)return void r(c);if(403===l)return e._requestDigestPromise=void 0,void(i?this._ensureRequestDigestWorker(void 0,(function(e,t){return a(c,t)})):d?window.location.href=c.getRedirectToErrorCustomPromptLocation():this._ensureRequestDigestWorker(void 0));401===l&&d&&(window.location.href=c.getRedirectToErrorCustomPromptLocation()),a(c)}else a(void 0,new m.ApiError({code:"NoConnection",isExpected:!0}))},e.prototype._tryLoadDigest=function(t){if(e._isValidFormDigest(t))e._formDigests[this._webServerRelativeUrl]=t;else{var n=e._formDigests[this._webServerRelativeUrl];e._isValidFormDigest(t)&&(!e._isValidFormDigest(n)||n&&new Date(n.serverTime).getTime()<new Date(t.serverTime).getTime())&&(e._formDigests[this._webServerRelativeUrl]=t)}},e._formDigests={},e._requestDigestPromise=void 0,e}(),O=n(944),I="undefined"!=typeof window?window:void 0,R=I&&I.performance;function A(e){return"object"==typeof e}var P=function(){function e(e,t){this._pageContext=t?t.pageContext:e.pageContext,this._tokenProvider=t&&t.tokenProvider,this._qosName=e.qosName,this._apiEvent=t&&t.apiEvent||l.a,this._engagement=t&&t.engagement||d.Engagement,this._normalizeErrors=!!e.normalizeErrors}return e.parseJSON=function(e){return e&&JSON.parse(e)||void 0},e.prototype.getData=function(t){var n=this,a=t.url,o=t.parseResponse,c=void 0===o?e.parseJSON:o,l=t.qosExtraData,d=t.telemetryHandler,y=t.additionalPostData,v=void 0===y?"":y,_=t.contentType,C=t.method,b=void 0===C?"POST":C,w=t.maxRetries,S=void 0===w?0:w,x=t.responseType,D=t.onUploadProgress,E=t.timeout,T=t.authToken,O=t.noTimeoutInLastRetry,A=void 0!==O&&O,P=t.useExactAuthToken,N=void 0!==P&&P,B=!0,L=this._pageContext,j=this._tokenProvider,H=function(e){var o=t.crossSiteCollectionCall,y=void 0!==o&&o,C=t.noRedirect,w=void 0!==C&&C,T=t.needsRequestDigest,O=void 0===T||T,P=t.additionalHeaders?Object(r.__assign)({},t.additionalHeaders):void 0;if(e){var F=N?e:"Bearer "+e;if(P){var j=!1;for(var H in P)H&&"authorization"===H.toLowerCase()&&(j=!0);j||(P.Authorization=F)}else P={Authorization:F};y=!0,O=!1,w=!0}var U=new k(Object(r.__assign)(Object(r.__assign)({},L?{webServerRelativeUrl:L.webServerRelativeUrl,webAbsoluteUrl:y?L.webAbsoluteUrl:void 0,formDigest:{serverTime:L.serverTime,updateFormDigestPageLoaded:L.updateFormDigestPageLoaded,formDigestValue:L.formDigestValue,formDigestTimeoutSeconds:L.formDigestTimeoutSeconds}}:{}),{needsRequestDigest:O,engagement:n._engagement,operationName:n._qosName})),M=[];n._qosName&&M.push(n._qosName),t.qosName&&M.push(t.qosName);var q,K,V=M.join("."),z=I&&I.location&&new f.SimpleUri(I.location.href).authority,W=new f.SimpleUri(a).authority,J=p.RUMOneLogger.getRUMOneLogger(),X=Date.now();return J&&(Boolean(J.readTempData("appDataFetchStart"))||J.saveTempData("appDataFetchStart",X)),function(e){var t,n=e.onExecute,r=e.onCancel,a=e.timeout,o=e.canRetry,c=e.noTimeoutInLastRetry,l=0,d=Math.max(e.maxRetries,0),u=function(){var e=new i.a(n,(function(){r(l>=d||!o())}));return a&&(!c||l<d)?i.a.timeout(a,e):e};t=l<d?s()({canRetry:o,retries:d,callback:u,beforeRetry:function(){l++}}):u();return t}({timeout:E,onExecute:function(t,i){var o=function(o,s){return function(p){var m=p.getResponseText();K=p.getServiceWorkerDataSourceHeader();var f,y,v,_,C=Object(h.getRequestEntryDurationMetrics)(a,s),b=Object(r.__assign)(Object(r.__assign)({},l||{}),{needsRequestDigest:O,hasAuthToken:!!e,isCrossOrigin:!!z&&z!==W,CorrelationId:p.getCorrelationId(),HttpStatus:p.getStatus(),serviceWorkerDataSource:K||void 0,rawRequestDuration:C.duration,performanceEntry:JSON.stringify(C),serviceWorkerFetchInfo:p.getServiceWorkerFetchInfoFromHeader()||void 0}),w=!1;try{!function(e,t){return"blob"===e&&t&&"object"==typeof t}(x,m)?y=c(m,p):v=m,w=!0}catch(e){f=e,_={resultType:u.ResultTypeEnum.Failure,resultCode:"InvalidJSON",error:"object"==typeof e?JSON.stringify(e):e,extraData:b}}(_||(_={resultType:u.ResultTypeEnum.Success,extraData:b}),d)&&(_=d({response:y,eventData:_}).eventData);if(o.end(_),w)try{t(v||y)}catch(e){}else i(n._normalizeErrors?new g({code:"-1,parse_response",innerError:f,errorData:{status:p.getStatus()}}):void 0);U=void 0}},s=function(t,o){return function(s,c){var p=Object(h.getRequestEntryDurationMetrics)(a,o),f=Object(r.__assign)(Object(r.__assign)({},l||{}),{needsRequestDigest:O,hasAuthToken:!!e,isCrossOrigin:!!z&&z!==W,rawRequestDuration:p.duration,performanceEntry:JSON.stringify(p)}),y="undefined"!=typeof navigator&&!1===navigator.onLine;if(s){var v=s.getCorrelationId(),_=s.getGroupThrottle(),C=s.getMSCorrelationVector(),b=s.getStatus(),w=s.getAuthErrorType();f=Object(r.__assign)(Object(r.__assign)({},f),{CorrelationId:v,HttpStatus:b,GroupThrottle:_,MSCorrelationVector:C,AuthErrorType:w});var S=u.ResultTypeEnum.Failure;(403===b||404===b||429===b||503===b||-1===b||0===b&&y)&&(B=!1,S=u.ResultTypeEnum.ExpectedFailure);var x=function(e){var a,o=void 0;if("object"==typeof e&&"number"==typeof e.status)o=e;else if("string"==typeof e){var c=void 0;try{c=JSON.parse(e)}catch(e){}a=function(e){if(e)try{var t=/(\d+)(?:;reason="([^"]+?)")?(?:;category="([^"]+?)")?/.exec(e),n=t[1],r=void 0===n?"-1":n,a=t[2],i=void 0===a?"":a,o=t[3],s=void 0===o?"unknown":o,c=void 0;switch(Number(r)){case 3e6:case 3000003:case 3000006:case 3001003:case 3001004:case 3001005:case 3002e3:case 3004009:case 3004010:case 3003e3:c=!0;break;default:c=!1}return new m.ApiError({code:r+","+s,message:i,isExpected:c})}catch(e){return new m.ApiError({code:"-1,Unknown",innerError:e})}}(w),c&&(o=c.error_description?{code:"-1,"+(c.error||"Unknown"),message:c.error_description}:"string"==typeof c.error?{message:c.error}:c.error||c["odata.error"]||{responseData:c})}(o=o||{}).status=b,o.retryAfter=s.getRetryAfterHeader();var l=o["@error.redirectUrl"],p=s.getRedirectUrl()||l;p&&(S=u.ResultTypeEnum.ExpectedFailure),o.redirectUrl=p,o.authenticate=s.getAuthenticateHeader(),v&&(o.correlationId=v),_&&(o.groupThrottle=_),"-1,policy_enforced"===o.code&&(S=u.ResultTypeEnum.ExpectedFailure),a&&a.isExpected&&(S=u.ResultTypeEnum.ExpectedFailure),o.code=a&&a.code||o.code||"Unknown";var h="["+b.toString()+"] "+o.code,y=JSON.stringify(o),C={resultType:S,error:y,resultCode:h,extraData:f};if(d){var x=d({eventData:C,errorData:o}),D=x.eventData,E=x.canRetry;C=D,!0!==E&&!1!==E||(B=E)}t.end(C),i(n._normalizeErrors?new g(Object(r.__assign)({errorData:o,innerError:a},S===u.ResultTypeEnum.ExpectedFailure?{isExpected:!0}:{})):o)},D=s.getResponseType();if(D&&"text"!==D)s.parseError().then(x);else x(s.getResponseText())}else{var E="Unknown",T=!0,k=0;c&&c instanceof m.ApiError&&(E=c.code,T=c.isExpected,k=-1),!y||"NoConnection"!==E&&"Unknown"!==E||(E="Offline");var I={status:k,code:E},R={resultType:T?u.ResultTypeEnum.ExpectedFailure:u.ResultTypeEnum.Failure,resultCode:E,extraData:f};i(n._normalizeErrors?new g({errorData:I,innerError:c}):I),d&&(R=d({eventData:R,errorData:I}).eventData),t.end(R)}}},p=new f.SimpleUri(a);(function(){var t=q=new n._apiEvent({url:p.authority+"/{ length: "+p.path.length+", segments: "+p.segments.length+" }",name:V}),r=R&&R.now();U.getServerDataFromUrl({url:a,successCallback:o(t,r),failureCallback:s(t,r),uploadProgressCallback:D,additionalPostData:v,method:b,additionalHeaders:P,contentType:_,withCredentials:!e&&void 0,noRedirect:w,responseType:x,needsRequestDigest:O})})()},maxRetries:S,noTimeoutInLastRetry:A,canRetry:function(){return B},onCancel:function(e){U&&(U.abort(),e&&U.dispose())}}).then((function(e){return U&&U.dispose(),e}),(function(e){return U&&U.dispose(),!q.endTime&&i.a.isCanceled(e)&&q.end({resultCode:"Canceled",resultType:u.ResultTypeEnum.ExpectedFailure}),i.a.reject(e)}))};if(T)return i.a.resolve(T).then(H);if(j&&j.getAuthToken){var U={url:a,webAbsoluteUrl:L&&L.webAbsoluteUrl};return i.a.resolve(j.getAuthToken(U)).then((function(e){return H(e).catch((function(t){return e&&function(e){var t=e.authenticate;if(t&&"Bearer"===t.slice(0,"Bearer".length)&&t.indexOf('error="insufficient_claims"')>-1)return!0;return!1}(t)?j.getAuthToken(Object(r.__assign)(Object(r.__assign)({},U),{claimsChallenge:{authToken:e,claims:F(t),error:t}})).then((function(n){return n&&n!==e?H(n):i.a.reject(t)})):i.a.reject(t)}))}))}if(L){if(L.getAuthToken)return i.a.resolve(L.getAuthToken().then(H));if(L.authToken)return i.a.resolve(L.authToken).then(H)}return H()},e}();function F(e){var t=e.authenticate;if(t){var n=t.indexOf('claims="');if(n>-1){var r=t.indexOf('"',n+'claims="'.length);if(r>-1)return t.slice(n+'claims="'.length,r)}}}t.default=P}}]);
//# sourceMappingURL=index.shared-react-filehovercard.js.map